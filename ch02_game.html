
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ® ä½æ“ä½œå¤§å¸ˆ - é—¯å…³æ¸¸æˆ</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600;700&family=Noto+Sans+SC:wght@400;500;700;900&display=swap');
  :root{--bg-primary:#0a0e1a;--bg-secondary:#111827;--bg-card:#1a2235;--bg-card-hover:#1e293b;--accent-blue:#3b82f6;--accent-cyan:#06b6d4;--accent-green:#10b981;--accent-yellow:#f59e0b;--accent-red:#ef4444;--accent-purple:#8b5cf6;--accent-pink:#ec4899;--accent-orange:#f97316;--text-primary:#f1f5f9;--text-secondary:#94a3b8;--text-muted:#64748b;--border:#1e293b;--glow-blue:0 0 20px rgba(59,130,246,0.3);--glow-green:0 0 20px rgba(16,185,129,0.3);--glow-yellow:0 0 20px rgba(245,158,11,0.3);}
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Noto Sans SC',sans-serif;background:var(--bg-primary);color:var(--text-primary);min-height:100vh;overflow-x:hidden;}
  .bg-particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;background:radial-gradient(ellipse at 20% 50%,rgba(59,130,246,0.08) 0%,transparent 50%),radial-gradient(ellipse at 80% 20%,rgba(139,92,246,0.06) 0%,transparent 50%),radial-gradient(ellipse at 50% 80%,rgba(6,182,212,0.05) 0%,transparent 50%);}
  .container{position:relative;z-index:1;max-width:1100px;margin:0 auto;padding:20px;}
  .game-header{text-align:center;padding:30px 0 20px;}
  .game-header h1{font-size:2.6em;font-weight:900;background:linear-gradient(135deg,#3b82f6,#06b6d4,#10b981);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:8px;letter-spacing:2px;}
  .game-header p{color:var(--text-secondary);font-size:1.05em;}
  .stats-bar{display:flex;justify-content:center;gap:30px;padding:16px 30px;margin:15px auto 25px;background:var(--bg-card);border-radius:16px;border:1px solid var(--border);max-width:700px;flex-wrap:wrap;}
  .stat-item{text-align:center;}
  .stat-item .label{font-size:.78em;color:var(--text-muted);text-transform:uppercase;letter-spacing:1px;}
  .stat-item .value{font-family:'Fira Code',monospace;font-size:1.5em;font-weight:700;}
  .stat-item .value.blue{color:var(--accent-blue);}
  .stat-item .value.green{color:var(--accent-green);}
  .stat-item .value.yellow{color:var(--accent-yellow);}
  .stat-item .value.purple{color:var(--accent-purple);}
  #world-map{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:18px;}
  .world-card{background:var(--bg-card);border-radius:16px;border:1px solid var(--border);padding:22px;cursor:pointer;transition:all 0.3s ease;position:relative;overflow:hidden;}
  .world-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--card-accent),transparent);opacity:0;transition:opacity 0.3s;}
  .world-card:hover{transform:translateY(-4px);border-color:var(--card-accent);box-shadow:0 8px 30px rgba(0,0,0,0.3);}
  .world-card:hover::before{opacity:1;}
  .world-card .world-icon{font-size:2em;margin-bottom:10px;}
  .world-card .world-title{font-size:1.15em;font-weight:700;margin-bottom:4px;}
  .world-card .world-subtitle{font-size:.82em;color:var(--text-muted);margin-bottom:14px;}
  .world-card .world-progress-bar{height:6px;background:rgba(255,255,255,0.07);border-radius:3px;overflow:hidden;}
  .world-card .world-progress-fill{height:100%;border-radius:3px;transition:width 0.5s ease;background:linear-gradient(90deg,var(--card-accent),var(--card-accent-light,var(--card-accent)));}
  .world-card .world-stats{display:flex;justify-content:space-between;margin-top:8px;font-size:.78em;color:var(--text-muted);}
  .world-card.completed{border-color:var(--accent-green);}
  #level-select,#game-play,#result-screen{display:none;}
  .back-btn{display:inline-flex;align-items:center;gap:8px;background:var(--bg-card);border:1px solid var(--border);color:var(--text-secondary);padding:10px 20px;border-radius:10px;cursor:pointer;font-size:.95em;transition:all 0.2s;margin-bottom:20px;}
  .back-btn:hover{background:var(--bg-card-hover);color:var(--text-primary);}
  .level-header{text-align:center;margin-bottom:25px;}
  .level-header h2{font-size:1.8em;margin-bottom:5px;}
  .level-header p{color:var(--text-secondary);}
  .level-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:15px;}
  .level-card{background:var(--bg-card);border-radius:14px;border:1px solid var(--border);padding:20px;cursor:pointer;transition:all 0.25s;position:relative;}
  .level-card:hover{transform:translateY(-3px);border-color:var(--accent-cyan);box-shadow:0 6px 24px rgba(0,0,0,0.25);}
  .level-card .level-num{font-family:'Fira Code';font-size:.75em;color:var(--accent-cyan);margin-bottom:6px;}
  .level-card .level-name{font-weight:700;font-size:1.05em;margin-bottom:5px;}
  .level-card .level-formula{font-family:'Fira Code';font-size:.88em;color:var(--accent-yellow);background:rgba(245,158,11,0.08);padding:6px 10px;border-radius:8px;margin:8px 0;word-break:break-all;}
  .level-card .level-stars{color:var(--accent-yellow);font-size:.85em;}
  .level-card .level-tag{display:inline-block;font-size:.72em;padding:3px 8px;background:rgba(139,92,246,0.15);color:var(--accent-purple);border-radius:6px;margin-top:6px;}
  .level-card .level-status{position:absolute;top:14px;right:14px;font-size:1.2em;}
  .level-card.cleared .level-status::after{content:'âœ…';}
  .level-card.locked{opacity:.45;pointer-events:none;}
  .level-card.locked .level-status::after{content:'ğŸ”’';}
  .game-area{max-width:780px;margin:0 auto;}
  .question-header{text-align:center;margin-bottom:20px;}
  .question-header .q-world{font-size:.85em;color:var(--text-muted);}
  .question-header .q-title{font-size:1.5em;font-weight:700;margin:5px 0;}
  .question-header .q-formula{font-family:'Fira Code';font-size:1.15em;color:var(--accent-cyan);background:rgba(6,182,212,0.1);display:inline-block;padding:8px 20px;border-radius:10px;margin-top:8px;}
  .question-progress{display:flex;gap:6px;justify-content:center;margin:18px 0;}
  .question-progress .dot{width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.1);transition:all 0.3s;}
  .question-progress .dot.active{background:var(--accent-blue);box-shadow:0 0 8px rgba(59,130,246,0.5);}
  .question-progress .dot.correct{background:var(--accent-green);}
  .question-progress .dot.wrong{background:var(--accent-red);}
  .question-card{background:var(--bg-card);border-radius:16px;border:1px solid var(--border);padding:30px;margin-bottom:15px;}
  .question-card .q-type{font-size:.78em;color:var(--accent-purple);text-transform:uppercase;letter-spacing:1px;margin-bottom:12px;}
  .question-card .q-text{font-size:1.12em;line-height:1.7;margin-bottom:22px;}
  .question-card .q-text code{font-family:'Fira Code';background:rgba(59,130,246,0.12);color:var(--accent-cyan);padding:2px 7px;border-radius:5px;font-size:.92em;}
  .options{display:flex;flex-direction:column;gap:12px;}
  .option-btn{display:flex;align-items:center;gap:14px;background:rgba(255,255,255,0.03);border:1px solid var(--border);padding:16px 20px;border-radius:12px;cursor:pointer;transition:all 0.2s;text-align:left;color:var(--text-primary);font-size:1em;font-family:inherit;}
  .option-btn:hover{background:rgba(59,130,246,0.08);border-color:var(--accent-blue);}
  .option-btn .opt-letter{width:34px;height:34px;display:flex;align-items:center;justify-content:center;border-radius:8px;background:rgba(255,255,255,0.06);font-family:'Fira Code';font-weight:700;font-size:.9em;flex-shrink:0;}
  .option-btn .opt-text{flex:1;line-height:1.5;}
  .option-btn .opt-text code{font-family:'Fira Code';background:rgba(59,130,246,0.10);color:var(--accent-cyan);padding:1px 5px;border-radius:4px;font-size:.9em;}
  .option-btn.selected-correct{background:rgba(16,185,129,0.12);border-color:var(--accent-green);animation:correctPulse 0.5s;}
  .option-btn.selected-correct .opt-letter{background:var(--accent-green);color:#fff;}
  .option-btn.selected-wrong{background:rgba(239,68,68,0.12);border-color:var(--accent-red);animation:shake 0.4s;}
  .option-btn.selected-wrong .opt-letter{background:var(--accent-red);color:#fff;}
  .option-btn.reveal-correct{background:rgba(16,185,129,0.08);border-color:var(--accent-green);}
  .option-btn.disabled{pointer-events:none;}
  @keyframes correctPulse{0%,100%{transform:scale(1);}50%{transform:scale(1.02);}}
  @keyframes shake{0%,100%{transform:translateX(0);}25%{transform:translateX(-6px);}75%{transform:translateX(6px);}}
  .explanation-box{background:rgba(139,92,246,0.08);border:1px solid rgba(139,92,246,0.25);border-radius:12px;padding:18px 22px;margin-top:18px;display:none;animation:fadeIn 0.3s;}
  .explanation-box .exp-title{font-weight:700;color:var(--accent-purple);margin-bottom:8px;font-size:.9em;}
  .explanation-box .exp-content{font-size:.92em;line-height:1.7;color:var(--text-secondary);}
  .explanation-box .exp-content code{font-family:'Fira Code';background:rgba(6,182,212,0.1);color:var(--accent-cyan);padding:1px 5px;border-radius:4px;}
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}
  .next-btn{display:none;margin:20px auto 0;padding:14px 40px;background:linear-gradient(135deg,var(--accent-blue),var(--accent-cyan));border:none;border-radius:12px;color:#fff;font-size:1.05em;font-weight:700;cursor:pointer;transition:all 0.2s;font-family:inherit;}
  .next-btn:hover{transform:translateY(-2px);box-shadow:var(--glow-blue);}
  .result-area{text-align:center;max-width:550px;margin:0 auto;}
  .result-area .result-icon{font-size:5em;margin-bottom:15px;animation:bounceIn 0.6s;}
  @keyframes bounceIn{0%{transform:scale(0);}60%{transform:scale(1.2);}100%{transform:scale(1);}}
  .result-area h2{font-size:2em;margin-bottom:8px;}
  .result-area .result-sub{color:var(--text-secondary);font-size:1.05em;margin-bottom:25px;}
  .result-score-box{background:var(--bg-card);border-radius:16px;border:1px solid var(--border);padding:25px;margin-bottom:25px;}
  .result-score-box .big-score{font-family:'Fira Code';font-size:3.5em;font-weight:700;}
  .result-score-box .score-label{color:var(--text-muted);margin-top:5px;}
  .result-btns{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;}
  .result-btns button{padding:13px 32px;border-radius:12px;font-size:1em;font-weight:600;cursor:pointer;transition:all 0.2s;border:none;font-family:inherit;}
  .btn-retry{background:var(--accent-orange);color:#fff;}
  .btn-retry:hover{box-shadow:0 0 20px rgba(249,115,22,0.4);}
  .btn-next-world{background:linear-gradient(135deg,var(--accent-blue),var(--accent-purple));color:#fff;}
  .btn-next-world:hover{box-shadow:0 0 20px rgba(139,92,246,0.4);}
  .btn-home{background:var(--bg-card);color:var(--text-secondary);border:1px solid var(--border)!important;}
  .btn-home:hover{color:var(--text-primary);}
  .floating-bits{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:hidden;}
  .floating-bits span{position:absolute;font-family:'Fira Code';color:rgba(59,130,246,0.06);font-size:1.2em;animation:floatUp linear infinite;}
  @keyframes floatUp{0%{transform:translateY(100vh) rotate(0deg);opacity:0;}10%{opacity:1;}90%{opacity:1;}100%{transform:translateY(-10vh) rotate(360deg);opacity:0;}}
  .screen-transition{animation:slideIn 0.35s ease;}
  @keyframes slideIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
  /* toast */
  .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(80px);background:rgba(30,41,59,0.97);border:1px solid var(--border);color:var(--text-primary);padding:14px 28px;border-radius:14px;font-size:.98em;z-index:9999;transition:transform 0.35s cubic-bezier(.34,1.56,.64,1),opacity 0.3s;opacity:0;white-space:nowrap;}
  .toast.show{transform:translateX(-50%) translateY(0);opacity:1;}
  /* achievement popup */
  .achievement-popup{position:fixed;top:80px;right:-340px;background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(59,130,246,0.1));border:1px solid rgba(139,92,246,0.4);border-radius:16px;padding:18px 22px;max-width:300px;z-index:9998;transition:right 0.5s cubic-bezier(.34,1.56,.64,1);}
  .achievement-popup.show{right:20px;}
  .achievement-popup .ach-title{font-size:.75em;color:var(--accent-purple);text-transform:uppercase;letter-spacing:1px;margin-bottom:4px;}
  .achievement-popup .ach-name{font-weight:700;font-size:1.05em;}
  .achievement-popup .ach-icon{font-size:2em;float:right;margin-top:-5px;}
  /* progress ring */
  .progress-ring{display:inline-flex;align-items:center;justify-content:center;position:relative;width:56px;height:56px;margin-bottom:6px;}
  .progress-ring svg{transform:rotate(-90deg);}
  .progress-ring .ring-bg{fill:none;stroke:rgba(255,255,255,0.07);stroke-width:4;}
  .progress-ring .ring-fill{fill:none;stroke-width:4;stroke-linecap:round;transition:stroke-dashoffset 0.6s ease;}
  .progress-ring .ring-text{position:absolute;font-family:'Fira Code';font-size:.72em;font-weight:700;}
  @media(max-width:600px){
    .game-header h1{font-size:1.7em;}
    .stats-bar{gap:15px;padding:12px 16px;}
    .stat-item .value{font-size:1.2em;}
    #world-map{grid-template-columns:1fr;}
    .level-grid{grid-template-columns:1fr;}
    .question-card{padding:20px 16px;}
  }
</style>
</head>
<body>
<div class="floating-bits" id="floatingBits"></div>
<div class="bg-particles"></div>
<div class="toast" id="toastEl"></div>
<div class="achievement-popup" id="achievementPopup">
  <div class="ach-title">ğŸ† æˆå°±è§£é”</div>
  <div class="ach-name" id="achName"></div>
  <div class="ach-icon" id="achIcon"></div>
</div>

<div class="container">
  <div class="game-header">
    <h1>âš¡ ä½æ“ä½œå¤§å¸ˆ</h1>
    <p>Bit Manipulation Master Â· 10å¤§ä¸–ç•Œ Â· 55+å…³å¡ Â· ä»é’é“œåˆ°ç‹è€…</p>
  </div>
  <div class="stats-bar">
    <div class="stat-item"><div class="label">æ€»è¿›åº¦</div><div class="value blue" id="statProgress">0%</div></div>
    <div class="stat-item"><div class="label">å·²é€šå…³</div><div class="value green" id="statCleared">0</div></div>
    <div class="stat-item"><div class="label">æ€»åˆ†</div><div class="value yellow" id="statScore">0</div></div>
    <div class="stat-item"><div class="label">è¿èƒœ</div><div class="value purple" id="statStreak">0</div></div>
  </div>
  <div id="world-map"></div>
  <div id="level-select">
    <button class="back-btn" onclick="showWorldMap()">â† è¿”å›ä¸–ç•Œåœ°å›¾</button>
    <div class="level-header">
      <h2 id="levelWorldTitle"></h2>
      <p id="levelWorldDesc"></p>
    </div>
    <div class="level-grid" id="levelGrid"></div>
  </div>
  <div id="game-play">
    <button class="back-btn" onclick="confirmExit()">â† é€€å‡ºå…³å¡</button>
    <div class="game-area">
      <div class="question-header">
        <div class="q-world" id="gpWorld"></div>
        <div class="q-title" id="gpTitle"></div>
        <div class="q-formula" id="gpFormula"></div>
      </div>
      <div class="question-progress" id="qProgress"></div>
      <div class="question-card">
        <div class="q-type" id="qType"></div>
        <div class="q-text" id="qText"></div>
        <div class="options" id="qOptions"></div>
        <div class="explanation-box" id="qExplanation">
          <div class="exp-title">ğŸ’¡ è§£æ</div>
          <div class="exp-content" id="qExpContent"></div>
        </div>
      </div>
      <button class="next-btn" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â†’</button>
    </div>
  </div>
  <div id="result-screen">
    <div class="result-area">
      <div class="result-icon" id="resultIcon"></div>
      <h2 id="resultTitle"></h2>
      <p class="result-sub" id="resultSub"></p>
      <div class="result-score-box">
        <div class="big-score" id="resultScore"></div>
        <div class="score-label" id="resultScoreLabel"></div>
      </div>
      <div class="result-btns">
        <button class="btn-retry" onclick="retryLevel()">ğŸ”„ é‡æ–°æŒ‘æˆ˜</button>
        <button class="btn-next-world" id="btnNextLevel" onclick="goNextLevel()">âš¡ ä¸‹ä¸€å…³</button>
        <button class="btn-home" onclick="showWorldMap()">ğŸ  ä¸–ç•Œåœ°å›¾</button>
      </div>
    </div>
  </div>
</div>

<script>
// ============================================================
//  FULL GAME DATA
// ============================================================
const WORLDS = [
  {
    id:'w1',icon:'ğŸ”§',title:'æœ€å³ä½æ“çºµ',subtitle:'TRICK 01-08 Â· 8å…³',accent:'#3b82f6',accentLight:'#60a5fa',
    levels:[
      {id:'w1l1',name:'æ¸…é™¤æœ€å³è¾¹çš„1',formula:'x & (x-1)',stars:'â­â­â­',tag:'åˆ¤æ–­2çš„å¹‚',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'è¡¨è¾¾å¼ <code>x & (x-1)</code> çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ',options:['æ¸…é™¤xæœ€å³è¾¹(æœ€ä½ä½)çš„1','ç½®ä½xæœ€å³è¾¹çš„0','æ¸…é™¤xæ‰€æœ‰çš„1','åè½¬xæ‰€æœ‰ä½'],answer:0,explanation:'<code>x-1</code> ä¼šæŠŠæœ€å³è¾¹çš„1å˜ä¸º0ï¼Œå…¶å³ä¾§çš„0å…¨å˜ä¸º1ã€‚ä¸xåšANDåï¼Œæœ€å³è¾¹é‚£ä¸ª1å°±è¢«æ¸…é™¤äº†ï¼Œå…¶ä½™ä½ä¸å˜ã€‚'},
        {type:'åº”ç”¨é¢˜',text:'å¦‚ä½•ç”¨ <code>x & (x-1)</code> åˆ¤æ–­xæ˜¯å¦ä¸º2çš„å¹‚ï¼ˆx>0ï¼‰ï¼Ÿ',options:['x & (x-1) == 0 åˆ™æ˜¯2çš„å¹‚','x & (x-1) == 1 åˆ™æ˜¯2çš„å¹‚','x & (x-1) == x åˆ™æ˜¯2çš„å¹‚','x & (x-1) != 0 åˆ™æ˜¯2çš„å¹‚'],answer:0,explanation:'2çš„å¹‚åªæœ‰ä¸€ä¸ª1ä½ã€‚æ¸…é™¤å”¯ä¸€çš„1åç»“æœä¸º0ã€‚ä¾‹å¦‚ <code>8(1000) & 7(0111) = 0</code>ã€‚'},
        {type:'è®¡ç®—é¢˜',text:'<code>x = 0b10110100</code>ï¼Œè®¡ç®— <code>x & (x-1)</code> çš„ç»“æœï¼Ÿ',options:['0b10110000','0b10110100','0b10100000','0b10100100'],answer:0,explanation:'<code>x=10110100</code>ï¼Œæœ€å³è¾¹çš„1åœ¨ç¬¬2ä½ã€‚<code>x-1=10110011</code>ï¼Œ<code>x & (x-1) = 10110000</code>ã€‚'},
        {type:'æ‹“å±•é¢˜',text:'Brian Kernighanç®—æ³•ç”¨ <code>x & (x-1)</code> åšä»€ä¹ˆï¼Ÿ',options:['è®¡ç®—popcount(ä½ä¸­1çš„ä¸ªæ•°)','è®¡ç®—å‰å¯¼é›¶','åè½¬æ‰€æœ‰ä½','æ‰¾æœ€é«˜ä½1'],answer:0,explanation:'æ¯æ¬¡ <code>x = x & (x-1)</code> æ¸…é™¤ä¸€ä¸ª1ï¼Œå¾ªç¯ç›´åˆ°x=0ï¼Œå¾ªç¯æ¬¡æ•°å°±æ˜¯1çš„ä¸ªæ•°ã€‚æ—¶é—´å¤æ‚åº¦O(popcount)ã€‚'}
      ]},
      {id:'w1l2',name:'ç½®ä½æœ€å³è¾¹çš„0',formula:'x | (x+1)',stars:'â­â­',tag:'è¿ç»­0æ£€æµ‹',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>x | (x+1)</code> çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ',options:['ç½®ä½æœ€å³è¾¹çš„0ä¸º1','æ¸…é™¤æœ€å³è¾¹çš„1','åè½¬æœ€ä½ä½','æ¸…é™¤æ‰€æœ‰0'],answer:0,explanation:'<code>x+1</code> ä¼šåœ¨æœ€å³è¾¹çš„0çš„ä½ç½®äº§ç”Ÿä¸€ä¸ª1ã€‚ä¸xåšORåï¼Œè¯¥0è¢«ç½®ä¸º1ã€‚'},
        {type:'è®¡ç®—é¢˜',text:'<code>x = 0b10110111</code>ï¼Œ<code>x | (x+1)</code> = ?',options:['0b10111111','0b10110111','0b11111111','0b10111000'],answer:0,explanation:'æœ€å³è¾¹çš„0åœ¨ç¬¬3ä½ã€‚<code>x+1=10111000</code>ï¼Œ<code>x | (x+1) = 10111111</code>ã€‚'},
        {type:'åº”ç”¨é¢˜',text:'å¦‚ä½•æ£€æµ‹xæ˜¯å¦å½¢å¦‚ <code>2â¿-1</code>ï¼ˆå…¨1ï¼‰ï¼Ÿ',options:['x | (x+1) ç»“æœå…¨ä¸º1å³ç­‰äº-1(æ— ç¬¦å·)','x & (x+1) == 0','x ^ (x+1) == 0','x | (x-1) == -1'],answer:0,explanation:'å¦‚æœxæ˜¯è¿ç»­å…¨1(å¦‚0111)ï¼Œ<code>x+1</code>ä¼šè¿›ä½åˆ°æ›´é«˜ä½(1000)ï¼ŒORåæ‰€æœ‰ä½éƒ½æ˜¯1ï¼Œç­‰äºå…¨1(å³-1çš„è¡¥ç )ã€‚'}
      ]},
      {id:'w1l3',name:'æ¸…é™¤å°¾éƒ¨è¿ç»­çš„1',formula:'x & (x+1)',stars:'â­â­',tag:'åˆ¤æ–­2â¿-1å½¢å¼',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>x & (x+1)</code> æ¸…é™¤çš„æ˜¯å“ªäº›ä½ï¼Ÿ',options:['å°¾éƒ¨è¿ç»­çš„1','æœ€å³è¾¹çš„å•ä¸ª1','æ‰€æœ‰çš„1','æœ€é«˜ä½çš„1'],answer:0,explanation:'<code>x+1</code> å°†å°¾éƒ¨è¿ç»­çš„1å…¨éƒ¨ç¿»è½¬ä¸º0å¹¶è¿›ä½ã€‚ANDæ“ä½œåè¿™äº›ä½è¢«æ¸…é›¶ã€‚å¦‚ <code>10110111 & 10111000 = 10110000</code>ã€‚'},
        {type:'è®¡ç®—é¢˜',text:'<code>x = 0b11001111</code>ï¼Œ<code>x & (x+1)</code> = ?',options:['0b11000000','0b11001110','0b11001000','0b11010000'],answer:0,explanation:'å°¾éƒ¨è¿ç»­4ä¸ª1ã€‚<code>x+1=11010000</code>ï¼Œ<code>x & (x+1) = 11000000</code>ã€‚å°¾éƒ¨4ä¸ª1å…¨éƒ¨è¢«æ¸…é™¤ã€‚'},
        {type:'åº”ç”¨é¢˜',text:'<code>x & (x+1) == 0</code> æ„å‘³ç€xæ˜¯ä»€ä¹ˆå½¢å¼ï¼Ÿ',options:['x = 2â¿ - 1ï¼ˆæ‰€æœ‰ä½éƒ½æ˜¯è¿ç»­1ï¼‰','xæ˜¯2çš„å¹‚','xæ˜¯å¶æ•°','xæ˜¯å¥‡æ•°'],answer:0,explanation:'å¦‚æœæ¸…é™¤å°¾éƒ¨è¿ç»­1åç»“æœä¸º0ï¼Œè¯´æ˜xçš„æ‰€æœ‰ä½éƒ½æ˜¯è¿ç»­çš„1ï¼Œå³ <code>x = 2â¿ - 1</code> çš„å½¢å¼ï¼ˆå¦‚1, 3, 7, 15...ï¼‰ã€‚'}
      ]},
      {id:'w1l4',name:'ç½®ä½å°¾éƒ¨è¿ç»­çš„0',formula:'x | (x-1)',stars:'â­â­',tag:'å–æ•´ã€å†…å­˜å¯¹é½',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>x | (x-1)</code> èƒ½åšä»€ä¹ˆï¼Ÿ',options:['å°†å°¾éƒ¨æ‰€æœ‰è¿ç»­çš„0ç½®ä¸º1','æ¸…é™¤å°¾éƒ¨è¿ç»­çš„1','åªä¿®æ”¹æœ€ä½ä½','åè½¬æ‰€æœ‰ä½'],answer:0,explanation:'<code>x-1</code> æŠŠæœ€ä½çš„1å˜0ï¼Œå…¶åçš„0å…¨å˜1ã€‚ä¸xåšORï¼Œå°±æŠŠå°¾éƒ¨è¿ç»­0å…¨ç½®1äº†ã€‚'},
        {type:'è®¡ç®—é¢˜',text:'<code>x = 0b10101000</code>ï¼Œ<code>x | (x-1)</code> = ?',options:['0b10101111','0b10101000','0b10100111','0b10111111'],answer:0,explanation:'å°¾éƒ¨æœ‰3ä¸ª0ã€‚<code>x-1=10100111</code>ï¼Œ<code>x | (x-1) = 10101111</code>ã€‚å°¾éƒ¨3ä¸ª0å…¨éƒ¨è¢«ç½®1ã€‚'}
      ]},
      {id:'w1l5',name:'æœ€å³è¾¹çš„0æ©ç ',formula:'~x & (x+1)',stars:'â­',tag:'å•bitæå–',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>~x & (x+1)</code> ç”Ÿæˆçš„æ©ç ç‰¹ç‚¹æ˜¯ï¼Ÿ',options:['åªæœ‰æœ€å³è¾¹0çš„ä½ç½®ä¸º1ï¼Œå…¶ä½™ä¸º0','åªæœ‰æœ€å³è¾¹1çš„ä½ç½®ä¸º1','å°¾éƒ¨å…¨ä¸º1','å…¨1æ©ç '],answer:0,explanation:'<code>~x</code>ç¿»è½¬æ‰€æœ‰ä½ï¼Œ<code>x+1</code>åœ¨æœ€å³0å¤„äº§ç”Ÿ1ã€‚ä¸¤è€…ANDåç²¾ç¡®æå–å‡ºæœ€å³è¾¹0çš„ä½ç½®ã€‚'},
        {type:'è®¡ç®—é¢˜',text:'<code>x = 0b10110111</code>ï¼Œ<code>~x & (x+1)</code> = ?',options:['0b00001000','0b00000001','0b01000000','0b00010000'],answer:0,explanation:'æœ€å³è¾¹çš„0åœ¨ç¬¬3ä½ã€‚<code>~x=01001000</code>ï¼Œ<code>x+1=10111000</code>ï¼ŒANDç»“æœ = <code>00001000</code>ï¼Œç²¾ç¡®æ ‡è®°äº†ç¬¬3ä½ã€‚'}
      ]},
      {id:'w1l6',name:'æœ€å³è¾¹çš„1æ©ç (LSB)',formula:'x & (-x)',stars:'â­â­â­',tag:'æ£‹ç›˜å¼•æ“bitboard',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>x & (-x)</code> æå–çš„æ˜¯ä»€ä¹ˆï¼Ÿ',options:['æœ€å³è¾¹(æœ€ä½ä½)çš„1ï¼Œå³LSB','æœ€å·¦è¾¹çš„1','æ‰€æœ‰çš„1','æœ€å³è¾¹çš„0'],answer:0,explanation:'<code>-x</code> åœ¨è¡¥ç ä¸­ç­‰äº <code>~x + 1</code>ã€‚è¿™ä¼šä½¿æœ€å³è¾¹çš„1ä¿æŒä¸å˜ï¼Œå…¶å·¦è¾¹çš„ä½å…¨éƒ¨ç¿»è½¬ã€‚ANDååªå‰©é‚£ä¸ªæœ€ä½ä½çš„1ã€‚'},
        {type:'åº”ç”¨é¢˜',text:'æ ‘çŠ¶æ•°ç»„(Fenwick Tree)ä¸­ <code>x & (-x)</code> ç”¨æ¥åšä»€ä¹ˆï¼Ÿ',options:['è®¡ç®—lowbitï¼Œå†³å®šèŠ‚ç‚¹ç®¡è¾–èŒƒå›´','åˆ¤æ–­æ˜¯å¦ä¸º2çš„å¹‚','è®¡ç®—popcount','ç”Ÿæˆéšæœºæ•°'],answer:0,explanation:'Fenwick Treeä¸­ <code>lowbit(x) = x & (-x)</code> å†³å®šäº†ç´¢å¼•xç®¡è¾–çš„åŒºé—´é•¿åº¦ï¼Œæ˜¯å‰ç¼€å’Œæ›´æ–°å’ŒæŸ¥è¯¢çš„æ ¸å¿ƒã€‚'},
        {type:'è®¡ç®—é¢˜',text:'<code>x = 0b01011000</code>ï¼Œ<code>x & (-x)</code> = ?',options:['0b00001000','0b00000001','0b01000000','0b00010000'],answer:0,explanation:'æœ€å³è¾¹çš„1åœ¨ç¬¬3ä½ã€‚<code>-x(è¡¥ç )=10101000</code>ï¼Œ<code>x & (-x) = 00001000</code>ã€‚'}
      ]},
      {id:'w1l7',name:'å°¾éƒ¨0çš„æ©ç ',formula:'~x & (x-1)',stars:'â­',tag:'ä½ä½å¤„ç†',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>~x & (x-1)</code> ç”Ÿæˆä»€ä¹ˆæ ·çš„æ©ç ï¼Ÿ',options:['å°¾éƒ¨è¿ç»­0çš„ä½ç½®å…¨ä¸º1','åªæœ‰æœ€ä½ä½ä¸º1','å…¨éƒ¨ä¸º1','å°¾éƒ¨è¿ç»­1çš„ä½ç½®å…¨ä¸º1'],answer:0,explanation:'<code>x-1</code>å°†æœ€ä½çš„1å˜0ï¼Œå…¶å0å˜1ã€‚<code>~x</code>åœ¨åŸæ¥0å¤„ä¸º1ã€‚ANDåå¾—åˆ°å°¾éƒ¨0ä»¬çš„æ©ç ã€‚ä¾‹å¦‚ <code>x=11110000</code>: <code>~x=00001111, x-1=11101111</code>ï¼ŒAND= <code>00001111</code>ã€‚'},
        {type:'è®¡ç®—é¢˜',text:'<code>x = 0b11110000</code>ï¼Œ<code>~x & (x-1)</code> = ?',options:['0b00001111','0b00000001','0b00010000','0b11110000'],answer:0,explanation:'å°¾éƒ¨4ä¸ª0ã€‚<code>~x=00001111</code>ï¼Œ<code>x-1=11101111</code>ï¼ŒAND= <code>00001111</code>ã€‚æ°å¥½æ ‡è®°äº†å°¾éƒ¨4ä¸ª0ã€‚'}
      ]},
      {id:'w1l8',name:'å°¾éƒ¨1å³å¯¹é½ä¼ æ’­',formula:'x | (x-1)',stars:'â­â­',tag:'å†…å­˜å¯¹é½ã€å­é›†æšä¸¾',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>x | (x-1)</code> è¢«ç§°ä¸º"å³ä¼ æ’­"æ˜¯å› ä¸ºï¼Ÿ',options:['å®ƒå°†æœ€å³è¾¹çš„1å‘å³æ‰©å±•ï¼Œå¡«å……å°¾éƒ¨æ‰€æœ‰0','å®ƒå°†1å‘å·¦ä¼ æ’­','å®ƒæ¸…é™¤å³ä¾§æ‰€æœ‰ä½','å®ƒåè½¬å³ä¾§æ‰€æœ‰ä½'],answer:0,explanation:'<code>x-1</code>æŠŠæœ€ä½1å˜0ï¼Œå³ä¾§0å˜1ã€‚ORåï¼ŒåŸæ¥çš„1ä¿ç•™ï¼Œå³ä¾§0ä¹Ÿå˜1ï¼Œæ•ˆæœå°±æ˜¯æœ€ä½çš„1"å‘å³ä¼ æ’­"å¡«å……äº†æ‰€æœ‰0ã€‚'},
        {type:'åº”ç”¨é¢˜',text:'åœ¨å­é›†æšä¸¾åœºæ™¯ä¸­ï¼Œ<code>x | (x-1)</code> çš„ä½œç”¨æ˜¯ï¼Ÿ',options:['å‘å³æ‰©å±•å½“å‰é›†åˆåˆ°å—æœ«å°¾ï¼Œä¸ºæšä¸¾è¶…é›†åšå‡†å¤‡','åˆ é™¤å­é›†','è®¡ç®—å¹¶é›†','è®¡ç®—äº¤é›†'],answer:0,explanation:'é€šè¿‡å¡«å……å°¾éƒ¨0ä¸º1ï¼Œå¯å°†é›†åˆå‘å³"æ‰©å±•"ã€‚è¿™åœ¨æšä¸¾è¶…é›†å’Œå†…å­˜åœ°å€å¯¹é½ä¸­æ˜¯æ ¸å¿ƒæ“ä½œã€‚'}
      ]}
    ]
  },
  {
    id:'w2',icon:'â•',title:'åŠ å‡æ³•æ’ç­‰å¼',subtitle:'7ä¸ªæ ¸å¿ƒæ’ç­‰å¼',accent:'#10b981',accentLight:'#34d399',
    levels:[
      {id:'w2l1',name:'ç‹ç‰Œæ’ç­‰å¼',formula:'x+y = (x^y)+((x&y)<<1)',stars:'â­â­â­',tag:'å¹¶è¡Œå‰ç¼€åŠ æ³•',questions:[
        {type:'åŸç†é¢˜',text:'åœ¨ <code>x+y = (x^y)+((x&y)<<1)</code> ä¸­ï¼Œ<code>x^y</code> ä»£è¡¨ä»€ä¹ˆï¼Ÿ',options:['æ— è¿›ä½åŠ æ³•ï¼ˆåŠåŠ å’Œï¼‰','å…¨åŠ å’Œ','è¿›ä½','å€Ÿä½'],answer:0,explanation:'XORæ‰§è¡Œé€ä½åŠ æ³•ä½†ä¸å¤„ç†è¿›ä½ï¼Œå³"åŠåŠ å’Œ"ã€‚<code>x&y</code>æ ‡è¯†éœ€è¦è¿›ä½çš„ä½ï¼Œå·¦ç§»1å°±æ˜¯è¿›ä½å€¼ã€‚ä¸¤è€…ç›¸åŠ è¿˜åŸå®Œæ•´åŠ æ³•ã€‚'},
        {type:'åº”ç”¨é¢˜',text:'è¿™ä¸ªæ’ç­‰å¼æ˜¯å“ªç§ç¡¬ä»¶ç»“æ„çš„ç†è®ºåŸºç¡€ï¼Ÿ',options:['å¹¶è¡Œå‰ç¼€åŠ æ³•å™¨(å¦‚Kogge-Stone)','ä¹˜æ³•å™¨','é™¤æ³•å™¨','ç§»ä½å¯„å­˜å™¨'],answer:0,explanation:'å¹¶è¡Œå‰ç¼€åŠ æ³•å™¨é€šè¿‡é€’å½’åœ°è®¡ç®—"ç”Ÿæˆ-ä¼ æ’­"å¯¹æ¥å®ç°O(log n)å»¶è¿Ÿçš„åŠ æ³•ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯è¿™ä¸ªæ’ç­‰å¼çš„é€’å½’åº”ç”¨ã€‚'},
        {type:'éªŒè¯é¢˜',text:'è®¾ <code>x=0b1011(11), y=0b0110(6)</code>ï¼Œ<code>x+y</code> = ?',options:['0b10001 (17)','0b10010 (18)','0b1101 (13)','0b10000 (16)'],answer:0,explanation:'<code>x+y=17=10001</code>ã€‚éªŒè¯: <code>x^y=1101</code>, <code>(x&y)<<1=0100</code>, <code>1101+0100=10001 âœ“</code>'}
      ]},
      {id:'w2l2',name:'OR/ANDåˆ†è§£',formula:'x+y = (x|y)+(x&y)',stars:'â­â­',tag:'ç­‰ä»·åˆ†è§£',questions:[
        {type:'ç†è§£é¢˜',text:'<code>x+y = (x|y)+(x&y)</code> çš„ç›´è§‰æ˜¯ä»€ä¹ˆï¼Ÿ',options:['ORç®—äº†å…¬å…±ä½ä¸€æ¬¡ï¼ŒANDè¡¥å›å¦ä¸€æ¬¡','ORä¸¢å¤±äº†ä¿¡æ¯éœ€è¦ANDè¡¥å›','ä¸¤è€…æ— å…³åªæ˜¯å·§åˆ','è¿™æ˜¯å‡æ³•çš„é€†è¿ç®—'],answer:0,explanation:'å¯¹äºæ¯ä¸€ä½: è‹¥ä¸¤ä¸ªéƒ½æ˜¯1ï¼ŒORè´¡çŒ®1ä½†å®é™…è¯¥è´¡çŒ®2ï¼ŒANDè¡¥å›ç¼ºçš„1ã€‚è‹¥åªæœ‰ä¸€ä¸ª1ï¼ŒORæ­£ç¡®è´¡çŒ®1ï¼ŒANDè´¡çŒ®0ã€‚å®Œç¾è¿˜åŸã€‚'},
        {type:'æ¨å¯¼é¢˜',text:'ç”± <code>x+y = (x|y)+(x&y)</code> å¯ä»¥æ¨å‡º <code>x|y</code> = ?',options:['(x+y) - (x&y)','(x+y) + (x&y)','(x+y) ^ (x&y)','(x+y) | (x&y)'],answer:0,explanation:'ç›´æ¥ç§»é¡¹: <code>x|y = (x+y) - (x&y)</code>ã€‚è¿™å°±æ˜¯ORè¡¨ç¤ºæ³•çš„æ¥æºã€‚'}
      ]},
      {id:'w2l3',name:'Dietzæ— æº¢å‡ºå¹³å‡',formula:'avg = (x&y)+((x^y)>>1)',stars:'â­â­â­',tag:'å®‰å…¨æ•°å­¦åŸºç¡€',questions:[
        {type:'é—®é¢˜é¢˜',text:'ç»å…¸ <code>(x+y)/2</code> æœ‰ä»€ä¹ˆæ½œåœ¨é—®é¢˜ï¼Ÿ',options:['x+yå¯èƒ½æ•´æ•°æº¢å‡º','é™¤æ³•å¤ªæ…¢','ç»“æœä¸ç²¾ç¡®','æ²¡æœ‰é—®é¢˜'],answer:0,explanation:'å½“xå’Œyéƒ½å¾ˆå¤§æ—¶(å¦‚æ¥è¿‘INT_MAX)ï¼Œ<code>x+y</code>ä¼šæº¢å‡ºã€‚Java JDKçš„äºŒåˆ†æœç´¢bugå°±å› æ­¤æ½œä¼äº†è¿‘10å¹´ï¼'},
        {type:'åŸç†é¢˜',text:'<code>(x&y)+((x^y)>>1)</code> ä¸ºä»€ä¹ˆèƒ½å®‰å…¨è®¡ç®—å¹³å‡å€¼ï¼Ÿ',options:['x&yæ˜¯å…¬å…±ä½ï¼Œx^yæ˜¯å·®å¼‚ä½å³ç§»å‡åˆ†ï¼Œå„é¡¹ä¸ä¼šè¶…å‡ºèŒƒå›´','è¿™æ˜¯è¿‘ä¼¼ç®—æ³•','å®ƒåªå¯¹æ­£æ•°æœ‰æ•ˆ','å®ƒé¿å…äº†æ‰€æœ‰è¿ç®—'],answer:0,explanation:'å…¬å…±ä½ä¸¤äººéƒ½æœ‰ï¼Œç›´æ¥ä¿ç•™ã€‚å·®å¼‚ä½åªæœ‰ä¸€äººæœ‰ï¼ŒÃ·2å‡åˆ†ã€‚ä¸¤éƒ¨åˆ†ç›¸åŠ ä¸ä¼šæº¢å‡ºï¼Œå› ä¸ºå„é¡¹éƒ½ä¸è¶…è¿‡åŸå§‹å€¼ã€‚'},
        {type:'å†å²é¢˜',text:'2006å¹´Joshua Blochå‘ç°JDKä¸­ <code>mid=(low+high)/2</code> çš„bugï¼Œæ­£ç¡®ä¿®å¤æ˜¯ï¼Ÿ',options:['(low&high)+((low^high)>>1) æˆ– low+(high-low)/2','mid=(low+high)>>>1(ä»…æ— ç¬¦å·)','æ— æ³•ä¿®å¤','ç”¨BigInteger'],answer:0,explanation:'Dietzå…¬å¼æ˜¯æœ€ä¼˜é›…çš„ä¿®å¤ã€‚<code>low+(high-low)/2</code>ä¹Ÿå¯ä»¥ä½†å¤šä¸€æ¬¡å‡æ³•ã€‚JDKåæ¥é‡‡ç”¨äº†æ— ç¬¦å·å³ç§»æ–¹æ¡ˆã€‚'}
      ]},
      {id:'w2l4',name:'XORç‹ç‰Œæ¨å¯¼',formula:'x^y = (x|y)&~(x&y)',stars:'â­',tag:'4æŒ‡ä»¤åˆ†è§£',questions:[
        {type:'é€»è¾‘é¢˜',text:'<code>x^y = (x|y) & ~(x&y)</code> çš„é€»è¾‘å«ä¹‰æ˜¯ï¼Ÿ',options:['è‡³å°‘ä¸€æ–¹ä¸º1ï¼Œä½†ä¸èƒ½ä¸¤æ–¹éƒ½ä¸º1','ä¸¤æ–¹éƒ½ä¸º1','è‡³å°‘ä¸€æ–¹ä¸º0','ä¸¤æ–¹éƒ½ä¸º0'],answer:0,explanation:'<code>x|y</code>: è‡³å°‘ä¸€æ–¹ä¸º1ã€‚<code>~(x&y)</code>: ä¸æ˜¯åŒæ–¹éƒ½ä¸º1ã€‚ANDåˆå¹¶: "è‡³å°‘ä¸€æ–¹ä¸º1 ä¸” ä¸æ˜¯åŒæ–¹éƒ½ä¸º1" = æ°å¥½ä¸€æ–¹ä¸º1 = XORã€‚'},
        {type:'è®¡ç®—é¢˜',text:'<code>x=5(101), y=3(011)</code>ï¼ŒéªŒè¯ <code>x|y = (x+y)-(x&y)</code>',options:['x|y=7, (5+3)-(5&3)=8-1=7 âœ“','x|y=6, ä¸æˆç«‹','x|y=8, ä¸æˆç«‹','ç»“æœä¸º5'],answer:0,explanation:'<code>x|y = 101|011 = 111 = 7</code>ã€‚<code>(x+y)-(x&y) = 8 - 1 = 7 âœ“</code>'}
      ]}
    ]
  },
  {
    id:'w3',icon:'âš¡',title:'æ— åˆ†æ”¯ç®—æœ¯',subtitle:'6ä¸ªæ— åˆ†æ”¯æŠ€å·§',accent:'#f59e0b',accentLight:'#fbbf24',
    levels:[
      {id:'w3l1',name:'ç¬¦å·æ©ç å·¥å…·',formula:'mask = x >> 31',stars:'â­â­',tag:'åŸºç¡€å·¥å…·',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>x >> 31</code>ï¼ˆç®—æœ¯å³ç§»ï¼‰å¯¹32ä½æœ‰ç¬¦å·æ•´æ•°çš„ç»“æœæ˜¯ï¼Ÿ',options:['xä¸ºè´Ÿæ•°æ—¶å…¨1(-1)ï¼Œéè´Ÿæ—¶å…¨0(0)','æ€»æ˜¯0','æ€»æ˜¯1','xçš„ç¬¦å·ä½(0æˆ–1)'],answer:0,explanation:'ç®—æœ¯å³ç§»ä¿ç•™ç¬¦å·ä½ã€‚å³ç§»31ä½åï¼Œè´Ÿæ•°çš„ç¬¦å·ä½1æ‰©å±•ä¸ºå…¨1ï¼ˆå³-1ï¼‰ï¼Œæ­£æ•°/é›¶çš„0æ‰©å±•ä¸ºå…¨0ã€‚è¿™å°±æ˜¯"ç¬¦å·æ©ç "ã€‚'},
        {type:'åº”ç”¨é¢˜',text:'ç¬¦å·æ©ç  <code>mask = x >> 31</code> åœ¨æ— åˆ†æ”¯å…¬å¼ä¸­çš„è§’è‰²ï¼Ÿ',options:['ä½œä¸ºæ¡ä»¶é€‰æ‹©çš„æ§åˆ¶ä¿¡å·ï¼Œæ›¿ä»£ifåˆ†æ”¯','ä½œä¸ºä¹˜æ³•å› å­','ä½œä¸ºé™¤æ³•å› å­','æ— ç‰¹æ®Šä½œç”¨'],answer:0,explanation:'maskä¸ºå…¨0æˆ–å…¨1ï¼Œå¯ä»¥ç”¨AND/XOR/åŠ å‡å®ç°æ¡ä»¶æ“ä½œã€‚å…¨1æ—¶ <code>x^mask=~x</code>ï¼Œå…¨0æ—¶ <code>x^mask=x</code>ã€‚'}
      ]},
      {id:'w3l2',name:'abs(x) - ç»å¯¹å€¼',formula:'abs = (x+mask)^mask',stars:'â­â­â­',tag:'é«˜é¢‘æ“ä½œ',questions:[
        {type:'åŸç†é¢˜',text:'<code>abs(x) = (x + (x>>31)) ^ (x>>31)</code> çš„å·¥ä½œåŸç†ï¼Ÿ',options:['æ­£æ•°mask=0ä¸å˜ï¼›è´Ÿæ•°mask=-1ï¼Œå…ˆåŠ -1å†XORå–åï¼Œç­‰ä»·äºè¡¥ç å–è´Ÿ','ä¸¤ç§æƒ…å†µå¤„ç†æ–¹å¼ç›¸åŒ','åªå¯¹æ­£æ•°æœ‰æ•ˆ','åˆ©ç”¨æµ®ç‚¹è¿ç®—'],answer:0,explanation:'è´Ÿæ•°æ—¶mask=-1(å…¨1): <code>(x+(-1))^(-1) = (x-1)^0xFFFFFFFF</code>ã€‚å¯¹è¡¥ç è´Ÿæ•°å–åå†åŠ 1ç­‰äºå–ç»å¯¹å€¼ï¼Œè¿™é‡Œå…ˆå‡1å†æŒ‰ä½å–åç­‰ä»·ã€‚'},
        {type:'ä¼˜åŠ¿é¢˜',text:'åœ¨SIMD/GPUç¼–ç¨‹ä¸­åå¥½æ— åˆ†æ”¯absçš„åŸå› ï¼Ÿ',options:['é¿å…åˆ†æ”¯é¢„æµ‹å¤±è´¥ï¼Œä¿æŒæµæ°´çº¿æ•ˆç‡ï¼›GPUé¿å…çº¿ç¨‹åˆ†æ­§','ä»£ç æ›´çŸ­','æ›´å®¹æ˜“è°ƒè¯•','æ²¡æœ‰ä¼˜åŠ¿'],answer:0,explanation:'SIMDå¤„ç†å¤šä¸ªæ•°æ®ï¼Œåˆ†æ”¯ä¼šå¯¼è‡´è½¦é“åˆ†æ­§(lane divergence)ã€‚æ— åˆ†æ”¯ç‰ˆæœ¬æ‰€æœ‰è½¦é“æ‰§è¡Œç›¸åŒæŒ‡ä»¤ï¼Œæ•ˆç‡å¤§å¹…æå‡ã€‚åˆ†æ”¯é¢„æµ‹é”™è¯¯æƒ©ç½š10-20ä¸ªå‘¨æœŸã€‚'}
      ]},
      {id:'w3l3',name:'min/maxæ— åˆ†æ”¯',formula:'y+((x-y)&((x-y)>>31))',stars:'â­â­',tag:'æ¡ä»¶é€‰æ‹©',questions:[
        {type:'åŸç†é¢˜',text:'<code>min(x,y) = y + ((x-y) & ((x-y)>>31))</code> æ€ä¹ˆå·¥ä½œï¼Ÿ',options:['x<yæ—¶å·®å€¼ä¸ºè´Ÿæ©ç å…¨1åŠ å·®å€¼å¾—xï¼›xâ‰¥yæ—¶æ©ç å…¨0åŠ 0å¾—y','æ€»æ˜¯è¿”å›y','ç”¨æŸ¥è¡¨å®ç°','éœ€è¦é¢å¤–åˆ¤æ–­'],answer:0,explanation:'ä»¤ <code>d=x-y</code>ã€‚è‹¥x<yï¼Œd<0ï¼Œ<code>d>>31=-1</code>ï¼Œ<code>d&(-1)=d</code>ï¼Œç»“æœ <code>y+d=x</code>ã€‚è‹¥xâ‰¥yï¼Œdâ‰¥0ï¼Œ<code>d>>31=0</code>ï¼Œç»“æœ <code>y+0=y</code>ã€‚'},
        {type:'æ³¨æ„é¢˜',text:'è¿™ä¸ªæ— åˆ†æ”¯minæœ‰ä»€ä¹ˆæ½œåœ¨é—®é¢˜ï¼Ÿ',options:['x-yå¯èƒ½æº¢å‡ºï¼ˆå½“xå’Œyç¬¦å·ç›¸åä¸”ç»å¯¹å€¼å¤§æ—¶ï¼‰','æ²¡æœ‰é—®é¢˜','åªèƒ½å¤„ç†æ­£æ•°','ç»“æœç²¾åº¦ä¸å¤Ÿ'],answer:0,explanation:'å½“xå’Œyä¸€æ­£ä¸€è´Ÿä¸”ç»å¯¹å€¼å¾ˆå¤§æ—¶ï¼Œ<code>x-y</code>å¯èƒ½æº¢å‡ºã€‚å®é™…ä½¿ç”¨ä¸­éœ€ç¡®ä¿å·®å€¼åœ¨intèŒƒå›´å†…ã€‚'}
      ]},
      {id:'w3l4',name:'sign(x) - ç¬¦å·å‡½æ•°',formula:'(x>>31)|((-x)>>31)',stars:'â­â­',tag:'ç¬¦å·åˆ¤æ–­',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>sign(x) = (x>>31) | ((-x)>>31)</code> è¿”å›ä»€ä¹ˆï¼Ÿ',options:['è´Ÿæ•°è¿”å›-1ï¼Œé›¶è¿”å›0ï¼Œæ­£æ•°è¿”å›1','æ€»æ˜¯è¿”å›0æˆ–1','è¿”å›xçš„ç»å¯¹å€¼','è¿”å›xçš„æœ€é«˜ä½'],answer:0,explanation:'<code>x>>31</code>: è´Ÿæ•°ä¸º-1ï¼Œå…¶ä»–ä¸º0ã€‚<code>(-x)>>31</code>: æ­£æ•°æ—¶-xä¸ºè´Ÿæ•°è¯¥é¡¹ä¸º-1ã€‚æ­£æ•°: <code>0|(-1çš„ç¬¦å·æ‰©å±•çš„ä½1ä½)=1</code>ã€‚é›¶: <code>0|0=0</code>ã€‚è´Ÿæ•°: <code>-1|...=-1</code>ã€‚'},
        {type:'å¯¹æ¯”é¢˜',text:'avg(x,y) = (x&y)+((x^y)>>1) ä½“ç°äº†ä»€ä¹ˆè®¾è®¡æ€æƒ³ï¼Ÿ',options:['å°†é—®é¢˜åˆ†è§£ä¸º"å…¬å…±éƒ¨åˆ†"å’Œ"å·®å¼‚éƒ¨åˆ†"åˆ†åˆ«å¤„ç†ï¼Œé¿å…æº¢å‡º','éšæœºç®—æ³•','è¿‘ä¼¼è®¡ç®—','æŸ¥è¡¨æ³•'],answer:0,explanation:'å…¬å…±ä½(x&y)ç›´æ¥ä¿ç•™ï¼Œå·®å¼‚ä½(x^y)å¹³å‡åˆ†é…ã€‚è¿™ç§"åˆ†è€Œæ²»ä¹‹"çš„æ€è·¯æ˜¯æ— æº¢å‡ºç®—æ³•è®¾è®¡çš„ç²¾é«“ï¼Œå¯æ¨å¹¿åˆ°æ›´å¤šåœºæ™¯ã€‚'}
      ]}
    ]
  },
  {
    id:'w4',icon:'ğŸ”€',title:'MUXå¤šè·¯é€‰æ‹©å™¨',subtitle:'2ä¸ªæ ¸å¿ƒå˜ä½“',accent:'#ec4899',accentLight:'#f472b6',
    levels:[
      {id:'w4l1',name:'æ ‡å‡†MUX (4æŒ‡ä»¤)',formula:'(x&m)|(y&~m)',stars:'â­â­',tag:'åŸºç¡€å½¢å¼',questions:[
        {type:'æ¦‚å¿µé¢˜',text:'<code>mux = (x & m) | (y & ~m)</code> çš„è¯­ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ',options:['mä½ä¸º1æ—¶é€‰xï¼Œmä½ä¸º0æ—¶é€‰y','mä½ä¸º1æ—¶é€‰yï¼Œmä½ä¸º0æ—¶é€‰x','æ€»æ˜¯é€‰x','æ€»æ˜¯é€‰y'],answer:0,explanation:'<code>x & m</code> ä¿ç•™xä¸­mä¸º1çš„ä½ã€‚<code>y & ~m</code> ä¿ç•™yä¸­mä¸º0çš„ä½ã€‚ORåˆå¹¶åï¼Œmæ§åˆ¶äº†æ¯ä¸€ä½æ¥è‡ªxè¿˜æ˜¯yã€‚'},
        {type:'ç±»æ¯”é¢˜',text:'MUXåœ¨ç¡¬ä»¶ä¸­å¯¹åº”ä»€ä¹ˆç»„ä»¶ï¼Ÿ',options:['å¤šè·¯é€‰æ‹©å™¨(Multiplexer)','åŠ æ³•å™¨','å¯„å­˜å™¨','æ—¶é’Ÿ'],answer:0,explanation:'è¿™æ­£æ˜¯ç¡¬ä»¶2:1 MUX(å¤šè·¯é€‰æ‹©å™¨)çš„ä½çº§å¹¶è¡Œç‰ˆæœ¬ã€‚æ¯ä¸€ä½ç‹¬ç«‹é€‰æ‹©ï¼Œç›¸å½“äº32ä¸ªå¹¶è¡ŒMUXã€‚'},
        {type:'åº”ç”¨é¢˜',text:'ç”¨MUXå®ç° <code>if(flag) x=a; else x=b;</code> çš„å…³é”®æ­¥éª¤ï¼Ÿ',options:['å°†flagæ‰©å±•ä¸ºå…¨0æˆ–å…¨1çš„æ©ç mï¼Œç„¶å x=(a&m)|(b&~m)','ç›´æ¥ç”¨flagä½œä¸ºm','flagå¿…é¡»æ˜¯0æˆ–1','æ— æ³•å®ç°'],answer:0,explanation:'å…³é”®æ˜¯å°†å¸ƒå°”flagæ‰©å±•ä¸ºä½æ©ç : <code>m = -flag</code>ï¼ˆflagä¸º1æ—¶-1å³å…¨1ï¼Œflagä¸º0æ—¶0å³å…¨0ï¼‰ã€‚å…¨1é€‰aï¼Œå…¨0é€‰bã€‚'}
      ]},
      {id:'w4l2',name:'ä¼˜åŒ–MUX (3æŒ‡ä»¤)',formula:'((x^y)&m)^y',stars:'â­â­â­',tag:'ç¡¬ä»¶ä¼˜åŒ–',questions:[
        {type:'åŸç†é¢˜',text:'<code>((x^y) & m) ^ y</code> ä¸ºä»€ä¹ˆåªéœ€3æ¡æŒ‡ä»¤å°±ç­‰ä»·äºæ ‡å‡†MUXï¼Ÿ',options:['x^yè®¡ç®—å·®å¼‚ï¼Œ&mé€‰æ‹©è¦æ”¹å˜çš„ä½ï¼Œ^yåœ¨yåŸºç¡€ä¸Šåº”ç”¨é€‰ä¸­çš„æ”¹å˜','å®ƒæ˜¯è¿‘ä¼¼ç®—æ³•','ç‰ºç‰²äº†ç²¾åº¦','åªå¯¹ç‰¹å®šè¾“å…¥æœ‰æ•ˆ'],answer:0,explanation:'<code>x^y</code>: xå’Œyçš„å·®å¼‚ä½ã€‚<code>& m</code>: åªä¿ç•™mé€‰ä¸­çš„å·®å¼‚ã€‚<code>^y</code>: å°†è¿™äº›å·®å¼‚åº”ç”¨åˆ°yä¸Šã€‚é€‰ä¸­ä½å˜æˆxï¼Œæœªé€‰ä¸­ä½ä¿æŒyã€‚ç²¾ç¡®ç­‰ä»·ï¼'},
        {type:'è¯æ˜é¢˜',text:'ä»¤må…¨ä¸º1ï¼Œ<code>((x^y)&m)^y</code> åº”è¯¥ç­‰äºï¼Ÿ',options:['xï¼ˆå…¨é€‰xï¼‰','yï¼ˆå…¨é€‰yï¼‰','0','x^y'],answer:0,explanation:'må…¨1: <code>((x^y)&1...1)^y = (x^y)^y = x</code>ã€‚XORçš„è‡ªé€†æ€§ï¼š<code>a^b^b = a</code>ã€‚å®Œç¾é€‰ä¸­xã€‚'},
        {type:'ä¼˜åŠ¿é¢˜',text:'èŠ‚çœ1æ¡æŒ‡ä»¤åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹æ„ä¹‰æœ€é‡å¤§ï¼Ÿ',options:['SIMD/GPUå¹¶è¡Œå¤„ç†å¤§é‡æ•°æ®æ—¶ï¼ŒèŠ‚çœæ•°åäº¿æ¬¡æ“ä½œ','æ—¥å¸¸ç¼–ç¨‹','è„šæœ¬è¯­è¨€','å•æ¬¡è°ƒç”¨'],answer:0,explanation:'å¤„ç†ç™¾ä¸‡åƒç´ å›¾åƒæˆ–GPU shaderæ—¶ï¼Œæ¯åƒç´ èŠ‚çœ1æ¡æŒ‡ä»¤å°±èƒ½èŠ‚çœæ•°ç™¾ä¸‡æ¬¡æ“ä½œã€‚åœ¨ç¡¬ä»¶ç”µè·¯ä¸­è¿˜å°‘ä¸€ä¸ªé—¨ç”µè·¯ï¼Œçœé¢ç§¯çœåŠŸè€—ã€‚'}
      ]}
    ]
  },
  {
    id:'w5',icon:'ğŸŒŸ',title:"Gosper's Hack",subtitle:'4æ­¥ç»„åˆæšä¸¾åŠ é€Ÿ',accent:'#8b5cf6',accentLight:'#a78bfa',
    levels:[
      {id:'w5l1',name:'Step1: æå–æœ€ä½1',formula:'c = x & (-x)',stars:'â­â­â­',tag:'è¿›ä½ç‚¹è¯†åˆ«',questions:[
        {type:'æ¦‚å¿µé¢˜',text:"åœ¨Gosper's Hackä¸­ï¼Œ<code>c = x & (-x)</code> çš„è§’è‰²æ˜¯ï¼Ÿ",options:['å®šä½"è¿›ä½æ³¨å…¥ç‚¹"â€”â€”æœ€ä½ä½çš„1ï¼Œæ˜¯ç®—æ³•çš„èµ·ç‚¹','ç”Ÿæˆæœ€ç»ˆç»“æœ','è®¡ç®—popcount','ä¸ä¸»ç®—æ³•æ— å…³'],answer:0,explanation:'cæ˜¯æœ€ä½ä½çš„1(LSB)ï¼Œä»£è¡¨æˆ‘ä»¬å°†åœ¨è¿™ä¸ªä½ç½®"åŠ 1"æ¥è§¦å‘è¿›ä½çº§è”ã€‚è¿™æ˜¯æ‰¾åˆ°ä¸‹ä¸€ä¸ªåŒpopcountæ’åˆ—çš„ç¬¬ä¸€æ­¥ã€‚'},
        {type:'ç†è§£é¢˜',text:'ä¸ºä»€ä¹ˆé€‰æ‹©æœ€ä½ä½çš„1ä½œä¸ºæ“ä½œèµ·ç‚¹ï¼Ÿ',options:['ä»æœ€ä½ä½å¼€å§‹è¿›ä½æ˜¯ç”Ÿæˆ"ä¸‹ä¸€ä¸ªæ’åˆ—"çš„æœ€å°å¢é‡æ–¹å¼','éšæœºé€‰æ‹©éƒ½å¯ä»¥','æœ€é«˜ä½æ•ˆæœä¸€æ ·','ç®—æ³•è¦æ±‚å¿…é¡»ä»å³å¾€å·¦'],answer:0,explanation:'ç±»ä¼¼åè¿›åˆ¶è®¡æ•°ï¼Œæˆ‘ä»¬ä»æœ€ä½ä½å¼€å§‹é€’å¢ã€‚åœ¨ä½æ’åˆ—ä¸­ï¼Œä»æœ€ä½çš„1å¼€å§‹è¿›ä½ï¼Œèƒ½æ‰¾åˆ°å­—å…¸åºç´§é‚»çš„ä¸‹ä¸€ä¸ªæ’åˆ—ã€‚'}
      ]},
      {id:'w5l2',name:'Step2+3+4: å®Œæ•´æµç¨‹',formula:'r=x+c; ones=(((r^x)/c)>>2)+1; result=r|ones',stars:'â­â­â­',tag:'çº§è”ç¿»è½¬+åˆå¹¶',questions:[
        {type:'æ ¸å¿ƒé¢˜',text:'<code>r = x + c</code> æ‰§è¡Œ"è¿›ä½ä¼ æ’­"ï¼Œå…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ',options:['ä»æœ€ä½1å¼€å§‹è¿ç»­è¿›ä½ï¼Œç¿»è½¬ä¸€ä¸²è¿ç»­çš„1ï¼Œå¹¶åœ¨æ›´é«˜ä½äº§ç”Ÿä¸€ä¸ªæ–°çš„1','ç®€å•åŠ æ³•æ— ç‰¹æ®Šæ•ˆæœ','æ¸…é™¤æ‰€æœ‰ä½','å·¦ç§»ä¸€ä½'],answer:0,explanation:'åŠ cç›¸å½“äºåœ¨æœ€ä½1å¤„åŠ 1ï¼Œè§¦å‘è¿›ä½é“¾ã€‚è¿ç»­çš„1è¢«è¿›ä½ç¿»è½¬ä¸º0ï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ª0ï¼Œè¯¥0å˜ä¸º1ã€‚è¿™å°±æ˜¯"çº§è”ç¿»è½¬"ã€‚'},
        {type:'å…³é”®é¢˜',text:'Step3ä¸ºä»€ä¹ˆè¦è®¡ç®—"è¡¥å›"çš„1çš„ä¸ªæ•°ï¼Ÿ',options:['è¿›ä½ä¼ æ’­æ¶ˆç­äº†ä¸€äº›1ï¼Œéœ€è¦åœ¨ä½ä½è¡¥å›ç›¸åŒæ•°é‡ä»¥ä¿æŒæ€»popcountä¸å˜','ä¸ºäº†ç¾è§‚','ä¸éœ€è¦è¡¥å›','ä¸ºäº†å‡‘æ•´'],answer:0,explanation:"Gosper's Hackçš„æ ¸å¿ƒçº¦æŸ: è¾“å‡ºä¸è¾“å…¥æœ‰ç›¸åŒæ•°é‡çš„1ã€‚Step2æ¶ˆç­äº†ä¸€äº›1åˆäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„1ï¼Œå·®é¢éœ€è¦åœ¨æœ€ä½ä½è¡¥å›ã€‚"},
        {type:'ç»¼åˆé¢˜',text:"Gosper's Hackå®Œæ•´æµç¨‹ç”Ÿæˆçš„æ˜¯ä»€ä¹ˆï¼Ÿ",options:['å…·æœ‰ç›¸åŒpopcountçš„ä¸‹ä¸€ä¸ªå­—å…¸åºæ›´å¤§çš„æ•´æ•°','ä»»æ„éšæœºæ•°','popcountæ›´å¤§çš„æ•°','popcountæ›´å°çš„æ•°'],answer:0,explanation:'é€šè¿‡è¿›ä½ä¼ æ’­(é«˜ä½è¿›ä¸€æ­¥)å’Œä½ä½è¡¥1(ä¿æŒæ€»æ•°)ï¼Œç”Ÿæˆå­—å…¸åºç´§é‚»çš„ä¸‹ä¸€ä¸ªåŒpopcountæ•´æ•°ã€‚è¿™å°±æ˜¯"åŒpopcountæšä¸¾å™¨"ã€‚'},
        {type:'æ€§èƒ½é¢˜',text:"ç›¸æ¯”æš´åŠ›æšä¸¾ï¼ŒGosper's Hackå¿«å¤šå°‘ï¼Ÿ",options:['å¯è¾¾100å€ä»¥ä¸Šï¼ˆç›´æ¥è·³åˆ°ä¸‹ä¸€ä¸ªæœ‰æ•ˆæ’åˆ—ï¼‰','2å€','10å€','æ²¡æœ‰æ˜æ˜¾æå‡'],answer:0,explanation:'æš´åŠ›éœ€è¦æ£€æŸ¥æ¯ä¸ªæ•°æ˜¯å¦æ»¡è¶³popcountï¼Œå¤§éƒ¨åˆ†ä¸æ»¡è¶³è¢«æµªè´¹ã€‚Gosperç›´æ¥è·³åˆ°ä¸‹ä¸€ä¸ªæœ‰æ•ˆæ’åˆ—ï¼Œåœ¨C(32,5)ä¸­æ¯”æš´åŠ›å¿«100å€ä»¥ä¸Šã€‚'}
      ]}
    ]
  },
  {
  id:'w6', icon:'ğŸ', title:'ç‰¹æ®ŠæŠ€å·§', subtitle:'8ä¸ªå®ç”¨ç‰¹æ®ŠæŠ€å·§',
  accent:'#f97316', accentLight:'#fb923c',
  levels:[

    // â”€â”€ Level 1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    {
      id:'w6l1', name:'æº¢å‡ºæ£€æµ‹', formula:'((x^sum)&(y^sum))>>31',
      stars:'â­â­', tag:'ç®—æœ¯æ£€æµ‹',
      questions:[
        {
          type:'åŸç†é¢˜',
          text:'<code>((x^sum) & (y^sum)) >> 31</code> æ£€æµ‹çš„æ˜¯ä»€ä¹ˆæº¢å‡ºï¼Ÿ',
          options:[
            'æœ‰ç¬¦å·åŠ æ³•æº¢å‡º: ä¸¤ä¸ªåŒå·æ•°ç›¸åŠ å¾—åˆ°å¼‚å·ç»“æœ',
            'æ— ç¬¦å·æº¢å‡º',
            'ä¹˜æ³•æº¢å‡º',
            'é™¤æ³•æº¢å‡º'
          ],
          answer:0,
          explanation:'<code>x^sum</code>: xå’Œç»“æœç¬¦å·ä¸åŒæ—¶è¯¥å€¼ä¸ºè´Ÿ(æœ€é«˜ä½ä¸º1)ã€‚<code>y^sum</code>: yå’Œç»“æœç¬¦å·ä¸åŒæ—¶åŒç†ã€‚ä¸¤è€…éƒ½ä¸ºè´Ÿ(ANDç»“æœæœ€é«˜ä½ä¸º1)ï¼Œæ„å‘³ç€xå’ŒyåŒå·ä½†ç»“æœå¼‚å·â€”â€”è¿™æ­£æ˜¯æœ‰ç¬¦å·æº¢å‡ºçš„å®šä¹‰ã€‚'
        },
        {
          type:'åº”ç”¨é¢˜',
          text:'ä¸‹é¢å“ªç§æƒ…å†µä¼šè§¦å‘æœ‰ç¬¦å·åŠ æ³•æº¢å‡ºï¼Ÿ',
          options:[
            'ä¸¤ä¸ªæ­£æ•°ç›¸åŠ å¾—åˆ°è´Ÿæ•°ï¼Œæˆ–ä¸¤ä¸ªè´Ÿæ•°ç›¸åŠ å¾—åˆ°æ­£æ•°',
            'æ­£æ•°åŠ è´Ÿæ•°',
            'ä»»ä½•åŠ æ³•éƒ½å¯èƒ½æº¢å‡º',
            'åªæœ‰ä¹˜æ³•ä¼šæº¢å‡º'
          ],
          answer:0,
          explanation:'æ­£+æ­£=è´Ÿ(ä¸Šæº¢) æˆ– è´Ÿ+è´Ÿ=æ­£(ä¸‹æº¢) æ˜¯ä¸¤ç§æœ‰ç¬¦å·åŠ æ³•æº¢å‡ºã€‚æ­£æ•°åŠ è´Ÿæ•°æ°¸è¿œä¸ä¼šæº¢å‡ºï¼Œå› ä¸ºç»“æœç»å¯¹å€¼ä¸è¶…è¿‡ä¸¤è€…ä¸­è¾ƒå¤§çš„é‚£ä¸ªã€‚'
        },
        {
          type:'è®¡ç®—é¢˜',
          text:'è®¾ <code>x=0x7FFFFFFF, y=1</code>ï¼Œ<code>sum=x+y=0x80000000</code>ï¼Œæº¢å‡ºæ£€æµ‹è¡¨è¾¾å¼ç»“æœæ˜¯ï¼Ÿ',
          options:[
            '-1ï¼ˆæœ€é«˜ä½ä¸º1ï¼Œè¡¨ç¤ºå‘ç”Ÿäº†æº¢å‡ºï¼‰',
            '0ï¼ˆæœªå‘ç”Ÿæº¢å‡ºï¼‰',
            '1',
            '0x7FFFFFFF'
          ],
          answer:0,
          explanation:'<code>x^sum = 0x7FFFFFFF ^ 0x80000000 = 0xFFFFFFFF</code>ï¼ˆè´Ÿï¼‰ï¼›<code>y^sum = 0x00000001 ^ 0x80000000 = 0x80000001</code>ï¼ˆè´Ÿï¼‰ï¼›ä¸¤è€…ANDæœ€é«˜ä½ä¸º1ï¼Œ>>31å¾—-1ï¼Œè¡¨ç¤ºæº¢å‡ºã€‚'
        },
        {
          type:'å¯¹æ¯”é¢˜',
          text:'C/C++ä¸­æœ‰ç¬¦å·æ•´æ•°æº¢å‡ºçš„æ ‡å‡†å®šä¹‰æ˜¯ï¼Ÿ',
          options:[
            'æœªå®šä¹‰è¡Œä¸º(Undefined Behavior)ï¼Œç¼–è¯‘å™¨å¯ä»¥åšä»»æ„å‡è®¾',
            'å›ç»•(wrap around)åˆ°æœ€å°å€¼',
            'æŠ›å‡ºå¼‚å¸¸',
            'äº§ç”Ÿä¸ç¡®å®šå€¼ä½†ä¸æ˜¯UB'
          ],
          answer:0,
          explanation:'C/C++æ ‡å‡†æ˜ç¡®è§„å®šï¼šæœ‰ç¬¦å·æ•´æ•°æº¢å‡ºæ˜¯æœªå®šä¹‰è¡Œä¸º(UB)ã€‚ç¼–è¯‘å™¨å¯åˆ©ç”¨"ä¸å‘ç”Ÿæº¢å‡º"å‡è®¾åšæ¿€è¿›ä¼˜åŒ–ï¼Œå¯¼è‡´å®‰å…¨æ£€æŸ¥è¢«åˆ é™¤ã€‚Java/Goç­‰è¯­è¨€åˆ™æ˜ç¡®å®šä¹‰ä¸ºå›ç»•ã€‚'
        }
      ]
    },

    // â”€â”€ Level 2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    {
      id:'w6l2', name:'ç¬¦å·æ‰©å±•', formula:'(x<<(32-n))>>(32-n)',
      stars:'â­â­', tag:'ç±»å‹è½¬æ¢',
      questions:[
        {
          type:'åŸç†é¢˜',
          text:'<code>(x << (32-n)) >> (32-n)</code> å¦‚ä½•å®ç°nä½åˆ°32ä½çš„ç¬¦å·æ‰©å±•ï¼Ÿ',
          options:[
            'å·¦ç§»æŠŠç¬¬nä½(ç¬¦å·ä½)ç§»åˆ°æœ€é«˜ä½ï¼Œç®—æœ¯å³ç§»ç”¨ç¬¦å·ä½å¡«å……é«˜ä½',
            'ç›´æ¥æ¸…é™¤é«˜ä½ï¼Œä¿ç•™ä½nä½',
            'ç¿»è½¬æ‰€æœ‰ä½åå³ç§»',
            'ç”¨æ©ç  <code>0xFFFFFFFF >> (32-n)</code> æå–ä½nä½'
          ],
          answer:0,
          explanation:'ä¸¤æ­¥æ“ä½œï¼šâ‘ å·¦ç§» <code>32-n</code> ä½å°†ç¬¬nä½(nä½æ•°çš„ç¬¦å·ä½)ç§»åˆ°ç¬¬31ä½(æœ€é«˜ä½)ï¼›â‘¡ç®—æœ¯å³ç§» <code>32-n</code> ä½ï¼ŒCPUç”¨ç¬¦å·ä½å¡«å……ç©ºå‡ºçš„é«˜ä½ã€‚è‹¥åŸç¬¦å·ä¸º1åˆ™é«˜ä½å…¨å¡«1ï¼Œä¸º0åˆ™å…¨å¡«0ã€‚'
        },
        {
          type:'è®¡ç®—é¢˜',
          text:'å¯¹5ä½æœ‰ç¬¦å·æ•° <code>x = 0b10001 (-15)</code> åšç¬¦å·æ‰©å±•åˆ°8ä½ï¼Œç»“æœæ˜¯ï¼Ÿ',
          options:[
            '0b11110001 (0xF1, -15)',
            '0b00010001 (17)',
            '0b10001000',
            '0b11111111 (-1)'
          ],
          answer:0,
          explanation:'5ä½æ•° <code>10001</code> çš„ç¬¦å·ä½ä¸º1(è´Ÿæ•°)ã€‚ç¬¦å·æ‰©å±•åˆ°8ä½ï¼šé«˜3ä½å…¨è¡¥1ï¼Œå¾— <code>11110001</code>ã€‚è¡¥ç éªŒè¯ï¼š-16+1=-15 âœ“ã€‚'
        },
        {
          type:'å¯¹æ¯”é¢˜',
          text:'ç¬¦å·æ‰©å±•(Sign Extension) å’Œ é›¶æ‰©å±•(Zero Extension) çš„åŒºåˆ«æ˜¯ï¼Ÿ',
          options:[
            'ç¬¦å·æ‰©å±•ç”¨åŸæ•°ç¬¦å·ä½å¡«å……é«˜ä½ï¼›é›¶æ‰©å±•é«˜ä½ä¸€å¾‹å¡«0',
            'ä¸¤è€…å®Œå…¨ç›¸åŒ',
            'ç¬¦å·æ‰©å±•åªé€‚ç”¨äºæ­£æ•°',
            'é›¶æ‰©å±•ä¼šæ”¹å˜æ•°å€¼'
          ],
          answer:0,
          explanation:'æœ‰ç¬¦å·æ•°è½¬æ¢ç”¨ç¬¦å·æ‰©å±•ï¼ˆCä¸­çš„éšå¼è½¬æ¢ï¼‰ï¼›æ— ç¬¦å·æ•°è½¬æ¢ç”¨é›¶æ‰©å±•ã€‚é”™è¯¯åœ°é€‰æ‹©ä¼šå¯¼è‡´è´Ÿæ•°å˜æˆå·¨å¤§æ­£æ•°çš„ç»å…¸bugï¼Œå¦‚ <code>char -1</code> é›¶æ‰©å±•ä¸º <code>0xFF=255</code>ï¼Œè€Œé <code>-1</code>ã€‚'
        },
        {
          type:'åº”ç”¨é¢˜',
          text:'x86æŒ‡ä»¤ <code>MOVSX</code> å’Œ <code>MOVZX</code> åˆ†åˆ«å¯¹åº”å“ªç§æ‰©å±•ï¼Ÿ',
          options:[
            'MOVSX=ç¬¦å·æ‰©å±•ä¼ é€ï¼ŒMOVZX=é›¶æ‰©å±•ä¼ é€',
            'MOVSX=é›¶æ‰©å±•ï¼ŒMOVZX=ç¬¦å·æ‰©å±•',
            'ä¸¤è€…åŠŸèƒ½ç›¸åŒ',
            'éƒ½æ˜¯ç¬¦å·æ‰©å±•'
          ],
          answer:0,
          explanation:'<code>MOVSX eax, al</code>ï¼šæŠŠALçš„å€¼ç¬¦å·æ‰©å±•åˆ°32ä½æ”¾å…¥EAXã€‚<code>MOVZX eax, al</code>ï¼šæŠŠALçš„å€¼é›¶æ‰©å±•åˆ°32ä½ã€‚Cä¸­ <code>int i = (signed char)x</code> å¯¹åº”MOVSXï¼Œ<code>unsigned int u = (unsigned char)x</code> å¯¹åº”MOVZXã€‚'
        }
      ]
    },

    // â”€â”€ Level 3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    {
      id:'w6l3', name:'æ¡ä»¶ç½®ä½/æ¸…ä½', formula:'x |= (1<<n) / x &= ~(1<<n)',
      stars:'â­', tag:'ä½åŸŸæ“ä½œ',
      questions:[
        {
          type:'æ¦‚å¿µé¢˜',
          text:'å¦‚ä½•åœ¨ä¸å½±å“å…¶ä»–ä½çš„å‰æä¸‹ï¼Œå°†xçš„ç¬¬nä½ç½®ä¸º1ï¼Ÿ',
          options:[
            'x |= (1 << n)',
            'x &= (1 << n)',
            'x ^= (1 << n)',
            'x = (1 << n)'
          ],
          answer:0,
          explanation:'<code>1 << n</code> ç”Ÿæˆåªæœ‰ç¬¬nä½ä¸º1çš„æ©ç ã€‚ORæ“ä½œï¼šåŸæœ¬ä¸º1çš„ä½ä¿æŒ1ï¼ŒåŸæœ¬ä¸º0çš„ç¬¬nä½å˜ä¸º1ï¼Œå…¶ä½™ä½ä¸å—å½±å“ã€‚è¿™æ˜¯"ç½®ä½"(set bit)çš„æ ‡å‡†å†™æ³•ã€‚'
        },
        {
          type:'æ¦‚å¿µé¢˜',
          text:'å¦‚ä½•åœ¨ä¸å½±å“å…¶ä»–ä½çš„å‰æä¸‹ï¼Œå°†xçš„ç¬¬nä½æ¸…ä¸º0ï¼Ÿ',
          options:[
            'x &= ~(1 << n)',
            'x |= ~(1 << n)',
            'x ^= ~(1 << n)',
            'x &= (1 << n)'
          ],
          answer:0,
          explanation:'<code>~(1 << n)</code> ç”Ÿæˆåªæœ‰ç¬¬nä½ä¸º0å…¶ä½™å…¨ä¸º1çš„æ©ç ã€‚ANDæ“ä½œï¼šå…¶ä½™ä½ä¸1 ANDä¿æŒä¸å˜ï¼Œç¬¬nä½ä¸0 ANDå˜ä¸º0ã€‚è¿™æ˜¯"æ¸…ä½"(clear bit)çš„æ ‡å‡†å†™æ³•ã€‚'
        },
        {
          type:'æ¦‚å¿µé¢˜',
          text:'å¦‚ä½•ç¿»è½¬xçš„ç¬¬nä½ï¼ˆ0å˜1ï¼Œ1å˜0ï¼‰ï¼Ÿ',
          options:[
            'x ^= (1 << n)',
            'x |= (1 << n)',
            'x &= (1 << n)',
            'x -= (1 << n)'
          ],
          answer:0,
          explanation:'XORçš„è‡ªåæ€§ï¼šä¸1 XORåˆ™ç¿»è½¬ï¼Œä¸0 XORåˆ™ä¿æŒã€‚<code>1 << n</code> æ©ç ä½¿ç¬¬nä½ä¸1å¼‚æˆ–ï¼ˆç¿»è½¬ï¼‰ï¼Œå…¶ä»–ä½ä¸0å¼‚æˆ–ï¼ˆä¸å˜ï¼‰ã€‚è¿™æ˜¯"ç¿»è½¬ä½"(toggle bit)çš„æ ‡å‡†å†™æ³•ã€‚'
        },
        {
          type:'ç»¼åˆé¢˜',
          text:'å¦‚ä½•è¯»å–xçš„ç¬¬nä½çš„å€¼ï¼ˆç»“æœä¸º0æˆ–1ï¼‰ï¼Ÿ',
          options:[
            '(x >> n) & 1',
            '(x & n) >> 1',
            'x & (1 << n)',
            '(x | n) & 1'
          ],
          answer:0,
          explanation:'å…ˆå³ç§»nä½å°†ç›®æ ‡ä½ç§»åˆ°æœ€ä½ä½ï¼Œå†ä¸1åšANDæå–æœ€ä½ä½ã€‚ç»“æœä¸º0æˆ–1ã€‚å¦ä¸€ç§å†™æ³• <code>(x >> n) & 1</code> å’Œ <code>!!(x & (1<<n))</code> ç­‰ä»·ï¼Œä½†å‰è€…æ›´ç›´æ¥ã€‚'
        }
      ]
    },

    // â”€â”€ Level 4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    {
      id:'w6l4', name:'å­—èŠ‚åºåè½¬(BSWAP)', formula:'å¾ªç¯ç§»ä½ç»„åˆå®ç°',
      stars:'â­â­', tag:'ç½‘ç»œ/å¤§ç«¯',
      questions:[
        {
          type:'æ¦‚å¿µé¢˜',
          text:'å­—èŠ‚åºåè½¬(byte swap)çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ',
          options:[
            'å°†å¤§ç«¯(big-endian)å’Œå°ç«¯(little-endian)æ ¼å¼ç›¸äº’è½¬æ¢',
            'åè½¬æ‰€æœ‰æ¯”ç‰¹ä½',
            'å°†æ­£æ•°å˜ä¸ºè´Ÿæ•°',
            'å¾ªç¯ç§»ä½32ä½'
          ],
          answer:0,
          explanation:'ç½‘ç»œåè®®(TCP/IP)ä½¿ç”¨å¤§ç«¯å­—èŠ‚åºï¼Œx86 CPUä½¿ç”¨å°ç«¯å­—èŠ‚åºã€‚æ”¶å‘ç½‘ç»œæ•°æ®æ—¶éœ€è¦å­—èŠ‚åºè½¬æ¢ã€‚ä¾‹å¦‚ <code>0x12345678</code> å¤§ç«¯â†’å°ç«¯å˜ä¸º <code>0x78563412</code>ã€‚'
        },
        {
          type:'è®¡ç®—é¢˜',
          text:'å¯¹ <code>x = 0x12345678</code> æ‰§è¡Œå­—èŠ‚åºåè½¬ï¼Œç»“æœæ˜¯ï¼Ÿ',
          options:[
            '0x78563412',
            '0x87654321',
            '0x21436587',
            '0x12345678'
          ],
          answer:0,
          explanation:'å­—èŠ‚åºåè½¬å°†4ä¸ªå­—èŠ‚é€†åºæ’åˆ—ï¼šå­—èŠ‚0(0x78)â†”å­—èŠ‚3(0x12)ï¼Œå­—èŠ‚1(0x56)â†”å­—èŠ‚2(0x34)ã€‚ç»“æœï¼š<code>0x78 56 34 12 = 0x78563412</code>ã€‚'
        },
        {
          type:'å®ç°é¢˜',
          text:'ç”¨ä½æ“ä½œå®ç°32ä½å­—èŠ‚åºåè½¬çš„è¡¨è¾¾å¼æ˜¯ï¼Ÿ',
          options:[
            '<code>((x&0xFF)<<24)|((x&0xFF00)<<8)|((x>>8)&0xFF00)|((x>>24)&0xFF)</code>',
            '<code>~x</code>',
            '<code>x << 16 | x >> 16</code>',
            '<code>x & 0xFF00FF00</code>'
          ],
          answer:0,
          explanation:'åˆ†åˆ«æå–å¹¶ç§»åŠ¨4ä¸ªå­—èŠ‚ï¼šå­—èŠ‚0å·¦ç§»24ä½åˆ°æœ€é«˜å­—èŠ‚ä½ç½®ï¼Œå­—èŠ‚1å·¦ç§»8ä½ï¼Œå­—èŠ‚2å³ç§»8ä½ï¼Œå­—èŠ‚3å³ç§»24ä½ï¼Œæœ€åORåˆå¹¶ã€‚x86æä¾› <code>BSWAP</code> å•æ¡æŒ‡ä»¤å®Œæˆæ­¤æ“ä½œã€‚'
        },
        {
          type:'åº”ç”¨é¢˜',
          text:'Cè¯­è¨€ä¸­ <code>htonl()</code> å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Ÿ',
          options:[
            'å°†32ä½æ•´æ•°ä»ä¸»æœºå­—èŠ‚åºè½¬ä¸ºç½‘ç»œå­—èŠ‚åº(å¤§ç«¯)',
            'å°†å­—ç¬¦ä¸²è½¬ä¸ºæ•´æ•°',
            'è®¡ç®—ç½‘ç»œå»¶è¿Ÿ',
            'åè½¬æ‰€æœ‰ä½'
          ],
          answer:0,
          explanation:'<code>htonl</code> = Host TO Network Longã€‚åœ¨å°ç«¯ä¸»æœº(x86)ä¸Šç­‰ä»·äºå­—èŠ‚åºåè½¬ï¼›åœ¨å¤§ç«¯ä¸»æœºä¸Šæ˜¯ç©ºæ“ä½œ(no-op)ã€‚å¯¹åº”çš„è¿˜æœ‰ <code>ntohl</code>(ç½‘ç»œâ†’ä¸»æœº)ï¼Œ<code>htons/ntohs</code>(16ä½ç‰ˆæœ¬)ã€‚'
        }
      ]
    },

    // â”€â”€ Level 5 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    {
      id:'w6l5', name:'æ¨¡2çš„å¹‚å–ä½™', formula:'x & (n-1)',
      stars:'â­â­', tag:'å“ˆå¸Œ/ç¯å½¢ç¼“å†²',
      questions:[
        {
          type:'æ¦‚å¿µé¢˜',
          text:'å½“ <code>n</code> æ˜¯2çš„å¹‚æ—¶ï¼Œ<code>x % n</code> å¯ä»¥ç”¨ä»€ä¹ˆä½æ“ä½œæ›¿ä»£ï¼Ÿ',
          options:[
            'x & (n-1)',
            'x | (n-1)',
            'x ^ (n-1)',
            'x >> log2(n)'
          ],
          answer:0,
          explanation:'2çš„å¹‚ <code>n = 2^k</code> çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯1åè·Ÿkä¸ª0ï¼Œ<code>n-1</code> åˆ™æ˜¯kä¸ª1çš„æ©ç ã€‚<code>x & (n-1)</code> ä¿ç•™xçš„ä½kä½ï¼Œæ­£å¥½ç­‰äº <code>x mod n</code>ã€‚ä¾‹å¦‚ <code>x % 8 = x & 7</code>ã€‚'
        },
        {
          type:'æ€§èƒ½é¢˜',
          text:'<code>x & (n-1)</code> ç›¸æ¯” <code>x % n</code> çš„æ€§èƒ½ä¼˜åŠ¿æ˜¯ï¼Ÿ',
          options:[
            'ä½ANDæ˜¯å•å‘¨æœŸæŒ‡ä»¤ï¼Œæ•´æ•°é™¤æ³•(%)éœ€è¦20-90ä¸ªå‘¨æœŸ',
            'ä¸¤è€…æ€§èƒ½ç›¸åŒ',
            'ANDåªå¿«2å€',
            'åªåœ¨nå¾ˆå°æ—¶æ‰å¿«'
          ],
          answer:0,
          explanation:'æ•´æ•°é™¤æ³•æ˜¯CPUæœ€æ…¢çš„è¿ç®—ä¹‹ä¸€ï¼Œx86 DIVæŒ‡ä»¤éœ€è¦20-90ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚ä½ANDæ˜¯å•å‘¨æœŸæ“ä½œï¼Œå¿«çº¦20-90å€ã€‚ç¼–è¯‘å™¨åœ¨næ˜¯ç¼–è¯‘æœŸå¸¸æ•°ä¸”ä¸º2çš„å¹‚æ—¶ä¼šè‡ªåŠ¨åšæ­¤ä¼˜åŒ–ï¼Œä½†nåœ¨è¿è¡Œæ—¶ç¡®å®šæ—¶éœ€æ‰‹åŠ¨ä¼˜åŒ–ã€‚'
        },
        {
          type:'åº”ç”¨é¢˜',
          text:'ç¯å½¢ç¼“å†²åŒº(Ring Buffer)ä¸­å¦‚ä½•ç”¨ä½æ“ä½œå®ç°ä¸‹æ ‡å›ç»•ï¼Ÿ',
          options:[
            'ç¼“å†²åŒºå¤§å°è®¾ä¸º2çš„å¹‚Nï¼Œä¸‹æ ‡ç”¨ <code>index & (N-1)</code> ä»£æ›¿ <code>index % N</code>',
            'ç”¨ifè¯­å¥åˆ¤æ–­æ˜¯å¦è¶…å‡º',
            'æ¯æ¬¡æ‰‹åŠ¨å‡å»N',
            'ä½¿ç”¨å–æ¨¡ä½†å­˜å‚¨ç»“æœ'
          ],
          answer:0,
          explanation:'ç»å…¸è®¾è®¡ï¼šå°†ç¯å½¢ç¼“å†²åŒºå¤§å°è®¾ä¸º2çš„å¹‚ï¼ˆå¦‚1024ï¼‰ã€‚å…¥é˜Ÿ/å‡ºé˜ŸæŒ‡é’ˆè‡ªå¢åç”¨ <code>ptr & (SIZE-1)</code> å–ä½™ï¼Œæ¯” <code>if(ptr>=SIZE) ptr=0</code> æ›´å¿«ä¸”æ— åˆ†æ”¯ã€‚Linuxå†…æ ¸çš„ <code>kfifo</code> å°±é‡‡ç”¨æ­¤è®¾è®¡ã€‚'
        },
        {
          type:'é™·é˜±é¢˜',
          text:'<code>x & (n-1)</code> ç”¨äºå–ä½™æœ‰ä»€ä¹ˆé™åˆ¶æ¡ä»¶ï¼Ÿ',
          options:[
            'nå¿…é¡»æ˜¯2çš„æ­£æ•´æ•°æ¬¡å¹‚ï¼Œä¸”xå¿…é¡»æ˜¯æ— ç¬¦å·æ•´æ•°æˆ–éè´Ÿæœ‰ç¬¦å·æ•´æ•°',
            'æ— ä»»ä½•é™åˆ¶',
            'åªèƒ½ç”¨äº32ä½æ•´æ•°',
            'nå¿…é¡»å°äº256'
          ],
          answer:0,
          explanation:'ä¸¤ä¸ªå‰æï¼šâ‘ nå¿…é¡»æ˜¯2çš„å¹‚ï¼Œå¦åˆ™ç»“æœé”™è¯¯ã€‚â‘¡xä¸ºè´Ÿæ•°æ—¶ï¼ŒCä¸­ <code>%</code> çš„ç»“æœå¯èƒ½ä¸ºè´Ÿï¼ˆå®ç°å®šä¹‰ï¼‰ï¼Œè€Œ <code>&</code> ç»“æœæ’éè´Ÿï¼Œè¯­ä¹‰ä¸åŒã€‚æ— ç¬¦å·æ•´æ•°æˆ–ç¡®ä¿xâ‰¥0æ—¶ä¸¤è€…ç­‰ä»·ã€‚'
        }
      ]
    },

    // â”€â”€ Level 6 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    {
      id:'w6l6', name:'ä½è®¡æ•°(Popcount)', formula:'å¤šç§å®ç°æ–¹å¼å¯¹æ¯”',
      stars:'â­â­â­', tag:'æ±‰æ˜é‡é‡',
      questions:[
        {
          type:'æ¦‚å¿µé¢˜',
          text:'Popcount(Population Count)è®¡ç®—çš„æ˜¯ä»€ä¹ˆï¼Ÿ',
          options:[
            'ä¸€ä¸ªæ•´æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­1çš„ä¸ªæ•°(æ±‰æ˜é‡é‡)',
            'äºŒè¿›åˆ¶ä¸­0çš„ä¸ªæ•°',
            'æœ€é«˜ä½1çš„ä½ç½®',
            'æœ€ä½ä½1çš„ä½ç½®'
          ],
          answer:0,
          explanation:'Popcountä¹Ÿå«"æ±‰æ˜é‡é‡"(Hamming Weight)æˆ–"ä½è®¡æ•°"ã€‚ä¾‹å¦‚ <code>popcount(0b10110101) = 5</code>ï¼ˆæœ‰5ä¸ª1ï¼‰ã€‚åº”ç”¨å¹¿æ³›ï¼šçº é”™ç ã€å¯†ç å­¦ã€æ£‹ç›˜æ¸¸æˆã€æ•°æ®å‹ç¼©ç­‰ã€‚'
        },
        {
          type:'å®ç°é¢˜',
          text:'Brian Kernighanç®—æ³•è®¡ç®—popcountçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Ÿ',
          options:[
            'æ¯æ¬¡ç”¨ <code>x &= x-1</code> æ¸…é™¤æœ€ä½ä½çš„1ï¼Œå¾ªç¯è®¡æ•°ç›´åˆ°xä¸º0',
            'ç”¨æŸ¥è¡¨æ³•',
            'é€ä½æ£€æŸ¥æ¯ä¸€ä½',
            'ç”¨é™¤æ³•åˆ†ç¦»å„ä½'
          ],
          answer:0,
          explanation:'<code>while(x){count++;x&=x-1;}</code>ã€‚æ¯æ¬¡è¿­ä»£æ¶ˆé™¤ä¸€ä¸ª1ï¼Œå¾ªç¯æ¬¡æ•°ç­‰äº1çš„ä¸ªæ•°ã€‚æ—¶é—´å¤æ‚åº¦O(popcount(x))ï¼Œå¯¹ç¨€ç–ä½ï¼ˆå°‘é‡1ï¼‰æ¯”O(32)çš„é€ä½æ³•æ›´å¿«ã€‚'
        },
        {
          type:'å®ç°é¢˜',
          text:'å¹¶è¡Œä½è®¡æ•°çš„"åˆ†æ²»"æ–¹æ³•ç¬¬ä¸€æ­¥æ˜¯å°†ç›¸é‚»ä¸¤ä½çš„popcountå­˜å…¥åŸä½ï¼Œå¦‚ä½•å®ç°ï¼Ÿ',
          options:[
            '<code>x = (x & 0x55555555) + ((x>>1) & 0x55555555)</code>',
            '<code>x = x & 0x55555555</code>',
            '<code>x = x ^ (x>>1)</code>',
            '<code>x = x | 0x55555555</code>'
          ],
          answer:0,
          explanation:'<code>0x55555555 = 01010101...01</code>ã€‚å…ˆæå–å¥‡æ•°ä½ï¼Œå†æå–å¶æ•°ä½å³ç§»1ï¼Œä¸¤è€…ç›¸åŠ å°†æ¯å¯¹ç›¸é‚»ä½çš„1çš„ä¸ªæ•°(0/1/2)å­˜å…¥åŸæ¥çš„2ä½ç©ºé—´ã€‚åç»­æ­¥éª¤ç±»ä¼¼ï¼Œæ¯æ¬¡åˆå¹¶ç›¸é‚»åˆ†ç»„ï¼Œç›´åˆ°32ä½å…¨éƒ¨æ±‚å’Œã€‚'
        },
        {
          type:'ç¡¬ä»¶é¢˜',
          text:'ç°ä»£CPUä¸­è®¡ç®—popcountæœ€å¿«çš„æ–¹å¼æ˜¯ï¼Ÿ',
          options:[
            'ä½¿ç”¨ <code>POPCNT</code> ç¡¬ä»¶æŒ‡ä»¤ï¼ˆSSE4.2ï¼‰ï¼Œå•æ—¶é’Ÿå‘¨æœŸå®Œæˆ',
            'æŸ¥è¡¨æ³•(lookup table)',
            'Brian Kernighanå¾ªç¯',
            'å¹¶è¡Œåˆ†æ²»æ³•'
          ],
          answer:0,
          explanation:'Intel SSE4.2å¼•å…¥ <code>POPCNT</code> æŒ‡ä»¤ï¼Œ1ä¸ªæ—¶é’Ÿå‘¨æœŸå®Œæˆ64ä½popcountã€‚Cä¸­ç”¨ <code>__builtin_popcountll(x)</code>(GCC)æˆ– <code>_mm_popcnt_u64(x)</code>(MSVC)è°ƒç”¨ã€‚æ¯”æœ€å¿«è½¯ä»¶å®ç°å¿«3-5å€ã€‚'
        }
      ]
    },

    // â”€â”€ Level 7 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    {
      id:'w6l7', name:'å‰å¯¼é›¶/å°¾éƒ¨é›¶è®¡æ•°', formula:'CLZ / CTZ / BSR / BSF',
      stars:'â­â­', tag:'ä½æ‰«æ',
      questions:[
        {
          type:'æ¦‚å¿µé¢˜',
          text:'å‰å¯¼é›¶è®¡æ•°(CLZ, Count Leading Zeros)çš„å«ä¹‰æ˜¯ï¼Ÿ',
          options:[
            'ä»æœ€é«˜ä½å¼€å§‹è¿ç»­0çš„ä¸ªæ•°ï¼Œç­‰ä»·äº <code>31 - floor(log2(x))</code>',
            'ä»æœ€ä½ä½å¼€å§‹è¿ç»­0çš„ä¸ªæ•°',
            'æ‰€æœ‰0çš„æ€»æ•°',
            'æœ€é«˜ä½1çš„ä½ç½®'
          ],
          answer:0,
          explanation:'CLZ(x)ç»Ÿè®¡æœ€é«˜ä½åˆ°ç¬¬ä¸€ä¸ª1ä¹‹å‰çš„0çš„æ•°é‡ã€‚ä¾‹å¦‚ <code>CLZ(0b00000100) = 29</code>ï¼ˆ32ä½ä¸­ï¼‰ã€‚é‡è¦åº”ç”¨ï¼šè®¡ç®— <code>floor(log2(x)) = 31 - CLZ(x)</code>ï¼Œç”¨äºè§„æ ¼åŒ–æµ®ç‚¹æ•°ã€‚'
        },
        {
          type:'å…³è”é¢˜',
          text:'å°¾éƒ¨é›¶è®¡æ•°(CTZ, Count Trailing Zeros)å’Œå“ªä¸ªä½æ“ä½œç›´æ¥ç›¸å…³ï¼Ÿ',
          options:[
            '<code>CTZ(x) = log2(x & -x)</code>ï¼Œå³æœ€ä½ä½1çš„ä½ç½®',
            'ä¸CLZäº’è¡¥',
            'ç­‰äºpopcount(~x)',
            'ç­‰äº32-CLZ(x)'
          ],
          answer:0,
          explanation:'<code>x & (-x)</code> æå–æœ€ä½ä½çš„1ï¼ˆLSBï¼‰ï¼Œè¯¥1çš„ä½ç½®å°±æ˜¯å°¾éƒ¨0çš„ä¸ªæ•°ã€‚ä¾‹å¦‚ <code>x=0b10110100</code>ï¼Œ<code>x&(-x)=0b00000100=4=2Â²</code>ï¼ŒCTZ=2ã€‚'
        },
        {
          type:'ç¡¬ä»¶é¢˜',
          text:'x86æä¾›å“ªäº›æŒ‡ä»¤ç”¨äºä½æ‰«æï¼Ÿ',
          options:[
            'BSF(Bit Scan Forward=CTZ)ã€BSR(Bit Scan Reverse=31-CLZ)ã€LZCNT(CLZ)ã€TZCNT(CTZ)',
            'åªæœ‰BSWAP',
            'POPCNTå’ŒBSWAP',
            'SARå’ŒSHR'
          ],
          answer:0,
          explanation:'<code>BSF</code>æ‰¾æœ€ä½ä½1(ç­‰ä»·CTZ)ï¼Œ<code>BSR</code>æ‰¾æœ€é«˜ä½1ã€‚<code>LZCNT/TZCNT</code>æ˜¯BMI1æ–°å¢çš„æ›´è§„èŒƒç‰ˆæœ¬ï¼ˆBSF/BSRå¯¹x=0æœ‰æœªå®šä¹‰è¡Œä¸ºï¼ŒTZCNT/LZCNTè¿”å›æ“ä½œæ•°ä½å®½ï¼‰ã€‚GCCå†…å»ºï¼š<code>__builtin_ctz</code>/<code>__builtin_clz</code>ã€‚'
        },
        {
          type:'åº”ç”¨é¢˜',
          text:'<code>floor(log2(x))</code> ç”¨ä½æ“ä½œå¦‚ä½•é«˜æ•ˆè®¡ç®—ï¼Ÿ',
          options:[
            '31 - __builtin_clz(x)ï¼ˆ32ä½ï¼‰ï¼Œå³ç”¨CLZç»“æœæ¨å¯¼å¯¹æ•°',
            'x >> 1 å¾ªç¯è®¡æ•°',
            'log(x) / log(2)',
            'popcount(x) - 1'
          ],
          answer:0,
          explanation:'CLZå‘Šè¯‰æˆ‘ä»¬æœ€é«˜ä½1åœ¨å“ªé‡Œï¼Œå³ <code>floor(log2(x)) = 31 - CLZ(x)</code>ï¼ˆ32ä½æ— ç¬¦å·ï¼‰ã€‚è¿™æ¯”æµ®ç‚¹ <code>log2()</code> å¿«10-100å€ï¼Œç”¨äºå“ˆå¸Œæ¡¶å¤§å°è®¡ç®—ã€å†…å­˜åˆ†é…å™¨ã€Fibonacciç¼–ç ç­‰ã€‚'
        }
      ]
    },

    // â”€â”€ Level 8 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    {
      id:'w6l8', name:'ä½åŸŸæ‰“åŒ…ä¸æå–', formula:'(x >> pos) & mask',
      stars:'â­â­', tag:'åè®®è§£æ/åµŒå…¥å¼',
      questions:[
        {
          type:'æ¦‚å¿µé¢˜',
          text:'ä»æ•´æ•°xä¸­æå–ä»ç¬¬ <code>pos</code> ä½å¼€å§‹ã€é•¿åº¦ä¸º <code>len</code> ä½çš„å­—æ®µï¼Œè¡¨è¾¾å¼æ˜¯ï¼Ÿ',
          options:[
            '<code>(x >> pos) & ((1 << len) - 1)</code>',
            '<code>(x & pos) >> len</code>',
            '<code>x >> (pos + len)</code>',
            '<code>(x << pos) & len</code>'
          ],
          answer:0,
          explanation:'ä¸¤æ­¥ï¼šâ‘ å³ç§» <code>pos</code> ä½å°†ç›®æ ‡å­—æ®µå¯¹é½åˆ°æœ€ä½ä½ï¼›â‘¡ä¸æ©ç  <code>(1<<len)-1</code>ï¼ˆä½lenä½å…¨1ï¼‰åšANDï¼Œæå–å‡ºç›®æ ‡lenä½ã€‚ä¾‹å¦‚æå–ç¬¬4-6ä½(3ä½)ï¼š<code>(x>>4) & 0x7</code>ã€‚'
        },
        {
          type:'æ¦‚å¿µé¢˜',
          text:'å°†å€¼ <code>v</code> å†™å…¥xçš„ç¬¬ <code>pos</code> ä½èµ·ã€é•¿åº¦ <code>len</code> ä½çš„å­—æ®µï¼Œæ­£ç¡®æ“ä½œæ˜¯ï¼Ÿ',
          options:[
            'å…ˆæ¸…é™¤ç›®æ ‡å­—æ®µï¼š<code>x &= ~(((1<<len)-1)<<pos)</code>ï¼Œå†å†™å…¥ï¼š<code>x |= (v & ((1<<len)-1)) << pos</code>',
            '<code>x |= v << pos</code>',
            '<code>x = v << pos</code>',
            '<code>x ^= v << pos</code>'
          ],
          answer:0,
          explanation:'å¿…é¡»å…ˆæ¸…é™¤ç›®æ ‡å­—æ®µå†å†™å…¥ï¼Œå¦åˆ™åŸæœ‰ä½ä¼šä¸æ–°å€¼ORäº§ç”Ÿé”™è¯¯ç»“æœã€‚æ¸…é™¤ç”¨AND+NOTæ©ç ï¼Œå†™å…¥ç”¨ORã€‚è¿™æ˜¯åµŒå…¥å¼/é©±åŠ¨å¼€å‘ä¸­æœ€å¸¸è§çš„å¯„å­˜å™¨ä½åŸŸæ“ä½œæ¨¡å¼ã€‚'
        },
        {
          type:'åº”ç”¨é¢˜',
          text:'è§£æä»¥å¤ªç½‘å¸§å¤´æ—¶éœ€è¦æå–12ä½VLAN IDï¼ˆ802.1Qæ ‡ç­¾ç¬¬0-11ä½ï¼‰ï¼Œè¡¨è¾¾å¼æ˜¯ï¼Ÿ',
          options:[
            '<code>tag & 0x0FFF</code>ï¼ˆä½12ä½æ©ç ï¼‰',
            '<code>tag >> 12</code>',
            '<code>tag & 0xFFFF</code>',
            '<code>tag >> 4 & 0xFF</code>'
          ],
          answer:0,
          explanation:'802.1Qæ ‡ç­¾ä¸­VLAN IDå ä½12ä½ï¼ŒPCPå é«˜3ä½ï¼ŒDEIå ç¬¬12ä½ã€‚æå–VLAN IDï¼š<code>vlan_id = tag & 0x0FFF</code>ï¼ˆæ©ç 12ä¸ª1ï¼‰ã€‚ç½‘ç»œåè®®è§£æå¤§é‡ä¾èµ–ä½åŸŸæå–ã€‚'
        },
        {
          type:'å·¥å…·é¢˜',
          text:'Cè¯­è¨€çš„ä½åŸŸç»“æ„ä½“ <code>struct { uint32_t a:4; uint32_t b:12; }</code> æœ‰ä»€ä¹ˆæ½œåœ¨é—®é¢˜ï¼Ÿ',
          options:[
            'ä½åŸŸå¸ƒå±€æ˜¯å®ç°å®šä¹‰çš„(implementation-defined)ï¼Œä¸åŒç¼–è¯‘å™¨/å¹³å°ç»“æœå¯èƒ½ä¸åŒï¼Œä¸å¯ç§»æ¤',
            'å®Œå…¨è·¨å¹³å°å¯ç§»æ¤',
            'åªèƒ½ç”¨äº8ä½å­—æ®µ',
            'æ— æ³•å¤„ç†å¤§ç«¯ç³»ç»Ÿ'
          ],
          answer:0,
          explanation:'Cæ ‡å‡†è§„å®šä½åŸŸçš„ä½é¡ºåºã€è·¨å­—èŠ‚å¤„ç†æ–¹å¼ç­‰æ˜¯å®ç°å®šä¹‰ã€‚GCCå’ŒMSVCåœ¨åŒä¸€å¹³å°ä¸Šå¯èƒ½ä¸åŒã€‚è·¨å¹³å°ä»£ç åº”ä½¿ç”¨æ‰‹åŠ¨ä½æ“ä½œ(<<, >>, &)è€Œéä½åŸŸç»“æ„ä½“ã€‚Linuxå†…æ ¸å‡ ä¹ä¸ç”¨ä½åŸŸç»“æ„ä½“æ­£å› å¦‚æ­¤ã€‚'
        }
      ]
    }

  ]
},
{  
    id:'w7',icon:'ğŸ“',title:'å¸ƒå°”åˆ†è§£å®šç†',subtitle:'5ä¸ªç†è®ºåŸºç¡€',accent:'#06b6d4',accentLight:'#22d3ee',  
    levels:[  
      {id:'w7l1',name:'Shannonå±•å¼€',formula:'f = zÌ„Â·fâ‚€ + zÂ·fâ‚',stars:'â­â­',tag:'ç†è®ºåŸºç¡€',questions:[  
        {type:'ç†è®ºé¢˜',text:'Shannonå±•å¼€ <code>f = zÌ„Â·fâ‚€ + zÂ·fâ‚</code> ä¸­å„é¡¹çš„å«ä¹‰ï¼Ÿ',  
         options:['zæ˜¯åˆ†è§£å˜é‡ï¼Œfâ‚€=f|z=0ï¼Œfâ‚=f|z=1ï¼ŒæŒ‰zçš„å€¼é€‰æ‹©å­å‡½æ•°','fâ‚€æ˜¯å¸¸æ•°ï¼Œfâ‚æ˜¯å˜é‡','è¿™æ˜¯Reed-Mullerå±•å¼€çš„åˆ«å','åªé€‚ç”¨äºåŠ æ³•'],  
         answer:0,explanation:'Shannonä½™å› å­å±•å¼€: ä»»ä½•å¸ƒå°”å‡½æ•°éƒ½å¯ä»¥æŒ‰ä¸€ä¸ªå˜é‡zå±•å¼€ã€‚å½“z=0é€‰fâ‚€ï¼Œå½“z=1é€‰fâ‚ã€‚è¿™æ˜¯BDD(äºŒå‰å†³ç­–å›¾)çš„ç†è®ºåŸºç¡€ã€‚'},  
        {type:'æ¯”è¾ƒé¢˜',text:'Shannonå±•å¼€ä¸Reed-Mullerå±•å¼€ <code>f = fâ‚€ âŠ• zÂ·(fâ‚€âŠ•fâ‚)</code> çš„ä¸»è¦åŒºåˆ«ï¼Ÿ',  
         options:['Shannonç”¨OR+AND+NOTï¼›Reed-Mulleråªç”¨XOR+ANDï¼Œä¸éœ€è¦NOT','å®Œå…¨ç›¸åŒ','Reed-Mulleræ›´å¤æ‚','Shannonä¸éœ€è¦åˆ†è§£'],  
         answer:0,explanation:'Shannonéœ€è¦NOT(å–zÌ„)å’ŒORã€‚Reed-Mulleråªç”¨{AND, XOR}(GF(2)ä¸Šçš„å¤šé¡¹å¼)ï¼Œæ›´é€‚åˆæŸäº›ç¡¬ä»¶å®ç°å’Œå¯†ç å­¦åˆ†æã€‚'}  
      ]},  
      {id:'w7l2',name:'ANFä»£æ•°æ­£è§„å½¢',formula:'æ¯ä¸ªå˜é‡æœ€å¤šå‡ºç°ä¸€æ¬¡',stars:'â­â­',tag:'ä»£æ•°è¡¨ç¤º',questions:[  
        {type:'æ¦‚å¿µé¢˜',text:'å¸ƒå°”å‡½æ•°çš„ä»£æ•°æ­£è§„å½¢(ANF)æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ',  
         options:['GF(2)ä¸Šçš„å¤šé¡¹å¼ï¼šANDå¯¹åº”ä¹˜æ³•ï¼ŒXORå¯¹åº”åŠ æ³•ï¼Œæ¯ä¸ªå•é¡¹å¼ä¸­æ¯ä¸ªå˜é‡æœ€å¤šå‡ºç°ä¸€æ¬¡',  
                  'ä¸çœŸå€¼è¡¨ç­‰ä»·ä½†æ›´ç®€æ´','åªå«ANDæ“ä½œ','åªå«XORæ“ä½œ'],  
         answer:0,explanation:'ANF(Algebraic Normal Form)ä¹Ÿå«Zhegalkinå¤šé¡¹å¼ã€‚ä»»ä½•å¸ƒå°”å‡½æ•°éƒ½æœ‰å”¯ä¸€çš„ANFã€‚ä¾‹å¦‚ <code>f(x,y)=xâŠ•yâŠ•xy</code> æ˜¯XORçš„ANFã€‚'},  
        {type:'åº”ç”¨é¢˜',text:'ANFåœ¨å¯†ç å­¦ä¸­æœ‰ä»€ä¹ˆé‡è¦åº”ç”¨ï¼Ÿ',  
         options:['åˆ†æSç›’çš„ä»£æ•°æ¬¡æ•°(algebraic degree)ï¼Œè¯„ä¼°å¯†ç ç®—æ³•æŠ—ä»£æ•°æ”»å‡»èƒ½åŠ›',  
                  'åŠ é€ŸåŠ å¯†é€Ÿåº¦','ç”Ÿæˆå¯†é’¥','æ›¿ä»£å“ˆå¸Œå‡½æ•°'],  
         answer:0,explanation:'Sç›’çš„ä»£æ•°æ¬¡æ•°æ˜¯å…¶ANFä¸­æœ€é«˜æ¬¡å•é¡¹å¼çš„æ¬¡æ•°ã€‚æ¬¡æ•°è¶Šé«˜ï¼Œä»£æ•°æ”»å‡»è¶Šéš¾ã€‚AESçš„Sç›’æ¬¡æ•°ä¸º7(æœ€å¤§å€¼255ä½æ—¶)ï¼ŒæŠ—æ€§å¼ºã€‚'}  
      ]},  
      {id:'w7l3',name:'SHA-256 MAJå‡½æ•°',formula:'MAJ(x,y,z)=(x&y)|(y&z)|(z&x)',stars:'â­â­',tag:'å¯†ç å­¦åŸè¯­',questions:[  
        {type:'å¯†ç é¢˜',text:'SHA-256ä¸­ <code>MAJ(x,y,z)</code> çš„é€»è¾‘å«ä¹‰ï¼Ÿ',  
         options:['ä¸‰è€…å¤šæ•°è¡¨å†³: æ¯ä½å–x,y,zä¸­å‡ºç°æ›´å¤šçš„å€¼(2ä¸ªæˆ–3ä¸ªä¸º1åˆ™ç»“æœä¸º1)',  
                  'ä¸‰è€…çš„AND','ä¸‰è€…çš„OR','ä¸‰è€…çš„XOR'],  
         answer:0,explanation:'MAJ=Majority(å¤šæ•°è¡¨å†³)ã€‚é€ä½çœ‹: 3ä¸ªè¾“å…¥ä¸­2ä¸ªæˆ–3ä¸ªä¸º1æ—¶è¾“å‡º1ï¼Œå¦åˆ™è¾“å‡º0ã€‚å®ƒæ˜¯SHA-256å‹ç¼©å‡½æ•°çš„æ ¸å¿ƒéçº¿æ€§ç»„ä»¶ä¹‹ä¸€ã€‚'},  
        {type:'ä¼˜åŒ–é¢˜',text:'<code>MAJ(x,y,z)</code> çš„3-AND-2-ORå®ç°å¯ä»¥ä¼˜åŒ–ä¸ºï¼Ÿ',  
         options:['(x&y)^(x&z)^(y&z) â€” ç”¨XORæ›¿ä»£ORå‡å°‘ä¾èµ–é“¾','æ— æ³•ä¼˜åŒ–','(x|y|z)&(x&y&z)','x^y^z'],  
         answer:0,explanation:'ç”±äºä¸‰ä¸ªANDé¡¹ä¸ä¼šåŒæ—¶ä¸º1(è‡³å¤šä¸¤ä¸ªä¸º1)ï¼ŒXORå’ŒORåœ¨è¿™é‡Œç­‰ä»·ã€‚XORç‰ˆæœ¬åœ¨æŸäº›æ¶æ„ä¸Šæ›´å¿«ï¼Œä¸”å¯ä¸CHå‡½æ•°å…±äº«ä¸­é—´è®¡ç®—ã€‚'},  
        {type:'å¯¹æ¯”é¢˜',text:'SHA-256è¿˜æœ‰ä¸€ä¸ªå‡½æ•°CH(x,y,z)ï¼Œå®ƒçš„å«ä¹‰æ˜¯ï¼Ÿ',  
         options:['xä¸º1æ—¶é€‰yï¼Œxä¸º0æ—¶é€‰z â€” å³ (x&y)|(~x&z)','ä¸MAJç›¸åŒ','ä¸‰è€…å¼‚æˆ–','ä¸‰è€…ä¸'],  
         answer:0,explanation:'CH=Choose(é€‰æ‹©å™¨)ã€‚xçš„æ¯ä¸€ä½å†³å®šæ˜¯ä»yè¿˜æ˜¯zå–å€¼ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé€ä½MUXã€‚ä¸MAJå…±åŒæ„æˆSHA-256å‹ç¼©å‡½æ•°çš„éçº¿æ€§æ ¸å¿ƒã€‚'}  
      ]},  
      {id:'w7l4',name:'çœŸå€¼è¡¨ä¸å‡½æ•°è®¡æ•°',formula:'2^(2^n) ç§å¸ƒå°”å‡½æ•°',stars:'â­',tag:'æšä¸¾åˆ†æ',questions:[  
        {type:'è®¡ç®—é¢˜',text:'nä¸ªå˜é‡çš„å¸ƒå°”å‡½æ•°æœ‰å¤šå°‘ç§ä¸åŒçš„å‡½æ•°ï¼Ÿ',  
         options:['2^(2^n) ç§','2^n ç§','n! ç§','2n ç§'],  
         answer:0,explanation:'nä¸ªå˜é‡æœ‰ <code>2â¿</code> ç§è¾“å…¥ç»„åˆï¼Œæ¯ç§ç»„åˆè¾“å‡º0æˆ–1ï¼Œæ‰€ä»¥å…±æœ‰ <code>2^(2â¿)</code> ç§ä¸åŒå‡½æ•°ã€‚2å˜é‡æœ‰16ç§ï¼Œ3å˜é‡æœ‰256ç§ï¼'},  
        {type:'ç†è§£é¢˜',text:'ä¸ºä»€ä¹ˆè¯´"ä»»ä½•å¸ƒå°”å‡½æ•°éƒ½å¯ä»¥ç”¨AND/OR/NOTå®ç°"ï¼Ÿ',  
         options:['{AND,OR,NOT}æ˜¯åŠŸèƒ½å®Œå¤‡é›†(Functionally Complete)ï¼Œå¯è¡¨è¾¾æ‰€æœ‰çœŸå€¼è¡¨',  
                  'åªæœ‰çº¿æ€§å‡½æ•°å¯ä»¥','éœ€è¦é¢å¤–æ“ä½œç¬¦','è¿™ä¸ªè¯´æ³•æ˜¯é”™è¯¯çš„'],  
         answer:0,explanation:'åŠŸèƒ½å®Œå¤‡é›†æ„å‘³ç€å¯ä»¥è¡¨è¾¾ä»»æ„çœŸå€¼è¡¨å¯¹åº”çš„å‡½æ•°ã€‚{AND,OR,NOT}ã€{NAND}ã€{NOR}ã€{AND,XOR,1}(GF2)éƒ½æ˜¯å®Œå¤‡é›†ã€‚'}  
      ]},  
      {id:'w7l5',name:'3næŒ‡ä»¤å®ç°å¤æ‚åº¦',formula:'1å˜é‡1æŒ‡ä»¤, nå˜é‡~3næŒ‡ä»¤',stars:'â­â­',tag:'æŒ‡ä»¤æˆæœ¬',questions:[  
        {type:'åˆ†æé¢˜',text:'ç”¨ä½è¿ç®—å®ç°nå…ƒå¸ƒå°”å‡½æ•°å¤§çº¦éœ€è¦å¤šå°‘æ¡æŒ‡ä»¤ï¼Ÿ',  
         options:['çº¦3næ¡ï¼ˆAND,XOR,åŠè¾…åŠ©æ“ä½œå„çº¦næ¬¡ï¼‰','næ¡','nÂ²æ¡','2â¿æ¡'],  
         answer:0,explanation:'æ¯å¼•å…¥ä¸€ä¸ªæ–°å˜é‡ï¼Œå¤§çº¦éœ€è¦ä¸€æ¬¡AND(ä¹˜ä»¥å˜é‡)ã€ä¸€æ¬¡XOR(åŠ åˆ°ç»“æœ)å’Œå¯èƒ½çš„è¾…åŠ©æ“ä½œã€‚çº¿æ€§å¢é•¿çº¦3nï¼Œæ¯”çœŸå€¼è¡¨æŸ¥è¡¨çš„2â¿é«˜æ•ˆå¾—å¤šã€‚'},  
        {type:'å®è·µé¢˜',text:'è¶…çº§ä¼˜åŒ–å™¨(Superoptimizer)åœ¨è¿™é‡Œæ‰®æ¼”ä»€ä¹ˆè§’è‰²ï¼Ÿ',  
         options:['ç©·ä¸¾éªŒè¯æŸå¸ƒå°”å‡½æ•°çš„æœ€çŸ­æŒ‡ä»¤åºåˆ—ï¼Œç¡®è®¤3næ˜¯å¦çœŸçš„æœ€ä¼˜',  
                  'è‡ªåŠ¨ç¼–å†™ç¨‹åº','æ›¿ä»£ç¼–è¯‘å™¨','ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹'],  
         answer:0,explanation:'GNU Superoptimizeræš´åŠ›æšä¸¾æ‰€æœ‰çŸ­æŒ‡ä»¤åºåˆ—ï¼ŒéªŒè¯å“ªä¸ªèƒ½æ­£ç¡®å®ç°ç›®æ ‡åŠŸèƒ½ã€‚å®ƒè‡ªåŠ¨"å‘ç°"äº†å¾ˆå¤šäººç±»å·²çŸ¥çš„ä½æ“ä½œæŠ€å·§ï¼Œæœ‰æ—¶ç”šè‡³æ‰¾åˆ°æ›´çŸ­çš„åºåˆ—ã€‚'}  
      ]}  
    ]  
  },  
  {  
    id:'w8',icon:'â°',title:'å†å²æ¼”å˜',subtitle:'6ä¸ªé‡Œç¨‹ç¢‘æ—¶åˆ»',accent:'#64748b',accentLight:'#94a3b8',  
    levels:[  
      {id:'w8l1',name:'1961 - Strachey CACM',formula:'æœ€æ—©æ­£å¼å‘è¡¨',stars:'â­',tag:'ç†è®ºæº¯æº',questions:[  
        {type:'å†å²é¢˜',text:'Christopher Strachey 1961å¹´çš„CACMè®ºæ–‡æœ‰ä»€ä¹ˆé‡Œç¨‹ç¢‘æ„ä¹‰ï¼Ÿ',  
         options:['é¦–æ¬¡åœ¨å­¦æœ¯æœŸåˆŠä¸Šç³»ç»Ÿè®¨è®ºä½æ“ä½œæŠ€å·§ï¼Œä½¿å…¶ä»"é»‘å®¢ç§˜ç¬ˆ"èµ°å‘å­¦æœ¯æ®¿å ‚',  
                  'å‘æ˜äº†è®¡ç®—æœº','è®¾è®¡äº†ç¬¬ä¸€ä¸ªCPU','åˆ›å»ºäº†Cè¯­è¨€'],  
         answer:0,explanation:'åœ¨æ­¤ä¹‹å‰ä½æ“ä½œæŠ€å·§åªåœ¨ç¨‹åºå‘˜é—´å£å£ç›¸ä¼ ã€‚Stracheyå°†å®ƒä»¬æ­£å¼åŒ–å‘è¡¨åœ¨ACMé€šè®¯ä¸Šï¼Œä¸ºåç»­ç ”ç©¶å¥ å®šäº†å­¦æœ¯åŸºç¡€ï¼Œä¹Ÿä½¿è¿™äº›æŠ€å·§è·å¾—äº†æ›´å¹¿æ³›çš„ä¼ æ’­ã€‚'},  
        {type:'æ–‡åŒ–é¢˜',text:'ä¸ºä»€ä¹ˆæ—©æœŸè®¡ç®—æœºç¨‹åºå‘˜å¯¹ä½æ“ä½œå¦‚æ­¤ç—´è¿·ï¼Ÿ',  
         options:['æ—©æœŸè®¡ç®—æœºå†…å­˜æå…¶ç¨€ç¼ºï¼Œæ¯ä¸ªå­—èŠ‚éƒ½å®è´µï¼›CPUä¹Ÿæ…¢ï¼ŒèŠ‚çœæŒ‡ä»¤æ„å‘³ç€èŠ‚çœæ˜‚è´µçš„è®¡ç®—æ—¶é—´',  
                  'çº¯ç²¹æ˜¯çˆ±å¥½','ä½æ“ä½œæ›´å®¹æ˜“è°ƒè¯•','ç¼–è¯‘å™¨è¦æ±‚ä½¿ç”¨ä½æ“ä½œ'],  
         answer:0,explanation:'1960å¹´ä»£çš„è®¡ç®—æœºå†…å­˜ä»¥KBè®¡ï¼Œæ—¶é—´ä»¥åˆ†é’Ÿè®¡è´¹ã€‚æ¯çœä¸€æ¡æŒ‡ä»¤ã€æ¯çœä¸€ä¸ªå­—èŠ‚éƒ½æœ‰å®é™…çš„å•†ä¸šä»·å€¼ã€‚è¿™ç§æç«¯çº¦æŸå‚¬ç”Ÿäº†æ— æ•°ç²¾å¦™çš„ä½æ“ä½œæŠ€å·§ã€‚'}  
      ]},  
      {id:'w8l2',name:'1972 - Gosper HAKMEM',formula:'MITä½æ“ä½œåœ£ç»',stars:'â­â­',tag:'ç»å…¸æ±‡ç¼–',questions:[  
        {type:'å†å²é¢˜',text:'HAKMEM(Memo 239)æ˜¯ä»€ä¹ˆï¼Ÿ',  
         options:['MIT AI Labçš„é»‘å®¢å¤‡å¿˜å½•ï¼Œæ”¶å½•äº†å¤§é‡ä½æ“ä½œæŠ€å·§åŒ…æ‹¬Gosper\'s Hack',  
                  'ä¸€æœ¬æ•™ç§‘ä¹¦','ä¸€ä¸ªç¼–ç¨‹è¯­è¨€','ä¸€ä¸ªæ“ä½œç³»ç»Ÿ'],  
         answer:0,explanation:'HAKMEMç”±Bill Gosperç­‰MITé»‘å®¢ç¼–çº‚äº1972å¹´ï¼Œæ”¶å½•äº†æ•°å­¦ã€ä½æ“ä½œã€å›¾å½¢ç­‰å¥‡æŠ€æ·«å·§ã€‚Gosper\'s Hackå°±å‡ºè‡ªå…¶ä¸­ï¼Œå½±å“äº†æ•´æ•´ä¸€ä»£ç¨‹åºå‘˜ã€‚'},  
        {type:'æŠ€æœ¯é¢˜',text:'HAKMEMä¸­è¿˜æœ‰å“ªäº›è‘—åçš„ä½æ“ä½œæŠ€å·§ï¼Ÿ',  
         options:['popcount(ä½è®¡æ•°)ã€å‰å¯¼é›¶è®¡æ•°ã€å¾ªç¯ç§»ä½ã€æ£‹ç›˜é—®é¢˜ç­‰æ•°åç§æŠ€å·§',  
                  'åªæœ‰Gosper\'s Hackä¸€ä¸ª','æµ®ç‚¹è¿ç®—æŠ€å·§','å­—ç¬¦ä¸²å¤„ç†æŠ€å·§'],  
         answer:0,explanation:'HAKMEMæ”¶å½•äº†170å¤šä¸ªæ¡ç›®ï¼Œæ¶µç›–ä½è®¡æ•°ã€æ¸¸ç¨‹ç¼–ç ã€å›½é™…è±¡æ£‹èµ°æ³•ç”Ÿæˆç­‰ã€‚å…¶ä¸­å¾ˆå¤šæŠ€å·§åæ¥è¢«çƒ§è¿›äº†ç°ä»£CPUçš„ä¸“ç”¨æŒ‡ä»¤ä¸­ã€‚'}  
      ]},  
      {id:'w8l3',name:'1986 - Dietzæ— æº¢å‡ºå¹³å‡',formula:'å®‰å…¨ç®—æœ¯å…ˆé©±',stars:'â­â­',tag:'å®‰å…¨è¡¥ä¸',questions:[  
        {type:'è´¡çŒ®é¢˜',text:'Henry G. Dietzçš„ä¸»è¦è´¡çŒ®æ˜¯ä»€ä¹ˆï¼Ÿ',  
         options:['å‘ç°æ— æº¢å‡ºå¹³å‡å…¬å¼ï¼Œæ¨åŠ¨äº†SIMDå®‰å…¨ç®—æœ¯ç ”ç©¶ï¼Œå½±å“äº†åæ¥çš„ç¡¬ä»¶æŒ‡ä»¤è®¾è®¡',  
                  'å‘æ˜äº†Cè¯­è¨€','è®¾è®¡äº†x86','åˆ›å»ºäº†Linux'],  
         answer:0,explanation:'Dietzåœ¨aggregate.orgå‘è¡¨äº†ä¸€ç³»åˆ—æ— æº¢å‡ºç®—æœ¯æŠ€å·§ï¼Œå…¶ä¸­ <code>(x&y)+((x^y)>>1)</code> æˆä¸ºç»å…¸ã€‚è¿™å¯å‘äº†åæ¥SIMDæŒ‡ä»¤é›†ä¸­å®‰å…¨ç®—æœ¯æŒ‡ä»¤(å¦‚SSEçš„pavg)çš„è®¾è®¡ã€‚'},  
        {type:'å»¶ä¼¸é¢˜',text:'Dietzå…¬å¼å¯ä»¥æ¨å¹¿åˆ°ä»€ä¹ˆåœºæ™¯ï¼Ÿ',  
         options:['ä»»ä½•éœ€è¦æ— æº¢å‡ºå‡å€¼çš„åœºæ™¯: SIMD packedæ“ä½œã€äºŒåˆ†æœç´¢ä¸­å€¼ã€å›¾åƒæ··åˆç­‰',  
                  'åªèƒ½ç”¨äºæ•´æ•°åŠ æ³•','åªåœ¨32ä½ç³»ç»Ÿæœ‰æ•ˆ','åªèƒ½ç”¨äºæ­£æ•°'],  
         answer:0,explanation:'åªè¦æ˜¯"ä¸¤ä¸ªå€¼å–å‡å€¼"çš„åœºæ™¯éƒ½å¯ç”¨: å›¾åƒalphaæ··åˆã€æ’å€¼è®¡ç®—ã€ä¸­ä½æ•°æŸ¥æ‰¾ç­‰ã€‚å…¬å¼å¯¹æœ‰ç¬¦å·å’Œæ— ç¬¦å·æ•´æ•°éƒ½æœ‰å¯¹åº”ç‰ˆæœ¬ã€‚'}  
      ]},  
      {id:'w8l4',name:'2006 - Bloch JDK Bug',formula:'äºŒåˆ†æœç´¢æº¢å‡ºç»å…¸æ¡ˆä¾‹',stars:'â­â­',tag:'ç»éªŒæ•™è®­',questions:[  
        {type:'æ¡ˆä¾‹é¢˜',text:'Joshua Blochå‘ç°çš„JDKäºŒåˆ†æœç´¢bugæ˜¯ä»€ä¹ˆï¼Ÿ',  
         options:['mid=(low+high)/2 åœ¨å¤§æ•°ç»„æ—¶low+highæ•´æ•°æº¢å‡ºå˜æˆè´Ÿæ•°ï¼Œå¯¼è‡´æ•°ç»„è¶Šç•Œå¼‚å¸¸',  
                  'æ’åºé”™è¯¯','æ­»å¾ªç¯','å†…å­˜æ³„æ¼'],  
         answer:0,explanation:'JDKçš„ <code>Arrays.binarySearch</code> ä¸­ <code>(low+high)/2</code> å½“æ•°ç»„å¾ˆå¤§æ—¶(low+highè¶…è¿‡Integer.MAX_VALUE)ä¼šå˜æˆè´Ÿæ•°ã€‚è¿™ä¸ªbugæ½œä¼äº†è¿‘10å¹´æ‰è¢«å‘ç°ï¼'},  
        {type:'æ•™è®­é¢˜',text:'Jon Bentleyçš„ã€Šç¼–ç¨‹ç ç‘ã€‹ä¸­ä¹Ÿæœ‰åŒæ ·çš„bugï¼Œè¿™è¯´æ˜äº†ä»€ä¹ˆï¼Ÿ',  
         options:['æ•´æ•°æº¢å‡ºæ˜¯æœ€å®¹æ˜“è¢«å¿½è§†çš„bugä¹‹ä¸€ï¼Œå³ä½¿æ˜¯é¡¶çº§ä¸“å®¶ä¹Ÿä¼šä¸­æ‹›ï¼›éœ€è¦ä¸“é—¨çš„å®‰å…¨å®¡æŸ¥',  
                  'äºŒåˆ†æœç´¢å¾ˆéš¾å®ç°','Javaä¸å®‰å…¨','ä¹¦ä¸­ä¾‹å­ä¸å¯ä¿¡'],  
         answer:0,explanation:'Knuthæ®è¯´æ›¾è¯´è¿‡90%çš„ç¨‹åºå‘˜æ— æ³•æ­£ç¡®å®ç°äºŒåˆ†æœç´¢ã€‚è¿™ä¸ªbugè­¦ç¤ºæˆ‘ä»¬: æ•´æ•°æº¢å‡ºåœ¨C/C++ä¸­æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œåœ¨Javaä¸­ä¼šç»™å‡ºé”™è¯¯ç»“æœã€‚Dietzå…¬å¼æ˜¯æ ¹æœ¬è§£æ³•ã€‚'},  
        {type:'ä¿®å¤é¢˜',text:'ä¿®å¤ <code>mid=(low+high)/2</code> çš„æœ€ä¼˜æ–¹æ¡ˆæ˜¯ï¼Ÿ',  
         options:['low + ((high-low)>>1) æˆ– (low&high)+((low^high)>>1) â€” ä¸¤è€…éƒ½é¿å…äº†æº¢å‡º',  
                  'æ”¹ç”¨longç±»å‹','åªå¤„ç†å°æ•°ç»„','æ·»åŠ try-catch'],  
         answer:0,explanation:'<code>low+(high-low)/2</code> é€šè¿‡å…ˆåšå‡æ³•é¿å…æº¢å‡ºã€‚Dietzå…¬å¼ <code>(low&high)+((low^high)>>1)</code> æ›´ä¼˜é›…ä¸”é€Ÿåº¦ç›¸å½“ã€‚JDKå®˜æ–¹ä¿®å¤é‡‡ç”¨äº† <code>(low+high)>>>1</code>(æ— ç¬¦å·å³ç§»)ã€‚'}  
      ]},  
      {id:'w8l5',name:'2013 - Intel BMI1/BMI2',formula:'è½¯ä»¶æŠ€å·§â†’ç¡¬ä»¶æŒ‡ä»¤',stars:'â­â­',tag:'ç¡¬ä»¶æ”¯æŒ',questions:[  
        {type:'æ¼”è¿›é¢˜',text:'Intel BMI1/BMI2æŒ‡ä»¤é›†ä½“ç°äº†ä»€ä¹ˆæ¼”è¿›è§„å¾‹ï¼Ÿ',  
         options:['é¢‘ç¹ä½¿ç”¨çš„ä½æ“ä½œè½¯ä»¶æŠ€å·§æœ€ç»ˆè¢«çƒ§è¿›CPUç¡¬ä»¶ï¼Œæˆä¸ºå•å‘¨æœŸæŒ‡ä»¤(BLSR,BLSI,PEXT,PDEPç­‰)',  
                  'ç¡¬ä»¶è¶Šæ¥è¶Šç®€å•','è½¯ä»¶ä¸å†éœ€è¦ä½æ“ä½œ','CPUä¸éœ€è¦ä¸“ç”¨æŒ‡ä»¤'],  
         answer:0,explanation:'BMI1æä¾›BLSR(<code>x&(x-1)</code>)ã€BLSI(<code>x&(-x)</code>)ç­‰ã€‚BMI2æä¾›PEXT/PDEPä½åŸŸæ“ä½œã€‚è½¯ä»¶æŠ€å·§å˜æˆäº†å•å‘¨æœŸç¡¬ä»¶æŒ‡ä»¤ï¼Œè¿™æ˜¯è®¡ç®—æœºä½“ç³»ç»“æ„æ¼”åŒ–çš„å…¸å‹è·¯å¾„ã€‚'},  
        {type:'å½±å“é¢˜',text:'PEXT/PDEPæŒ‡ä»¤å¯¹å“ªä¸ªé¢†åŸŸå½±å“æœ€å¤§ï¼Ÿ',  
         options:['å›½é™…è±¡æ£‹å¼•æ“(ä½æ£‹ç›˜bitboard)å’Œå¯†ç å­¦ä½ç½®æ¢ï¼Œæ€§èƒ½æå‡æ•°åå€',  
                  'æ–‡æœ¬å¤„ç†','ç½‘é¡µæ¸²æŸ“','æ•°æ®åº“æŸ¥è¯¢'],  
         answer:0,explanation:'PEXTæ ¹æ®æ©ç æå–æ•£è½çš„ä½å¹¶å‹ç¼©ï¼ŒPDEPåšåæ“ä½œã€‚æ£‹ç›˜å¼•æ“çš„åˆæ³•èµ°æ­¥ç”Ÿæˆä»æ•°åæ¡æŒ‡ä»¤é™åˆ°1æ¡ï¼Œå¯†ç å­¦çš„ä½ç½®æ¢ä¹Ÿå¤§å¹…åŠ é€Ÿã€‚'},  
        {type:'å»¶ä¼¸é¢˜',text:'é™¤BMIå¤–ï¼Œå“ªä¸ªæŒ‡ä»¤å¯¹popcountè®¡ç®—å½±å“æœ€å¤§ï¼Ÿ',  
         options:['POPCNTæŒ‡ä»¤(SSE4.2å¼•å…¥)ï¼Œå•å‘¨æœŸè®¡ç®—æ±‰æ˜é‡é‡ï¼Œæ›¿ä»£Brian Kernighançš„å¾ªç¯ç®—æ³•',  
                  'PEXT','LZCNT','BSWAP'],  
         answer:0,explanation:'POPCNTåœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å®Œæˆæ•´ä¸ªpopcountè®¡ç®—ï¼Œæ¯”æœ€å¿«çš„è½¯ä»¶å®ç°å¿«3-5å€ã€‚è¿™ä½¿å¾—ä¾èµ–popcountçš„ç®—æ³•(å¦‚æ£‹ç›˜å¼•æ“ã€å‹ç¼©ç®—æ³•)æ€§èƒ½å¤§å¹…æå‡ã€‚'}  
      ]},  
      {id:'w8l6',name:'C23/Rust/Javaæ¼”è¿›',formula:'è¯­è¨€çº§å®‰å…¨æ”¯æŒ',stars:'â­',tag:'ç°ä»£è¿›å±•',questions:[  
        {type:'å¯¹æ¯”é¢˜',text:'å…³äºæ•´æ•°æº¢å‡ºï¼ŒC/C++ã€Javaã€Rustæœ‰ä»€ä¹ˆå…³é”®å·®å¼‚ï¼Ÿ',  
         options:['C/C++æœ‰ç¬¦å·æº¢å‡ºæ˜¯UBï¼›Javaæœ‰>>>æ— ç¬¦å·å³ç§»ä½†æº¢å‡ºå›ç»•ï¼›Rusté»˜è®¤debug panicï¼Œæä¾›wrapping/checked/saturating API',  
                  'å®Œå…¨ç›¸åŒ','åªæœ‰è¯­æ³•ä¸åŒ','ä¸å½±å“ç»“æœ'],  
         answer:0,explanation:'Cæœ‰ç¬¦å·æ•´æ•°æº¢å‡ºæ˜¯æœªå®šä¹‰è¡Œä¸º(UB)ï¼Œç¼–è¯‘å™¨å¯åšå±é™©å‡è®¾ã€‚Javaæº¢å‡ºå›ç»•ä½†æ— UBã€‚Rustæ˜¯ç›®å‰æœ€ä¸¥è°¨çš„: debugæ¨¡å¼æº¢å‡ºpanicï¼Œreleaseå¯é€‰è¡Œä¸ºï¼Œä¸”æœ‰å››ç§æ˜ç¡®APIã€‚'},  
        {type:'å‰æ²¿é¢˜',text:'C23æ ‡å‡†æ–°å¢äº†å“ªäº›ä¸ä½æ“ä½œç›¸å…³çš„æ ‡å‡†åº“å‡½æ•°ï¼Ÿ',  
         options:['<bit.h>æä¾›stdc_bit_widthã€stdc_count_onesã€stdc_leading_zerosç­‰æ ‡å‡†åŒ–ä½æ“ä½œå‡½æ•°',  
                  'æ²¡æœ‰ä»»ä½•æ–°å¢','åªå¢åŠ äº†æ•°å­¦å‡½æ•°','åªå¢åŠ äº†å­—ç¬¦ä¸²å‡½æ•°'],  
         answer:0,explanation:'C23çš„ <code><stdbit.h></code> ç»ˆäºæ ‡å‡†åŒ–äº†popcountã€å‰å¯¼é›¶ã€å°¾éƒ¨é›¶ç­‰ä½æ“ä½œï¼Œç»“æŸäº†å„å¹³å°ä½¿ç”¨ä¸åŒå†…å»ºå‡½æ•°(__builtin_popcount vs _BitScanForward)çš„æ··ä¹±å±€é¢ã€‚'}  
      ]}  
    ]  
  },  
  {  
    id:'w9',icon:'ğŸ’­',title:'æ·±åº¦ç‚¹è¯„',subtitle:'5ä¸ªæ·±åº¦æ´å¯Ÿ',accent:'#ef4444',accentLight:'#f87171',  
    levels:[  
      {id:'w9l1',name:'åˆ†æ”¯é¢„æµ‹é™·é˜±',formula:'10-20å‘¨æœŸæƒ©ç½š',stars:'â­â­â­',tag:'æ€§èƒ½å…³é”®',questions:[  
        {type:'æ€§èƒ½é¢˜',text:'ç°ä»£CPUåˆ†æ”¯é¢„æµ‹å¤±è´¥(misprediction)çš„ä»£ä»·å¤§çº¦æ˜¯ï¼Ÿ',  
         options:['10-20ä¸ªæ—¶é’Ÿå‘¨æœŸ(éœ€å†²åˆ·æµæ°´çº¿)ï¼Œåœ¨é«˜é¢‘å¾ªç¯ä¸­å¯é€ æˆ5-10å€æ€§èƒ½å·®',  
                  '0ä¸ªå‘¨æœŸ','1-2ä¸ªå‘¨æœŸ','100+ä¸ªå‘¨æœŸ'],  
         answer:0,explanation:'æµæ°´çº¿è¶Šæ·±ï¼Œæƒ©ç½šè¶Šå¤§ã€‚ç°ä»£CPU 15-20çº§æµæ°´çº¿ï¼Œé¢„æµ‹å¤±è´¥éœ€å†²åˆ·æ•´æ¡æµæ°´çº¿é‡æ–°å¡«å……ã€‚åœ¨çƒ­å¾ªç¯ä¸­é¢‘ç¹é¢„æµ‹å¤±è´¥å¯é€ æˆä¸¥é‡æ€§èƒ½ä¸‹é™ã€‚'},  
        {type:'ç­–ç•¥é¢˜',text:'ä»€ä¹ˆæƒ…å†µä¸‹æ— åˆ†æ”¯ä»£ç æœ€æœ‰ä¼˜åŠ¿ï¼Ÿ',  
         options:['åˆ†æ”¯èµ°å‘éšæœº(ä¾èµ–æ•°æ®å†…å®¹)å¯¼è‡´é¢„æµ‹ç‡ä½æ—¶(å¦‚æ’åºä¸­çš„æ¯”è¾ƒ)ï¼›GPUçº¿ç¨‹æŸåˆ†æ­§æ—¶',  
                  'åˆ†æ”¯é«˜åº¦å¯é¢„æµ‹æ—¶','åªæ‰§è¡Œä¸€æ¬¡çš„ä»£ç ','æ‰€æœ‰æƒ…å†µéƒ½éœ€è¦'],  
         answer:0,explanation:'åˆ†æ”¯é¢„æµ‹å™¨å¯¹æ¨¡å¼åŒ–åˆ†æ”¯(å¦‚å¾ªç¯è®¡æ•°å™¨)èƒ½è¾¾åˆ°99%+é¢„æµ‹ç‡ï¼Œæ— åˆ†æ”¯ä»£ä»·å¾—ä¸å¿å¤±ã€‚ä½†æ•°æ®ä¾èµ–çš„åˆ†æ”¯(å¦‚ä¾èµ–è¾“å…¥å€¼)å¯èƒ½åªæœ‰50%ï¼Œæ­¤æ—¶æ— åˆ†æ”¯ä»£ç å¤§å¹…é¢†å…ˆã€‚'},  
        {type:'å®è·µé¢˜',text:'ä½¿ç”¨æ— åˆ†æ”¯ä½æ“ä½œæ›¿ä»£æ¡ä»¶åˆ†æ”¯æ—¶åº”æ³¨æ„ï¼Ÿ',  
         options:['å…ˆprofileç¡®è®¤åˆ†æ”¯æ˜¯ç“¶é¢ˆï¼›æ·»åŠ æ³¨é‡Šè¯´æ˜æ„å›¾ï¼›éªŒè¯ç¼–è¯‘å™¨æ˜¯å¦å·²è‡ªåŠ¨ä¼˜åŒ–(CMOV)',  
                  'æ€»æ˜¯æ— åˆ†æ”¯æ›´å¥½','ä¸éœ€è¦æ³¨é‡Š','ç¼–è¯‘å™¨ä¸ä¼šåšä»»ä½•ä¼˜åŒ–'],  
         answer:0,explanation:'ç°ä»£ç¼–è¯‘å™¨(GCC -O2)å¸¸è‡ªåŠ¨ä½¿ç”¨CMOVç­‰æ¡ä»¶ç§»åŠ¨æŒ‡ä»¤æ›¿ä»£åˆ†æ”¯ã€‚æ‰‹å†™ä½æ“ä½œåº”å…ˆç¡®è®¤ç¼–è¯‘å™¨æ²¡æœ‰è‡ªåŠ¨ä¼˜åŒ–ï¼Œå¦åˆ™åªæ˜¯å¢åŠ ä»£ç å¤æ‚åº¦ã€‚Profile before optimizeï¼'}  
      ]},  
      {id:'w9l2',name:'æ•´æ•°æº¢å‡ºå®‰å…¨',formula:'UB â†’ å®‰å…¨æ¼æ´',stars:'â­â­â­',tag:'å®‰å…¨éšæ‚£',questions:[  
        {type:'å®‰å…¨é¢˜',text:'C/C++ä¸­æœ‰ç¬¦å·æ•´æ•°æº¢å‡ºä¸ºä½•æå…¶å±é™©ï¼Ÿ',  
         options:['å®ƒæ˜¯æœªå®šä¹‰è¡Œä¸º(UB)ï¼Œç¼–è¯‘å™¨å¯å‡è®¾å®ƒä¸ä¼šå‘ç”Ÿå¹¶åšå‡ºå±é™©ä¼˜åŒ–ï¼Œå¯¼è‡´å®‰å…¨æ£€æŸ¥è¢«æ¶ˆé™¤',  
                  'æ€»æ˜¯ä¼šå›ç»•åˆ°è´Ÿæ•°','ä¼šæŠ›å‡ºå¼‚å¸¸','ä¼šè¢«ç¼–è¯‘å™¨æŠ¥é”™'],  
         answer:0,explanation:'ç»å…¸æ¡ˆä¾‹: ç¼–è¯‘å™¨å¯èƒ½ä¼˜åŒ–æ‰ <code>if(x+1 > x)</code>(å› ä¸ºUBå‡è®¾ä¸æº¢å‡ºæ‰€ä»¥æ’çœŸ)ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºæ£€æŸ¥å¤±æ•ˆã€‚CVEæ•°æ®åº“ä¸­å¤§é‡å®‰å…¨æ¼æ´æºäºæ­¤ã€‚'},  
        {type:'é˜²å¾¡é¢˜',text:'ä»¥ä¸‹å“ªä¸ªæ˜¯é˜²å¾¡æ•´æ•°æº¢å‡ºçš„æœ€ä½³å®è·µï¼Ÿ',  
         options:['ä½¿ç”¨Dietzæ— æº¢å‡ºå…¬å¼ï¼›è¿ç®—å‰èŒƒå›´æ£€æŸ¥ï¼›ä½¿ç”¨__builtin_add_overflowï¼›è€ƒè™‘Rust',  
                  'å¿½ç•¥æº¢å‡º','åªä½¿ç”¨unsigned','ç”¨floatæ›¿ä»£int'],  
         answer:0,explanation:'æœ€ä½³å®è·µ: â‘ ä½¿ç”¨æ— æº¢å‡ºç®—æ³•(å¦‚Dietzå¹³å‡å€¼)â‘¡è¿ç®—å‰èŒƒå›´æ£€æŸ¥â‘¢ä½¿ç”¨ç¼–è¯‘å™¨å†…å»ºæ£€æŸ¥â‘£åœ¨æ–°é¡¹ç›®ä¸­è€ƒè™‘ä½¿ç”¨Rustç­‰å†…å­˜å®‰å…¨è¯­è¨€ã€‚'  
        }  
      ]},  
      {id:'w9l3',name:"Gosper's Hackç²¾é«“",formula:'ç”Ÿæˆæ¨¡å¼ vs è¿‡æ»¤æ¨¡å¼',stars:'â­â­â­',tag:'ç®—æ³•èŒƒå¼',questions:[  
        {type:'ç®—æ³•é¢˜',text:"Gosper's Hackçš„æ ¸å¿ƒç®—æ³•èŒƒå¼æ˜¯ä»€ä¹ˆï¼Ÿ",  
         options:['å°†"è¿‡æ»¤æ¨¡å¼"(æšä¸¾æ‰€æœ‰æ£€æŸ¥æ˜¯å¦æ»¡è¶³)è½¬åŒ–ä¸º"ç”Ÿæˆæ¨¡å¼"(ç›´æ¥ç”Ÿæˆåˆæ³•è§£)',  
                  'æ›´å¿«çš„ç¡¬ä»¶','å¹¶è¡Œè®¡ç®—','å‡å°‘å†…å­˜ä½¿ç”¨'],  
         answer:0,explanation:'æš´åŠ›(è¿‡æ»¤): éå†2^nä¸ªå­é›†ï¼Œè¿‡æ»¤popcount=kçš„ã€‚Gosper(ç”Ÿæˆ): ç›´æ¥ä»å½“å‰åˆæ³•è§£è·³åˆ°ä¸‹ä¸€ä¸ªã€‚è¿™ç§ä»"è¿‡æ»¤"åˆ°"ç”Ÿæˆ"çš„è½¬æ¢æ˜¯ç®—æ³•ä¼˜åŒ–çš„é‡è¦èŒƒå¼ã€‚'},  
        {type:'æ¨å¹¿é¢˜',text:'"ç”Ÿæˆæ¨¡å¼"åœ¨å…¶ä»–ç®—æ³•ä¸­æœ‰å“ªäº›ä½“ç°ï¼Ÿ',  
         options:['å…¨æ’åˆ—çš„Heapç®—æ³•ã€æ ¼é›·ç ç”Ÿæˆã€åº·æ‰˜å±•å¼€â€”â€”éƒ½æ˜¯ç›´æ¥ç”Ÿæˆè€Œéè¿‡æ»¤',  
                  'å¿«é€Ÿæ’åº','å“ˆå¸Œè¡¨','åŠ¨æ€è§„åˆ’'],  
         answer:0,explanation:'Heapç®—æ³•ç›´æ¥ç”Ÿæˆä¸‹ä¸€ä¸ªæ’åˆ—ï¼Œæ ¼é›·ç ç¡®ä¿ç›¸é‚»åªå·®ä¸€ä½ï¼Œåº·æ‰˜å±•å¼€ç›´æ¥æ˜ å°„åˆ°ç¬¬kä¸ªæ’åˆ—ã€‚éƒ½ä½“ç°äº†"ç”Ÿæˆ"æ€ç»´â€”â€”çŸ¥é“å½“å‰çŠ¶æ€å°±èƒ½æ¨å‡ºä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚'}  
      ]},  
      {id:'w9l4',name:'SIMDå¹¶è¡ŒåŒ–',formula:'è½¯ä»¶ä½æ“ä½œâ†’ç¡¬ä»¶SIMD',stars:'â­â­',tag:'ç°ä»£å¹¶è¡Œ',questions:[  
        {type:'SIMDé¢˜',text:'ä¸ºä»€ä¹ˆSIMDç¼–ç¨‹ç‰¹åˆ«éœ€è¦æ— åˆ†æ”¯æŠ€å·§ï¼Ÿ',  
         options:['SIMDåŒæ—¶å¤„ç†å¤šä¸ªæ•°æ®ï¼Œåˆ†æ”¯ä¼šå¯¼è‡´è½¦é“åˆ†æ­§(lane divergence)ï¼Œéƒ¨åˆ†è½¦é“ç©ºè½¬æµªè´¹èµ„æº',  
                  'SIMDæ²¡æœ‰åŠ æ³•æŒ‡ä»¤','çº¯ç²¹æ˜¯å†å²åŸå› ','SIMDæ¯”æ™®é€šä»£ç æ…¢'],  
         answer:0,explanation:'SSE/AVXåŒæ—¶å¤„ç†4/8/16ä¸ªæ•´æ•°ã€‚å¦‚æœæŸä¸ªåˆ†æ”¯åªå¯¹éƒ¨åˆ†è½¦é“æˆç«‹ï¼Œç¡¬ä»¶å¿…é¡»ä¸¤ä¸ªåˆ†æ”¯éƒ½æ‰§è¡Œï¼Œæœªé€‰ä¸­çš„è½¦é“ç»“æœè¢«å±è”½ã€‚æ— åˆ†æ”¯ä»£ç æ‰€æœ‰è½¦é“æ‰§è¡Œç›¸åŒæŒ‡ä»¤ï¼Œæ•ˆç‡æœ€é«˜ã€‚'},  
        {type:'å®ä¾‹é¢˜',text:'SSE/AVXä¸­çš„ <code>_mm_min_epi32</code> æŒ‡ä»¤æ˜¯å“ªä¸ªè½¯ä»¶æŠ€å·§çš„ç¡¬ä»¶åŒ–ï¼Ÿ',  
         options:['æ— åˆ†æ”¯min: y+((x-y)&((x-y)>>31))ï¼Œ4ä¸ª32ä½æ•´æ•°å¹¶è¡Œå–æœ€å°å€¼',  
                  'Gosper\'s Hack','Dietzå¹³å‡å€¼','MUXé€‰æ‹©å™¨'],  
         answer:0,explanation:'<code>_mm_min_epi32</code> åœ¨å•ä¸ªæŒ‡ä»¤ä¸­å¯¹4ä¸ª32ä½æ•´æ•°å¯¹å–æœ€å°å€¼ï¼Œæ­£æ˜¯æ— åˆ†æ”¯minçš„ç¡¬ä»¶å®ç°ã€‚ç±»ä¼¼çš„è¿˜æœ‰ <code>_mm_max_epi32</code>ã€<code>_mm_avg_epu16</code>(Dietz)ç­‰ã€‚'}  
      ]},  
      {id:'w9l5',name:'å‰æ²¿åº”ç”¨æ–¹å‘',formula:'å¯†ç å­¦Â·é‡å­Â·AIåŠ é€Ÿå™¨',stars:'â­â­',tag:'æœªæ¥å±•æœ›',questions:[  
        {type:'å‰æ²¿é¢˜',text:'ä½æ“ä½œåœ¨å¯†ç å­¦ä¸­ä¸ºä»€ä¹ˆå¿…é¡»ä½¿ç”¨"æ’æ—¶(constant-time)"å®ç°ï¼Ÿ',  
         options:['æ™®é€šåˆ†æ”¯çš„æ‰§è¡Œæ—¶é—´ä¾èµ–æ•°æ®ï¼Œæ”»å‡»è€…å¯é€šè¿‡è®¡æ—¶æ”»å‡»(timing attack)æ¨æ–­å¯†é’¥',  
                  'æ€§èƒ½æ›´å¥½','ä»£ç æ›´çŸ­','ç¼–è¯‘å™¨è¦æ±‚'],  
         answer:0,explanation:'RSA/AESç­‰å¯†ç æ“ä½œå¦‚æœå«æœ‰æ•°æ®ä¾èµ–çš„åˆ†æ”¯ï¼Œæ”»å‡»è€…é€šè¿‡ç²¾ç¡®æµ‹é‡æ‰§è¡Œæ—¶é—´å°±èƒ½æ¨æ–­å‡ºå¯†é’¥æ¯”ç‰¹ã€‚æ’æ—¶ä½æ“ä½œ(æ— åˆ†æ”¯)è®©æ‰§è¡Œæ—¶é—´ä¸æ•°æ®æ— å…³ï¼Œé˜»æ–­ä¾§ä¿¡é“ã€‚'},  
        {type:'è¶‹åŠ¿é¢˜',text:'éšç€ç¡¬ä»¶è¶Šæ¥è¶Šå¼ºï¼Œä½æ“ä½œæŠ€å·§æ˜¯å¦ä¼šè¿‡æ—¶ï¼Ÿ',  
         options:['ä¸ä¼šâ€”â€”å®ƒä»¬è¢«å¸æ”¶è¿›ç¡¬ä»¶(BMI)å’Œç¼–è¯‘å™¨ï¼Œå¹¶åœ¨æ–°é¢†åŸŸ(é‡å­/AIåŠ é€Ÿå™¨/å®‰å…¨è®¡ç®—)é‡æ–°æ¶Œç°',  
                  'ä¼šå®Œå…¨è¿‡æ—¶','å–å†³äºç¼–ç¨‹è¯­è¨€','50å¹´åå¯èƒ½æ¶ˆå¤±'],  
         answer:0,explanation:'å†å²è§„å¾‹: è½¯ä»¶æŠ€å·§â†’ç¼–è¯‘å™¨ä¼˜åŒ–â†’ç¡¬ä»¶æŒ‡ä»¤â†’é‡Šæ”¾ç¨‹åºå‘˜å»æ¢ç´¢æ›´é«˜å±‚æŠ½è±¡â†’æ–°é¢†åŸŸåˆéœ€è¦åº•å±‚ä½æ“ä½œã€‚é‡å­é—¨æœ¬è´¨æ˜¯qubitå˜æ¢ï¼ŒAIåŠ é€Ÿå™¨å¤§é‡ä½¿ç”¨ä½å¹¶è¡Œï¼Œè¿™ä¸ªå¾ªç¯ä¸ä¼šç»“æŸã€‚'}  
      ]}  
    ]  
  },  
  {  
    id:'w10',icon:'âœï¸',title:'è¯¾åç²¾é€‰é¢˜',subtitle:'6é“ç»å…¸æŒ‘æˆ˜',accent:'#a855f7',accentLight:'#c084fc',  
    levels:[  
      {id:'w10l1',name:'Q1: Dietzæ— æº¢å‡ºè¯æ˜',formula:'(x&y)+((x^y)>>1) â‰¤ max(x,y)',stars:'â­â­',tag:'ç†è®ºè¯æ˜',questions:[  
        {type:'è¯æ˜é¢˜',text:'è¯æ˜ <code>(x&y)+((x^y)>>1)</code> ä¸ä¼šæº¢å‡ºçš„å…³é”®è®ºç‚¹æ˜¯ï¼Ÿ',  
         options:['x&y â‰¤ min(x,y)ï¼Œ(x^y)>>1 â‰¤ (x^y)/2ï¼Œä¸”ä¸¤é¡¹ä¹‹å’Œä¸è¶…è¿‡max(x,y)',  
                  'å› ä¸ºå³ç§»äº†æ‰€ä»¥å˜å°','ç»éªŒè¯æ˜æ‰€æœ‰caseéƒ½ok','æ— æ³•ä¸¥æ ¼è¯æ˜'],  
         answer:0,explanation:'ä¸¥æ ¼è¯æ˜: å¯¹ä»»æ„ä½iï¼Œx&yçš„ç¬¬iä½=1è¦æ±‚x,yçš„ç¬¬iä½éƒ½=1ï¼›(x^y)>>1çš„ç¬¬iä½=1è¦æ±‚x,yçš„ç¬¬i+1ä½æ°å¥½ä¸€ä¸ª=1ã€‚ä¸¤è€…å¯¹åº”ä¸åŒä½çš„1ï¼Œä¸äº§ç”Ÿé¢å¤–è¿›ä½ï¼Œæ•…æ€»å’Œä¸è¶…è¿‡max(x,y)ã€‚'},  
        {type:'å»¶ä¼¸é¢˜',text:'å¯¹äºæ— ç¬¦å·æ•°ï¼Œ<code>(x&y)+((x^y)>>1)</code> æ˜¯floorè¿˜æ˜¯ceilï¼Ÿ',  
         options:['floor(å‘ä¸‹å–æ•´)â€”â€”å³ç§»ä¸¢å¤±äº†(x^y)çš„æœ€ä½ä½ï¼Œå½“xå’Œyå¥‡å¶ä¸åŒæ—¶æŸå¤±0.5',  
                  'ceil(å‘ä¸Šå–æ•´)','ç²¾ç¡®å€¼','å–å†³äºxå’Œyçš„å¤§å°'],  
         answer:0,explanation:'å½“xå’Œyæœ€ä½ä½ä¸åŒ(ä¸€ä¸ª0ä¸€ä¸ª1)ï¼ŒçœŸå®å¹³å‡å€¼æœ‰0.5çš„å°æ•°éƒ¨åˆ†ï¼Œ<code>(x^y)>>1</code>çš„å³ç§»å°†å…¶æˆªæ–­ã€‚è¿™æ˜¯floor(å‘ä¸‹å–æ•´)ã€‚å¦‚éœ€ceilï¼Œå¯ç”¨ <code>(x|y)-((x^y)>>1)</code>ã€‚'}  
      ]},  
      {id:'w10l2',name:'Q2: MUXç­‰ä»·è¯æ˜',formula:'((x^y)&m)^y = (x&m)|(y&~m)',stars:'â­â­',tag:'ä¼˜åŒ–è¯æ˜',questions:[  
        {type:'è¯æ˜é¢˜',text:'è¯æ˜ <code>((x^y)&m)^y = (x&m)|(y&~m)</code> çš„æ–¹æ³•æ˜¯ï¼Ÿ',  
         options:['å¯¹mçš„æ¯ä¸€ä½åˆ†æƒ…å†µ: m=1æ—¶ä¸¤è¾¹å‡ä¸ºxï¼›m=0æ—¶ä¸¤è¾¹å‡ä¸ºyï¼Œé€ä½ç­‰ä»·',  
                  'æ•°å­¦å½’çº³æ³•','åè¯æ³•','æ— æ³•è¯æ˜'],  
         answer:0,explanation:'mä½=1: å·¦è¾¹ <code>((x^y)&1)^y=(x^y)^y=x</code>ï¼›å³è¾¹ <code>(x&1)|(y&0)=x</code>ã€‚âœ“ mä½=0: å·¦è¾¹ <code>((x^y)&0)^y=0^y=y</code>ï¼›å³è¾¹ <code>(x&0)|(y&1)=y</code>ã€‚âœ“ é€ä½ç­‰ä»·ï¼ŒQEDã€‚'},  
        {type:'æ¨å¹¿é¢˜',text:'ä¼˜åŒ–MUXèŠ‚çœçš„1æ¡æŒ‡ä»¤æ˜¯å“ªæ¡ï¼Ÿ',  
         options:['çœå»äº†ä¸€æ¬¡NOTæ“ä½œ(~m)ï¼Œä»{XOR,AND,OR,NOT}é™ä¸º{XOR,AND,XOR}',  
                  'çœå»äº†ä¸€æ¬¡AND','çœå»äº†ä¸€æ¬¡OR','çœå»äº†ä¸€æ¬¡XOR'],  
         answer:0,explanation:'æ ‡å‡†MUX: <code>(x&m)|(y&~m)</code> éœ€è¦ AND, NOT, AND, OR = 4æ¡ã€‚ä¼˜åŒ–MUX: <code>((x^y)&m)^y</code> éœ€è¦ XOR, AND, XOR = 3æ¡ã€‚çœå»äº†NOTæŒ‡ä»¤ï¼Œä¸”XORé“¾å¯æµæ°´åŒ–ã€‚'}  
      ]},  
      {id:'w10l3',name:'Q3: ä½å¤åˆ¶ç»¼åˆ',formula:'å¤åˆ¶bit i åˆ° bit j',stars:'â­',tag:'ç»„åˆåº”ç”¨',questions:[  
        {type:'ç¼–ç é¢˜',text:'å®ç°"å°†xçš„ç¬¬iä½å¤åˆ¶åˆ°ç¬¬jä½"çš„æœ€ç®€æ´ä½æ“ä½œï¼Ÿ',  
         options:['x = (x & ~(1<<j)) | (((x>>i)&1)<<j)',  
                  'x = x ^ (1<<j)','x = x | (1<<j)','x = x & (1<<i)'],  
         answer:0,explanation:'ä¸‰æ­¥: â‘ æå–ç¬¬iä½: <code>(x>>i)&1</code>ã€‚â‘¡ç§»åˆ°ç¬¬jä½ä½ç½®: <code><<j</code>ã€‚â‘¢æ¸…é™¤åŸç¬¬jä½å¹¶å†™å…¥: <code>(x & ~(1<<j)) | æ–°å€¼</code>ã€‚è¿™æ˜¯ä½åŸŸæ“ä½œçš„ç»å…¸ç»„åˆã€‚'},  
        {type:'ä¼˜åŒ–é¢˜',text:'ç”¨MUXæŠ€å·§ä¼˜åŒ–"ä½å¤åˆ¶"æ“ä½œï¼Œå‡å°‘æŒ‡ä»¤æ•°ï¼Ÿ',  
         options:['mask = 1<<j; x = ((x>>i)^x)&mask)^x â€” ç”¨3æŒ‡ä»¤MUXï¼Œçœå»NOT',  
                  'æ— æ³•ä¼˜åŒ–','éœ€è¦æ›´å¤šæŒ‡ä»¤','åªèƒ½ç”¨åŸå§‹æ–¹æ³•'],  
         answer:0,explanation:'ä»¤bit=<code>(x>>i)&1</code>ï¼Œæ‰©å±•ä¸ºå…¨0æˆ–å…¨1: ä½†MUXçš„ç²¾é«“æ˜¯: å…ˆè®¡ç®—"æ˜¯å¦éœ€è¦æ”¹å˜å½“å‰jä½"ï¼Œå³ <code>diff = ((x>>i)^(x>>j))&1</code>ï¼Œç„¶å <code>x ^= diff<<j</code>ã€‚åªéœ€3æ­¥ï¼'}  
      ]},  
      {id:'w10l4',name:'Q4: Gosperå®Œæ•´å®ç°',formula:'ä¸€è¡Œä»£ç æšä¸¾æ‰€æœ‰C(n,k)',stars:'â­â­â­',tag:'ç»¼åˆæŒ‘æˆ˜',questions:[  
        {type:'å®ç°é¢˜',text:'ç”¨Gosper\'s Hackæšä¸¾æ‰€æœ‰5ä½ä¸­é€‰3ä½çš„å­é›†ï¼Œèµ·å§‹å€¼æ˜¯ï¼Ÿ',  
         options:['0b00111 (7) â€” popcount=3çš„æœ€å°å€¼ï¼Œä»ä½ä½å¼€å§‹',  
                  '0b11100','0b10101','0b01110'],  
         answer:0,explanation:'æšä¸¾ä»æœ€å°çš„åŒpopcountæ•°å¼€å§‹: popcount=3çš„æœ€å°32ä½æ•°æ˜¯ <code>0b00000111=7</code>ã€‚Gosperæ¯æ¬¡ç”Ÿæˆä¸‹ä¸€ä¸ªï¼Œç›´åˆ°è¶…å‡ºnä½èŒƒå›´(>0b11100=28)åœæ­¢ï¼Œæ°å¥½æšä¸¾C(5,3)=10ä¸ªã€‚'},  
        {type:'éªŒè¯é¢˜',text:'<code>x=0b0010_1100(44)</code> çš„Gosperä¸‹ä¸€ä¸ªæ˜¯ï¼Ÿ',  
         options:['0b0011_0001(49) â€” æœ€ä½ä¸¤ä¸ª1è¿›ä½ï¼Œä½ä½è¡¥1ä¸ª1',  
                  '0b0010_1101(45)','0b0101_0000(80)','0b0100_0011(67)'],  
         answer:0,explanation:'c=x&(-x)=4, r=x+c=48(0b110000), æ¶ˆç­äº†ä¸¤ä¸ª1å¹¶è¿›ä¸€ä¸ª1ã€‚å·®é¢ones=1ï¼Œresult=r|ones=0b110001=49ã€‚éªŒè¯popcount(49)=3=popcount(44) âœ“'},  
        {type:'åº”ç”¨é¢˜',text:'ç”¨Gosperæšä¸¾æ‰€æœ‰ä»32ä¸ªå…ƒç´ ä¸­é€‰5ä¸ªçš„å­é›†å…±å¤šå°‘ä¸ªï¼Ÿéœ€è¦å¤šå°‘æ¬¡è¿­ä»£ï¼Ÿ',  
         options:['C(32,5) = 201,376 æ¬¡è¿­ä»£ï¼Œæ¯æ¬¡O(1)æ“ä½œ',  
                  '2^32 = 42äº¿æ¬¡','32^5æ¬¡','C(32,5)^2æ¬¡'],  
         answer:0,explanation:'Gosperå®Œç¾åœ°åªè®¿é—®æ¯ä¸ªåˆæ³•å­é›†æ°å¥½ä¸€æ¬¡ï¼Œå…±C(32,5)=201376æ¬¡ã€‚ç›¸æ¯”æš´åŠ›çš„2^32=42äº¿æ¬¡ï¼ŒèŠ‚çœäº†2ä¸‡å€çš„å·¥ä½œé‡ï¼Œè¿™å°±æ˜¯"ç”Ÿæˆæ¨¡å¼"çš„å¨åŠ›ã€‚'}  
      ]},  
      {id:'w10l5',name:'Q5: ç»¼åˆä¼˜åŒ–æŒ‘æˆ˜',formula:'é€‰æ‹©æœ€ä¼˜å®ç°',stars:'â­â­â­',tag:'ç»¼åˆåº”ç”¨',questions:[  
        {type:'ç»¼åˆé¢˜',text:'ä»¥ä¸‹å“ªä¸ªabs(x)å®ç°åœ¨ç°ä»£ç¼–è¯‘å™¨ä¼˜åŒ–åæ€§èƒ½æœ€å¥½ï¼Ÿ',  
         options:['è®©ç¼–è¯‘å™¨è‡ªåŠ¨ä¼˜åŒ–(gcc -O2é€šå¸¸ç”Ÿæˆæœ€ä¼˜ä»£ç ï¼Œå¯èƒ½ç”¨CMOVæˆ–NEG+CMOV)',  
                  'æ‰‹å†™ä½æ“ä½œ (x+(x>>31))^(x>>31)','ç”¨std::abs()','ç”¨æ¡ä»¶è¿ç®—ç¬¦x>0?x:-x'],  
         answer:0,explanation:'ç°ä»£ç¼–è¯‘å™¨åœ¨-O2ä¸‹å¯¹ <code>x>0?x:-x</code> é€šå¸¸èƒ½ç”Ÿæˆä¸æ‰‹å†™ä½æ“ä½œç­‰ä»·ç”šè‡³æ›´ä¼˜çš„ä»£ç ã€‚æ‰‹å†™ä½æ“ä½œé™ä½å¯è¯»æ€§ï¼Œåœ¨æœ‰ç¼–è¯‘å™¨ä¼˜åŒ–æ—¶æ„ä¹‰ä¸å¤§ã€‚æ˜æ™ºçš„åšæ³•: å†™æ¸…æ™°ä»£ç ï¼Œæµ‹é‡ï¼ŒæŒ‰éœ€ä¼˜åŒ–ã€‚'},  
        {type:'æ€è€ƒé¢˜',text:'ä»€ä¹ˆæ—¶å€™åº”è¯¥æ‰‹å†™ä½æ“ä½œæŠ€å·§ï¼Œè€Œä¸æ˜¯ä¾èµ–ç¼–è¯‘å™¨ï¼Ÿ',  
         options:['ç¼–è¯‘å™¨æ— æ³•è¯†åˆ«çš„ç‰¹å®šæ¨¡å¼(å¦‚Gosper\'s Hack)ï¼›åµŒå…¥å¼/å®æ—¶ç³»ç»Ÿæ— ä¼˜åŒ–å™¨ï¼›å¯†ç å­¦æ’æ—¶è¦æ±‚ï¼›ç«èµ›ç¼–ç¨‹',  
                  'æ°¸è¿œéƒ½åº”è¯¥æ‰‹å†™','æ°¸è¿œä¸éœ€è¦æ‰‹å†™','åªåœ¨Cè¯­è¨€ä¸­'],  
         answer:0,explanation:'åˆç†é€‰æ‹©: â‘ ç¼–è¯‘å™¨èƒ½ä¼˜åŒ–çš„åŸºç¡€æ“ä½œ(abs/min/max)â†’å†™æ¸…æ™°ä»£ç  â‘¡å¤æ‚ç»„åˆç®—æ³•(Gosper/Dietz)â†’æ‰‹å†™å¹¶æ³¨é‡Š â‘¢å®‰å…¨å…³é”®ä»£ç (æ’æ—¶)â†’æ‰‹å†™å¹¶éªŒè¯ â‘£æ€§èƒ½å…³é”®å†…å±‚å¾ªç¯â†’profileåå†³å®š'}  
      ]},  
      {id:'w10l6',name:'Q6: ç»ˆæç‹è€…æŒ‘æˆ˜',formula:'å…¨çŸ¥è¯†ç»¼åˆ',stars:'â­â­â­',tag:'æœ€ç»ˆBOSS',questions:[  
        {type:'ç»¼åˆé¢˜',text:'è®¾è®¡ä¸€ä¸ªå‡½æ•°: è¾“å…¥x(32ä½æ— ç¬¦å·æ•´æ•°)ï¼Œè¿”å›"xçš„popcountæ˜¯å¦ä¸ºå¥‡æ•°"(1/0)ã€‚æœ€ä¼˜å®ç°ï¼Ÿ',  
         options:['x ^= x>>16; x ^= x>>8; x ^= x>>4; x ^= x>>2; x ^= x>>1; return x&1; â€” XORæŠ˜å æ³•',  
                  'return __builtin_popcount(x)%2','return x&1','return popcount(x)>16'],  
         answer:0,explanation:'XORæŠ˜å : æ¯æ¬¡å°†é«˜åŠéƒ¨åˆ†æŠ˜å åˆ°ä½åŠéƒ¨åˆ†(é«˜ä½ä½XOR)ï¼Œå¥‡å¶æ€§ä¿æŒä¸å˜ã€‚æœ€ç»ˆç¬¬0ä½å°±æ˜¯popcountçš„å¥‡å¶æ€§ã€‚æˆ–è€…ç›´æ¥ç”¨ <code>__builtin_parity(x)</code>ï¼Œä½†ç†è§£æŠ˜å åŸç†æ˜¯å…³é”®ã€‚'},  
        {type:'ç»ˆæé¢˜',text:'ä¸‹åˆ—å…³äºä½æ“ä½œçš„è¯´æ³•ï¼Œå“ªä¸ªæ˜¯é”™è¯¯çš„ï¼Ÿ',  
         options:['x & (x+1) æ¸…é™¤æœ€å³è¾¹çš„0 (âŒ é”™è¯¯ï¼šå®ƒæ¸…é™¤å°¾éƒ¨è¿ç»­çš„1ï¼Œä¸æ˜¯0)',  
                  'x & (x-1) æ¸…é™¤æœ€å³è¾¹çš„1 (âœ“ æ­£ç¡®)','x | (x+1) ç½®ä½æœ€å³è¾¹çš„0 (âœ“ æ­£ç¡®)','x & (-x) æå–æœ€ä½ä½çš„1 (âœ“ æ­£ç¡®)'],  
         answer:0,explanation:'<code>x & (x+1)</code> çš„ä½œç”¨æ˜¯æ¸…é™¤å°¾éƒ¨è¿ç»­çš„1(ä¸æ˜¯0)ã€‚ä¾‹å¦‚ <code>0b10110111 & 0b10111000 = 0b10110000</code>ã€‚è¿™æ˜¯æœ€å®¹æ˜“æ··æ·†çš„å…¬å¼ä¹‹ä¸€ï¼Œè¯·è®°ä½: +1äº§ç”Ÿè¿›ä½ç¿»è½¬è¿ç»­1ï¼ŒANDåå°¾éƒ¨è¿ç»­1æ¶ˆå¤±ã€‚'},  
        {type:'ç»ˆæé¢˜2',text:'åœ¨64ä½ç³»ç»Ÿä¸Šï¼Œè®¡ç®—ä»»æ„æ•´æ•°xçš„ä»¥2ä¸ºåº•çš„å¯¹æ•°ä¸‹å–æ•´(floor(log2(x)))ï¼Œæœ€å¿«æ–¹æ³•ï¼Ÿ',  
         options:['63 - __builtin_clzll(x) â€” 63å‡å»å‰å¯¼é›¶æ•°é‡ï¼Œå•æŒ‡ä»¤BSR/LZCNT',  
                  'å¾ªç¯å³ç§»è®¡æ•°','æŸ¥è¡¨æ³•','ç”¨æ•°å­¦åº“log2()'],  
         answer:0,explanation:'å‰å¯¼é›¶æ•°é‡(clz)å‘Šè¯‰æˆ‘ä»¬æœ€é«˜ä½1çš„ä½ç½®ï¼Œå³ <code>floor(log2(x)) = 63 - clz(x)</code>ã€‚x86çš„BSRæŒ‡ä»¤ã€ARMçš„CLZæŒ‡ä»¤éƒ½æ˜¯å•å‘¨æœŸæ“ä½œã€‚è¿™æ¯”æ•°å­¦åº“çš„æµ®ç‚¹log2()å¿«10-100å€ã€‚'}  
      ]}  
    ]  
  }  
];  

// WORLDS æ•°ç»„å·²åŒ…å«æ‰€æœ‰ä¸–ç•Œ (w1-w10)ï¼Œç›´æ¥ä½¿ç”¨
const ALL_WORLDS = WORLDS;

// ============================================================  
//  æ¸¸æˆçŠ¶æ€ç®¡ç†  
// ============================================================  
const STATE_KEY = 'bitmaster_v3';  
let gameState = {  
  totalScore: 0,  
  cleared: {},      // levelId -> {score, stars}  
  streak: 0,  
  maxStreak: 0,  
  achievements: {}  
};  

function loadState() {  
  try {  
    const s = localStorage.getItem(STATE_KEY);  
    if (s) gameState = { ...gameState, ...JSON.parse(s) };  
  } catch(e) {}  
}  

function saveState() {  
  try { localStorage.setItem(STATE_KEY, JSON.stringify(gameState)); } catch(e) {}  
}  

// ============================================================  
//  æˆå°±ç³»ç»Ÿ  
// ============================================================  
const ACHIEVEMENTS = [  
  { id:'first_blood', name:'åˆè§é”‹èŠ’', icon:'âš”ï¸', desc:'å®Œæˆç¬¬ä¸€å…³' },  
  { id:'perfect_10', name:'æ»¡åˆ†è¾¾äºº', icon:'ğŸ’¯', desc:'æŸå…³å…¨é¢˜ç­”å¯¹' },  
  { id:'streak_5', name:'è¿èƒœäº”æ€', icon:'ğŸ”¥', desc:'è¿ç»­5é¢˜ç­”å¯¹' },  
  { id:'streak_10', name:'åè¿æ— æ•Œ', icon:'âš¡', desc:'è¿ç»­10é¢˜ç­”å¯¹' },  
  { id:'world_1', name:'ä½æ“çºµå¤§å¸ˆ', icon:'ğŸ”§', desc:'å®Œæˆä¸–ç•Œ1å…¨éƒ¨å…³å¡' },  
  { id:'world_5', name:'Gosperé—¨å¾’', icon:'ğŸŒŸ', desc:'å®ŒæˆGosper\'s Hackä¸–ç•Œ' },  
  { id:'halfway', name:'åŠç¨‹å‹‡å£«', icon:'ğŸƒ', desc:'å®Œæˆ25å…³' },  
  { id:'champion', name:'ä½æ“ä½œç‹è€…', icon:'ğŸ‘‘', desc:'å®Œæˆæ‰€æœ‰å…³å¡' }  
];  

function checkAchievements(context = {}) {  
  const totalCleared = Object.keys(gameState.cleared).length;  
  const checks = [  
    { id:'first_blood', cond: totalCleared >= 1 },  
    { id:'perfect_10', cond: context.perfect === true },  
    { id:'streak_5', cond: gameState.streak >= 5 },  
    { id:'streak_10', cond: gameState.streak >= 10 },  
    { id:'halfway', cond: totalCleared >= 25 },  
    { id:'champion', cond: totalCleared >= ALL_WORLDS.reduce((a,w)=>a+w.levels.length,0) },  
    { id:'world_1', cond: ALL_WORLDS[0].levels.every(l => gameState.cleared[l.id]) },  
    { id:'world_5', cond: ALL_WORLDS[4] && ALL_WORLDS[4].levels.every(l => gameState.cleared[l.id]) }  
  ];  
  checks.forEach(c => {  
    if (c.cond && !gameState.achievements[c.id]) {  
      gameState.achievements[c.id] = true;  
      const ach = ACHIEVEMENTS.find(a => a.id === c.id);  
      if (ach) setTimeout(() => showAchievement(ach), 500);  
    }  
  });  
}  

function showAchievement(ach) {  
  const el = document.getElementById('achievementPopup');  
  document.getElementById('achName').textContent = ach.name + ' â€” ' + ach.desc;  
  document.getElementById('achIcon').textContent = ach.icon;  
  el.classList.add('show');  
  setTimeout(() => el.classList.remove('show'), 3500);  
}  

// ============================================================  
//  UIå·¥å…·å‡½æ•°  
// ============================================================  
function showToast(msg, duration = 2200) {  
  const el = document.getElementById('toastEl');  
  if (!el) return;  
  el.textContent = msg;  
  el.classList.add('show');  
  setTimeout(() => el.classList.remove('show'), duration);  
}  

function setScreen(id) {  
  ['world-map','level-select','game-play','result-screen'].forEach(s => {  
    const el = document.getElementById(s);  
    if (el) el.style.display = 'none';  
  });  
  const target = document.getElementById(id);  
  if (target) { target.style.display = 'block'; target.classList.add('screen-transition'); }  
}  

function updateStatsBar() {  
  const totalLevels = ALL_WORLDS.reduce((a,w) => a + w.levels.length, 0);  
  const cleared = Object.keys(gameState.cleared).length;  
  const pct = Math.round(cleared / totalLevels * 100);  
  const el = (id, val) => { const e = document.getElementById(id); if(e) e.textContent = val; };  
  el('statProgress', pct + '%');  
  el('statCleared', cleared);  
  el('statScore', gameState.totalScore.toLocaleString());  
  el('statStreak', gameState.streak);  
}  

// ============================================================  
//  æµ®åŠ¨ç²’å­  
// ============================================================  
function initFloatingBits() {  
  const container = document.getElementById('floatingBits');  
  if (!container) return;  
  const symbols = ['0','1','&','|','^','~','<<','>>'];  
  for (let i = 0; i < 22; i++) {  
    const span = document.createElement('span');  
    span.textContent = symbols[Math.floor(Math.random()*symbols.length)];  
    span.style.cssText = `  
      left: ${Math.random()*100}%;  
      animation-duration: ${8+Math.random()*14}s;  
      animation-delay: ${Math.random()*10}s;  
      font-size: ${0.8+Math.random()*1.2}em;  
      opacity: ${0.03+Math.random()*0.06};  
    `;  
    container.appendChild(span);  
  }  
}  

// ============================================================  
//  ä¸–ç•Œåœ°å›¾æ¸²æŸ“  
// ============================================================  
function showWorldMap() {  
  setScreen('world-map');  
  updateStatsBar();  
  renderWorldMap();  
}  

function renderWorldMap() {  
  const container = document.getElementById('world-map');  
  if (!container) return;  
  container.innerHTML = '';  
  ALL_WORLDS.forEach((world, wi) => {  
    const total = world.levels.length;  
    const done = world.levels.filter(l => gameState.cleared[l.id]).length;  
    const pct = Math.round(done / total * 100);  
    const isComplete = done === total;  
    const card = document.createElement('div');  
    card.className = 'world-card' + (isComplete ? ' completed' : '');  
    card.style.setProperty('--card-accent', world.accent);  
    card.style.setProperty('--card-accent-light', world.accentLight || world.accent);  
    card.innerHTML = `  
      <div class="world-icon">${world.icon}</div>  
      <div class="world-title" style="color:${world.accent}">${world.title}</div>  
      <div class="world-subtitle">${world.subtitle}</div>  
      <div class="world-progress-bar">  
        <div class="world-progress-fill" style="width:${pct}%;background:linear-gradient(90deg,${world.accent},${world.accentLight||world.accent})"></div>  
      </div>  
      <div class="world-stats">  
        <span>${done}/${total} å…³é€šå…³</span>  
        <span style="color:${world.accent}">${pct}%${isComplete?' ğŸ†':''}</span>  
      </div>  
    `;  
    card.onclick = () => showLevelSelect(wi);  
    container.appendChild(card);  
  });  
}  

// ============================================================  
//  å…³å¡é€‰æ‹©  
// ============================================================  
function showLevelSelect(worldIndex) {  
  currentWorldIndex = worldIndex;  
  const world = ALL_WORLDS[worldIndex];  
  setScreen('level-select');  
  document.getElementById('levelWorldTitle').textContent = world.icon + ' ' + world.title;  
  document.getElementById('levelWorldDesc').textContent = world.subtitle;  
  const grid = document.getElementById('levelGrid');  
  if (!grid) return;  
  grid.innerHTML = '';  
  world.levels.forEach((level, li) => {  
    const isCleared = !!gameState.cleared[level.id];  
    const isLocked = li > 0 && !gameState.cleared[world.levels[li-1].id];  
    const card = document.createElement('div');  
    card.className = 'level-card' + (isCleared ? ' cleared' : '') + (isLocked ? ' locked' : '');  
    card.innerHTML = `  
      <div class="level-status"></div>  
      <div class="level-num">LEVEL ${li+1}</div>  
      <div class="level-name">${level.name}</div>  
      <div class="level-formula">${level.formula}</div>  
      <div class="level-stars">${level.stars}</div>  
      <span class="level-tag">${level.tag}</span>  
      ${isCleared ? `<div style="font-size:.75em;color:var(--accent-green);margin-top:6px">æœ€é«˜ ${gameState.cleared[level.id].score || 0}åˆ†</div>` : ''}  
    `;  
    card.onclick = () => startLevel(worldIndex, li);  
    grid.appendChild(card);  
  });  
}  

// ============================================================  
//  æ¸¸æˆæ ¸å¿ƒå˜é‡  
// ============================================================  
let currentWorldIndex = 0;  
let currentLevelIndex = 0;  
let currentQuestions = [];  
let currentQIndex = 0;  
let sessionScore = 0;  
let sessionCorrect = 0;  
let sessionAnswered = 0;  
let answeredThisQ = false;  

// ============================================================  
//  å¼€å§‹å…³å¡  
// ============================================================  
function startLevel(worldIndex, levelIndex) {  
  currentWorldIndex = worldIndex;  
  currentLevelIndex = levelIndex;  
  const world = ALL_WORLDS[worldIndex];  
  const level = world.levels[levelIndex];  
  currentQuestions = shuffleArr([...level.questions]);  
  currentQIndex = 0;  
  sessionScore = 0;  
  sessionCorrect = 0;  
  sessionAnswered = 0;  

  document.getElementById('gpWorld').textContent = world.icon + ' ' + world.title;  
  document.getElementById('gpTitle').textContent = level.name;  
  document.getElementById('gpFormula').textContent = level.formula;  

  setScreen('game-play');  
  renderQuestion();  
}  

function shuffleArr(arr) {  
  for (let i = arr.length-1; i > 0; i--) {  
    const j = Math.floor(Math.random()*(i+1));  
    [arr[i],arr[j]] = [arr[j],arr[i]];  
  }  
  return arr;  
}  

// ============================================================  
//  æ¸²æŸ“é¢˜ç›®  
// ============================================================  
function renderQuestion() {  
  const q = currentQuestions[currentQIndex];  
  answeredThisQ = false;  

  // è¿›åº¦ç‚¹  
  const prog = document.getElementById('qProgress');  
  if (prog) {  
    prog.innerHTML = currentQuestions.map((_,i) => {  
      let cls = 'dot';  
      if (i < currentQIndex) cls += ' correct';  
      if (i === currentQIndex) cls += ' active';  
      return `<div class="${cls}" id="dot_${i}"></div>`;  
    }).join('');  
  }  

  // é¢˜ç›®ç±»å‹ & æ–‡æœ¬  
  const qType = document.getElementById('qType');  
  const qText = document.getElementById('qText');  
  if (qType) qType.textContent = 'ğŸ“‹ ' + q.type;  
  if (qText) qText.innerHTML = q.text;  

  // é€‰é¡¹  
  const opts = document.getElementById('qOptions');  
  if (opts) {  
    opts.innerHTML = '';  
    const letters = ['A','B','C','D','E'];  
    q.options.forEach((opt, i) => {  
      const btn = document.createElement('button');  
      btn.className = 'option-btn';  
      btn.innerHTML = `  
        <div class="opt-letter">${letters[i]}</div>  
        <div class="opt-text">${formatCode(opt)}</div>  
      `;  
      btn.onclick = () => selectAnswer(i, q);  
      opts.appendChild(btn);  
    });  
  }  

  // éšè—è§£æå’ŒnextæŒ‰é’®  
  const exp = document.getElementById('qExplanation');  
  const nb = document.getElementById('nextBtn');  
  if (exp) exp.style.display = 'none';  
  if (nb) { nb.style.display = 'none'; nb.textContent = currentQIndex < currentQuestions.length-1 ? 'ä¸‹ä¸€é¢˜ â†’' : 'æŸ¥çœ‹ç»“æœ ğŸ‰'; }  
}  

function formatCode(text) {  
  return text.replace(/`([^`]+)`/g, '<code>$1</code>');  
}  

// ============================================================  
//  é€‰æ‹©ç­”æ¡ˆ  
// ============================================================  
function selectAnswer(index, q) {  
  if (answeredThisQ) return;  
  answeredThisQ = true;  
  sessionAnswered++;  

  const buttons = document.querySelectorAll('.option-btn');  
  buttons.forEach(b => b.classList.add('disabled'));  

  const isCorrect = index === q.answer;  
  buttons[index].classList.add(isCorrect ? 'selected-correct' : 'selected-wrong');  
  if (!isCorrect) buttons[q.answer].classList.add('reveal-correct');  

  // æ›´æ–°streak  
  if (isCorrect) {  
    sessionCorrect++;  
    gameState.streak++;  
    if (gameState.streak > gameState.maxStreak) gameState.maxStreak = gameState.streak;  
    const bonus = Math.min(gameState.streak * 10, 100);  
    const pts = 100 + bonus;  
    sessionScore += pts;  
    gameState.totalScore += pts;  
    showToast(gameState.streak > 2 ? `âœ… æ­£ç¡®ï¼+${pts}åˆ† ğŸ”¥è¿èƒœ${gameState.streak}` : `âœ… æ­£ç¡®ï¼+${pts}åˆ†`);  
    // æ›´æ–°è¿›åº¦ç‚¹é¢œè‰²  
    const dot = document.getElementById(`dot_${currentQIndex}`);  
    if (dot) { dot.classList.remove('active'); dot.classList.add('correct'); }  
  } else {  
    gameState.streak = 0;  
    showToast('âŒ ç­”é”™äº†ï¼Œçœ‹çœ‹è§£æå§');  
    const dot = document.getElementById(`dot_${currentQIndex}`);  
    if (dot) { dot.classList.remove('active'); dot.classList.add('wrong'); }  
  }  

  saveState();  
  checkAchievements({ perfect: sessionCorrect === currentQuestions.length && sessionAnswered === currentQuestions.length });  

  // æ˜¾ç¤ºè§£æ  
  const exp = document.getElementById('qExplanation');  
  const expContent = document.getElementById('qExpContent');  
  if (exp && expContent) {  
    expContent.innerHTML = formatCode(q.explanation);  
    exp.style.display = 'block';  
  }  

  // æ˜¾ç¤ºnextæŒ‰é’®  
  const nb = document.getElementById('nextBtn');  
  if (nb) {  
    nb.style.display = 'block';  
    nb.textContent = currentQIndex < currentQuestions.length-1 ? 'ä¸‹ä¸€é¢˜ â†’' : 'æŸ¥çœ‹ç»“æœ ğŸ‰';  
  }  

  updateStatsBar();  
}  

// ============================================================  
//  ä¸‹ä¸€é¢˜  
// ============================================================  
function nextQuestion() {  
  currentQIndex++;  
  if (currentQIndex >= currentQuestions.length) {  
    showResult();  
  } else {  
    renderQuestion();  
  }  
}  

// ============================================================  
//  ç»“æœé¡µé¢  
// ============================================================  
function showResult() {  
  const total = currentQuestions.length;  
  const pct = Math.round(sessionCorrect / total * 100);  
  const level = ALL_WORLDS[currentWorldIndex].levels[currentLevelIndex];  

  // ä¿å­˜é€šå…³è®°å½•  
  if (!gameState.cleared[level.id] || (gameState.cleared[level.id].score || 0) < sessionScore) {  
    gameState.cleared[level.id] = { score: sessionScore, correct: sessionCorrect, total };  
  }  
  saveState();  
  checkAchievements({ perfect: sessionCorrect === total });  

  // é€‰æ‹©ç»“æœå›¾æ ‡å’Œæ–‡å­—  
  let icon, title, sub;  
  if (pct === 100) { icon='ğŸ†'; title='å®Œç¾é€šå…³ï¼'; sub='å…¨éƒ¨ç­”å¯¹ï¼ä½ æ˜¯çœŸæ­£çš„ä½æ“ä½œå¤§å¸ˆï¼'; }  
  else if (pct >= 75) { icon='â­'; title='ä¼˜ç§€ï¼'; sub=`${sessionCorrect}/${total} é¢˜æ­£ç¡®ï¼Œç»§ç»­ä¿æŒï¼`; }  
  else if (pct >= 50) { icon='ğŸ’ª'; title='è‰¯å¥½'; sub=`${sessionCorrect}/${total} é¢˜æ­£ç¡®ï¼Œè¿˜æœ‰æå‡ç©ºé—´ï¼`; }  
  else { icon='ğŸ“š'; title='éœ€è¦å¤ä¹ '; sub=`${sessionCorrect}/${total} é¢˜æ­£ç¡®ï¼Œå»ºè®®é‡è¯»çŸ¥è¯†ç‚¹å†æŒ‘æˆ˜ï¼`; }  

  document.getElementById('resultIcon').textContent = icon;  
  document.getElementById('resultTitle').textContent = title;  
  document.getElementById('resultSub').textContent = sub;  
  document.getElementById('resultScore').textContent = sessionScore.toLocaleString();  
  document.getElementById('resultScoreLabel').textContent =  
    `æœ¬å…³å¾—åˆ† Â· æ€»åˆ† ${gameState.totalScore.toLocaleString()} Â· è¿èƒœ ${gameState.streak}`;  

  // ä¸‹ä¸€å…³æŒ‰é’®  
  const world = ALL_WORLDS[currentWorldIndex];  
  const hasNext = currentLevelIndex < world.levels.length - 1;  
  const nextBtn = document.getElementById('btnNextLevel');  
  if (nextBtn) {
    const hasNextLevel = currentLevelIndex < world.levels.length - 1;
    const hasNextWorld = currentWorldIndex < ALL_WORLDS.length - 1;
    if (hasNextLevel) {
      nextBtn.style.display = 'inline-block';
      nextBtn.textContent = 'âš¡ ä¸‹ä¸€å…³';
    } else if (hasNextWorld) {
      nextBtn.style.display = 'inline-block';
      nextBtn.textContent = 'ğŸŒ ä¸‹ä¸€ä¸ªä¸–ç•Œ';
    } else {
      nextBtn.style.display = 'none';
    }
  }

  setScreen('result-screen');
  updateStatsBar();
}

// ============================================================
//  é‡è¯•å½“å‰å…³å¡
// ============================================================
function retryLevel() {
  startLevel(currentWorldIndex, currentLevelIndex);
}

// ============================================================
//  è·³è½¬ä¸‹ä¸€å…³ / ä¸‹ä¸€ä¸ªä¸–ç•Œ
// ============================================================
function goNextLevel() {
  const world = ALL_WORLDS[currentWorldIndex];
  if (currentLevelIndex < world.levels.length - 1) {
    // åŒä¸–ç•Œä¸‹ä¸€å…³
    startLevel(currentWorldIndex, currentLevelIndex + 1);
  } else if (currentWorldIndex < ALL_WORLDS.length - 1) {
    // è¿›å…¥ä¸‹ä¸€ä¸ªä¸–ç•Œçš„ç¬¬ä¸€å…³
    currentWorldIndex++;
    showLevelSelect(currentWorldIndex);
  }
}

// ============================================================
//  é€€å‡ºç¡®è®¤
// ============================================================
function confirmExit() {
  if (sessionAnswered === 0 || confirm('ç¡®å®šè¦é€€å‡ºå½“å‰å…³å¡å—ï¼Ÿæœ¬å±€è¿›åº¦å°†ä¸ä¼šä¿å­˜ã€‚')) {
    showLevelSelect(currentWorldIndex);
  }
}

// ============================================================
//  é”®ç›˜å¿«æ·é”®æ”¯æŒ
// ============================================================
document.addEventListener('keydown', (e) => {
  const screen = getActiveScreen();

  // ç­”é¢˜å¿«æ·é”® A/B/C/D
  if (screen === 'game-play' && !answeredThisQ) {
    const keyMap = { 'a': 0, 'b': 1, 'c': 2, 'd': 3 };
    const idx = keyMap[e.key.toLowerCase()];
    if (idx !== undefined) {
      const buttons = document.querySelectorAll('.option-btn');
      if (buttons[idx] && !buttons[idx].classList.contains('disabled')) {
        buttons[idx].click();
      }
    }
  }

  // Enter â†’ ä¸‹ä¸€é¢˜ / æŸ¥çœ‹ç»“æœ
  if (e.key === 'Enter') {
    const nb = document.getElementById('nextBtn');
    if (nb && nb.style.display !== 'none' && screen === 'game-play') {
      nb.click();
    }
  }

  // Escape â†’ é€€å‡ºå…³å¡ / è¿”å›åœ°å›¾
  if (e.key === 'Escape') {
    if (screen === 'game-play') confirmExit();
    else if (screen === 'level-select') showWorldMap();
    else if (screen === 'result-screen') showWorldMap();
  }
});

function getActiveScreen() {
  const screens = ['world-map', 'level-select', 'game-play', 'result-screen'];
  return screens.find(id => {
    const el = document.getElementById(id);
    return el && el.style.display !== 'none';
  }) || 'world-map';
}

// ============================================================
//  è¿›åº¦ç¯ç»˜åˆ¶ï¼ˆå¯é€‰UIç»„ä»¶ï¼Œä¾›ä¸–ç•Œå¡ç‰‡å†…åµŒä½¿ç”¨ï¼‰
// ============================================================
function createProgressRing(pct, color, size = 56) {
  const r = (size / 2) - 5;
  const circ = 2 * Math.PI * r;
  const offset = circ * (1 - pct / 100);
  return `
    <div class="progress-ring" style="width:${size}px;height:${size}px;">
      <svg width="${size}" height="${size}">
        <circle class="ring-bg" cx="${size/2}" cy="${size/2}" r="${r}"/>
        <circle class="ring-fill"
          cx="${size/2}" cy="${size/2}" r="${r}"
          stroke="${color}"
          stroke-dasharray="${circ}"
          stroke-dashoffset="${offset}"/>
      </svg>
      <span class="ring-text" style="color:${color}">${pct}%</span>
    </div>
  `;
}

// ============================================================
//  åŠ¨æ€æ˜Ÿçº§è¯„å®šï¼ˆæŒ‰ç­”é¢˜æ­£ç¡®ç‡ï¼‰
// ============================================================
function calcStars(correct, total) {
  const pct = correct / total;
  if (pct === 1)   return 'â­â­â­';
  if (pct >= 0.75) return 'â­â­';
  if (pct >= 0.5)  return 'â­';
  return 'â˜†';
}

// ============================================================
//  å…¨å±€æ’è¡Œæ¦œï¼ˆlocalStorageæœ¬åœ°æ¨¡æ‹Ÿï¼‰
// ============================================================
const LEADERBOARD_KEY = 'bitmaster_lb_v1';

function getLeaderboard() {
  try {
    return JSON.parse(localStorage.getItem(LEADERBOARD_KEY)) || [];
  } catch { return []; }
}

function submitScore(name, score) {
  const lb = getLeaderboard();
  lb.push({ name: name || 'åŒ¿å', score, date: new Date().toLocaleDateString('zh-CN') });
  lb.sort((a, b) => b.score - a.score);
  const top = lb.slice(0, 10);
  try { localStorage.setItem(LEADERBOARD_KEY, JSON.stringify(top)); } catch {}
  return top;
}

function renderLeaderboard() {
  const lb = getLeaderboard();
  if (!lb.length) return '<p style="color:var(--text-muted);text-align:center;">æš‚æ— è®°å½•ï¼Œå¿«å»æŒ‘æˆ˜å§ï¼</p>';
  return lb.map((e, i) => `
    <div style="display:flex;justify-content:space-between;padding:10px 0;
      border-bottom:1px solid var(--border);font-size:.92em;">
      <span style="color:${i<3?'var(--accent-yellow)':'var(--text-muted)'}">
        ${['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'][i] || (i+1)+'.'}
      </span>
      <span>${e.name}</span>
      <span style="font-family:'Fira Code';color:var(--accent-cyan)">${e.score.toLocaleString()}</span>
      <span style="color:var(--text-muted)">${e.date}</span>
    </div>
  `).join('');
}

// ============================================================
//  æ¯æ—¥ä¸€é¢˜ç³»ç»Ÿï¼ˆåŸºäºæ—¥æœŸç§å­éšæœºé€‰é¢˜ï¼‰
// ============================================================
function getDailyQuestion() {
  const today = new Date();
  const seed = today.getFullYear() * 10000 + (today.getMonth()+1) * 100 + today.getDate();

  // æ”¶é›†æ‰€æœ‰é¢˜ç›®
  const allQuestions = [];
  ALL_WORLDS.forEach(w => w.levels.forEach(l => l.questions.forEach(q => {
    allQuestions.push({ world: w.title, level: l.name, ...q });
  })));

  const idx = seed % allQuestions.length;
  return allQuestions[idx];
}

function showDailyQuestion() {
  const q = getDailyQuestion();
  const modal = document.createElement('div');
  modal.style.cssText = `
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.7);z-index:9999;
    display:flex;align-items:center;justify-content:center;padding:20px;
  `;
  modal.innerHTML = `
    <div style="background:var(--bg-card);border-radius:20px;padding:30px;
      max-width:560px;width:100%;border:1px solid var(--accent-purple);
      box-shadow:0 0 40px rgba(139,92,246,0.2);">
      <div style="font-size:.8em;color:var(--accent-purple);text-transform:uppercase;
        letter-spacing:1px;margin-bottom:8px;">ğŸ“… æ¯æ—¥ä¸€é¢˜</div>
      <div style="font-size:.85em;color:var(--text-muted);margin-bottom:14px;">
        ${q.world} Â· ${q.level}
      </div>
      <div style="font-size:1.05em;line-height:1.7;margin-bottom:20px;">
        ${formatCode(q.text)}
      </div>
      <div id="dailyOpts" style="display:flex;flex-direction:column;gap:10px;"></div>
      <div id="dailyExp" style="display:none;background:rgba(139,92,246,0.08);
        border:1px solid rgba(139,92,246,0.25);border-radius:12px;
        padding:14px 18px;margin-top:16px;font-size:.9em;
        line-height:1.7;color:var(--text-secondary);"></div>
      <button onclick="this.closest('div[style]').remove()"
        style="margin-top:20px;padding:10px 28px;background:var(--bg-secondary);
        border:1px solid var(--border);border-radius:10px;color:var(--text-secondary);
        cursor:pointer;font-family:inherit;width:100%;">å…³é—­</button>
    </div>
  `;

  // å¡«å……é€‰é¡¹
  const optsEl = modal.querySelector('#dailyOpts');
  const expEl = modal.querySelector('#dailyExp');
  const letters = ['A','B','C','D'];
  let answered = false;

  q.options.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.style.cssText = `
      display:flex;align-items:center;gap:12px;background:rgba(255,255,255,0.03);
      border:1px solid var(--border);padding:12px 16px;border-radius:10px;
      cursor:pointer;color:var(--text-primary);font-size:.95em;
      font-family:inherit;text-align:left;transition:all 0.2s;
    `;
    btn.innerHTML = `
      <span style="width:30px;height:30px;display:flex;align-items:center;
        justify-content:center;background:rgba(255,255,255,0.06);
        border-radius:7px;font-family:'Fira Code';font-weight:700;flex-shrink:0">
        ${letters[i]}
      </span>
      <span>${formatCode(opt)}</span>
    `;
    btn.onclick = () => {
      if (answered) return;
      answered = true;
      const allBtns = optsEl.querySelectorAll('button');
      allBtns.forEach(b => b.style.pointerEvents = 'none');
      if (i === q.answer) {
        btn.style.background = 'rgba(16,185,129,0.12)';
        btn.style.borderColor = 'var(--accent-green)';
        showToast('âœ… æ¯æ—¥ä¸€é¢˜ç­”å¯¹äº†ï¼');
      } else {
        btn.style.background = 'rgba(239,68,68,0.12)';
        btn.style.borderColor = 'var(--accent-red)';
        allBtns[q.answer].style.background = 'rgba(16,185,129,0.08)';
        allBtns[q.answer].style.borderColor = 'var(--accent-green)';
        showToast('âŒ ç­”é”™äº†ï¼Œçœ‹çœ‹è§£æï¼');
      }
      expEl.style.display = 'block';
      expEl.innerHTML = '<strong style="color:var(--accent-purple)">ğŸ’¡ è§£æï¼š</strong><br>' + formatCode(q.explanation);
    };
    optsEl.appendChild(btn);
  });

  document.body.appendChild(modal);
}

// ============================================================
//  è®¾ç½®é¢æ¿ï¼ˆéŸ³æ•ˆã€åŠ¨ç”»å¼€å…³ï¼‰
// ============================================================
let settings = { sfx: true, animation: true };

function loadSettings() {
  try {
    const s = localStorage.getItem('bitmaster_settings');
    if (s) settings = { ...settings, ...JSON.parse(s) };
  } catch {}
}

function saveSettings() {
  try { localStorage.setItem('bitmaster_settings', JSON.stringify(settings)); } catch {}
}

function toggleSettings() {
  const existing = document.getElementById('settingsModal');
  if (existing) { existing.remove(); return; }

  const modal = document.createElement('div');
  modal.id = 'settingsModal';
  modal.style.cssText = `
    position:fixed;bottom:80px;right:20px;
    background:var(--bg-card);border:1px solid var(--border);
    border-radius:16px;padding:22px;z-index:9000;
    min-width:240px;box-shadow:0 8px 32px rgba(0,0,0,0.4);
  `;
  modal.innerHTML = `
    <div style="font-weight:700;margin-bottom:16px;font-size:1.05em">âš™ï¸ è®¾ç½®</div>
    <label style="display:flex;justify-content:space-between;align-items:center;
      margin-bottom:14px;cursor:pointer;font-size:.95em;">
      <span>éŸ³æ•ˆ</span>
      <input type="checkbox" id="sfxToggle" ${settings.sfx?'checked':''} 
        onchange="settings.sfx=this.checked;saveSettings()">
    </label>
    <label style="display:flex;justify-content:space-between;align-items:center;
      margin-bottom:14px;cursor:pointer;font-size:.95em;">
      <span>åŠ¨ç”»æ•ˆæœ</span>
      <input type="checkbox" id="animToggle" ${settings.animation?'checked':''} 
        onchange="settings.animation=this.checked;saveSettings()">
    </label>
    <hr style="border-color:var(--border);margin:14px 0">
    <button onclick="resetProgress()" style="width:100%;padding:10px;background:rgba(239,68,68,0.12);
      border:1px solid var(--accent-red);border-radius:10px;color:var(--accent-red);
      cursor:pointer;font-family:inherit;font-size:.9em;">ğŸ—‘ï¸ é‡ç½®æ‰€æœ‰è¿›åº¦</button>
    <button onclick="document.getElementById('settingsModal').remove()"
      style="width:100%;padding:10px;background:transparent;border:1px solid var(--border);
      border-radius:10px;color:var(--text-muted);cursor:pointer;
      font-family:inherit;font-size:.9em;margin-top:8px">å…³é—­</button>
  `;
  document.body.appendChild(modal);
}

function resetProgress() {
  if (confirm('âš ï¸ ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰è¿›åº¦å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
    localStorage.removeItem(STATE_KEY);
    gameState = { totalScore:0, cleared:{}, streak:0, maxStreak:0, achievements:{} };
    document.getElementById('settingsModal')?.remove();
    showWorldMap();
    showToast('âœ… è¿›åº¦å·²é‡ç½®');
  }
}

// ============================================================
//  æ‚¬æµ®å·¥å…·æ ï¼ˆå³ä¸‹è§’å¿«æ·æŒ‰é’®ï¼‰
// ============================================================
function createFloatingToolbar() {
  const toolbar = document.createElement('div');
  toolbar.style.cssText = `
    position:fixed;bottom:20px;right:20px;
    display:flex;flex-direction:column;gap:10px;z-index:8000;
  `;

  const buttons = [
    { icon:'ğŸ“…', tip:'æ¯æ—¥ä¸€é¢˜', fn: showDailyQuestion },
    { icon:'âš™ï¸', tip:'è®¾ç½®',     fn: toggleSettings },
    { icon:'ğŸ ', tip:'è¿”å›ä¸»é¡µ', fn: showWorldMap },
  ];

  buttons.forEach(({ icon, tip, fn }) => {
    const btn = document.createElement('button');
    btn.title = tip;
    btn.textContent = icon;
    btn.style.cssText = `
      width:42px;height:42px;border-radius:50%;
      background:var(--bg-card);border:1px solid var(--border);
      font-size:1.25em;cursor:pointer;transition:all 0.2s;
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 2px 12px rgba(0,0,0,0.3);
    `;
    btn.onmouseenter = () => { btn.style.transform='scale(1.15)'; btn.style.borderColor='var(--accent-cyan)'; };
    btn.onmouseleave = () => { btn.style.transform='scale(1)'; btn.style.borderColor='var(--border)'; };
    btn.onclick = fn;
    toolbar.appendChild(btn);
  });

  document.body.appendChild(toolbar);
}

// ============================================================
//  æœç´¢é¢˜ç›®ï¼ˆæŒ‰å…³é”®è¯é«˜äº®å®šä½ï¼‰
// ============================================================
function searchLevels(keyword) {
  if (!keyword.trim()) return [];
  const kw = keyword.toLowerCase();
  const results = [];
  ALL_WORLDS.forEach((w, wi) => {
    w.levels.forEach((l, li) => {
      const match =
        l.name.toLowerCase().includes(kw) ||
        l.formula.toLowerCase().includes(kw) ||
        l.tag.toLowerCase().includes(kw) ||
        l.questions.some(q => q.text.toLowerCase().includes(kw));
      if (match) results.push({ world: w, worldIndex: wi, level: l, levelIndex: li });
    });
  });
  return results;
}

// ============================================================
//  ä¸»é¢˜åˆ‡æ¢ï¼ˆæ˜/æš—ï¼‰
// ============================================================
let isDark = true;

function toggleTheme() {
  isDark = !isDark;
  if (!isDark) {
    document.documentElement.style.setProperty('--bg-primary', '#f0f4f8');
    document.documentElement.style.setProperty('--bg-card', '#ffffff');
    document.documentElement.style.setProperty('--bg-secondary', '#e8edf4');
    document.documentElement.style.setProperty('--text-primary', '#1e293b');
    document.documentElement.style.setProperty('--text-secondary', '#475569');
    document.documentElement.style.setProperty('--text-muted', '#94a3b8');
    document.documentElement.style.setProperty('--border', '#e2e8f0');
  } else {
    document.documentElement.style.setProperty('--bg-primary', '#0a0e1a');
    document.documentElement.style.setProperty('--bg-card', '#1a2235');
    document.documentElement.style.setProperty('--bg-secondary', '#111827');
    document.documentElement.style.setProperty('--text-primary', '#f1f5f9');
    document.documentElement.style.setProperty('--text-secondary', '#94a3b8');
    document.documentElement.style.setProperty('--text-muted', '#64748b');
    document.documentElement.style.setProperty('--border', '#1e293b');
  }
  showToast(isDark ? 'ğŸŒ™ å·²åˆ‡æ¢æ·±è‰²ä¸»é¢˜' : 'â˜€ï¸ å·²åˆ‡æ¢æµ…è‰²ä¸»é¢˜');
}

// ============================================================
//  éŸ³æ•ˆç³»ç»Ÿï¼ˆWeb Audio APIï¼Œæ— éœ€å¤–éƒ¨æ–‡ä»¶ï¼‰
// ============================================================
let audioCtx = null;

function getAudioCtx() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  return audioCtx;
}

function playSound(type) {
  if (!settings.sfx) return;
  try {
    const ctx = getAudioCtx();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain);
    gain.connect(ctx.destination);

    const configs = {
      correct:  { type:'sine',     freq:880, dur:0.15, vol:0.15 },
      wrong:    { type:'sawtooth', freq:200, dur:0.25, vol:0.10 },
      levelup:  { type:'sine',     freq:1046,dur:0.4,  vol:0.12 },
      click:    { type:'sine',     freq:440, dur:0.08, vol:0.08 },
    };
    const cfg = configs[type] || configs.click;

    osc.type = cfg.type;
    osc.frequency.setValueAtTime(cfg.freq, ctx.currentTime);
    gain.gain.setValueAtTime(cfg.vol, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + cfg.dur);
    osc.start(ctx.currentTime);
    osc.stop(ctx.currentTime + cfg.dur);

    if (type === 'levelup') {
      // å’Œå¼¦æ•ˆæœ
      const osc2 = ctx.createOscillator();
      const gain2 = ctx.createGain();
      osc2.connect(gain2); gain2.connect(ctx.destination);
      osc2.type = 'sine';
      osc2.frequency.setValueAtTime(1318, ctx.currentTime + 0.15);
      gain2.gain.setValueAtTime(0.10, ctx.currentTime + 0.15);
      gain2.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.55);
      osc2.start(ctx.currentTime + 0.15);
      osc2.stop(ctx.currentTime + 0.55);
    }
  } catch (e) {
    // éŸ³é¢‘APIä¸å¯ç”¨æ—¶é™é»˜å¿½ç•¥
  }
}

// ============================================================
//  çƒŸèŠ±/ç²’å­åº†ç¥æ•ˆæœï¼ˆç­”å¯¹æ—¶è§¦å‘ï¼‰
// ============================================================
function spawnConfetti(x, y) {
  if (!settings.animation) return;
  const colors = ['#3b82f6','#10b981','#f59e0b','#ec4899','#8b5cf6','#06b6d4'];
  for (let i = 0; i < 18; i++) {
    const dot = document.createElement('div');
    const angle = (Math.PI * 2 / 18) * i;
    const dist = 60 + Math.random() * 60;
    const dx = Math.cos(angle) * dist;
    const dy = Math.sin(angle) * dist;
    dot.style.cssText = `
      position:fixed;
      left:${x}px;top:${y}px;
      width:${4+Math.random()*5}px;height:${4+Math.random()*5}px;
      background:${colors[Math.floor(Math.random()*colors.length)]};
      border-radius:50%;
      pointer-events:none;z-index:99999;
      transition:all ${0.5+Math.random()*0.4}s ease-out;
      transform:translate(-50%,-50%);
    `;
    document.body.appendChild(dot);
    requestAnimationFrame(() => {
      dot.style.transform = `translate(calc(-50% + ${dx}px), calc(-50% + ${dy}px)) scale(0)`;
      dot.style.opacity = '0';
    });
    setTimeout(() => dot.remove(), 1000);
  }
}

// é‡å†™ selectAnswer ä»¥é›†æˆéŸ³æ•ˆå’Œç²’å­
const _origSelectAnswer = selectAnswer;
window.selectAnswer = function(index, q) {
  _origSelectAnswer(index, q);
  const isCorrect = index === q.answer;
  playSound(isCorrect ? 'correct' : 'wrong');
  if (isCorrect) {
    // æ‰¾åˆ°ç‚¹å‡»çš„æŒ‰é’®ä½ç½®è§¦å‘ç²’å­
    const buttons = document.querySelectorAll('.option-btn');
    if (buttons[index]) {
      const rect = buttons[index].getBoundingClientRect();
      spawnConfetti(rect.left + rect.width/2, rect.top + rect.height/2);
    }
    // æ»¡åˆ†æ—¶é¢å¤–åº†ç¥
    if (sessionCorrect === currentQuestions.length) {
      setTimeout(() => playSound('levelup'), 300);
    }
  }
};

// ============================================================
//  PWA Service Worker æ³¨å†Œï¼ˆå¯é€‰ç¦»çº¿ç¼“å­˜ï¼‰
// ============================================================
function registerSW() {
  if ('serviceWorker' in navigator) {
    // è‹¥æœ‰sw.jsæ–‡ä»¶åˆ™æ³¨å†Œï¼Œå¦åˆ™é™é»˜è·³è¿‡
    navigator.serviceWorker.register('./sw.js').catch(() => {});
  }
}

// ============================================================
//  é¡µé¢å¯è§æ€§API â€” ç¦»å¼€æ—¶è‡ªåŠ¨æš‚åœå€’è®¡æ—¶ï¼ˆè‹¥æœ‰ï¼‰
// ============================================================
document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    // æš‚åœä»»ä½•è®¡æ—¶å™¨
    saveState();
  }
});

// ============================================================
//  çª—å£å¸è½½å‰ä¿å­˜çŠ¶æ€
// ============================================================
window.addEventListener('beforeunload', saveState);

// ============================================================
//  å“åº”å¼æ–­ç‚¹ç›‘å¬
// ============================================================
const mq = window.matchMedia('(max-width: 600px)');
function onBreakpoint(e) {
  if (e.matches) {
    // ç§»åŠ¨ç«¯: å‡å°‘æµ®åŠ¨ç²’å­æ•°é‡
    document.querySelectorAll('#floatingBits span').forEach((s, i) => {
      if (i > 10) s.style.display = 'none';
    });
  }
}
mq.addEventListener('change', onBreakpoint);
onBreakpoint(mq);

// ============================================================
//  é¦–æ¬¡è®¿é—®å¼•å¯¼æç¤º
// ============================================================
function showWelcomeGuide() {
  const visited = localStorage.getItem('bitmaster_visited');
  if (visited) return;
  localStorage.setItem('bitmaster_visited', '1');

  setTimeout(() => {
    const guide = document.createElement('div');
    guide.style.cssText = `
      position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
      background:var(--bg-card);border:1px solid var(--accent-blue);
      border-radius:20px;padding:36px;max-width:460px;width:90%;
      z-index:99998;text-align:center;
      box-shadow:0 0 60px rgba(59,130,246,0.25);
    `;
    guide.innerHTML = `
      <div style="font-size:3em;margin-bottom:16px">âš¡</div>
      <h2 style="font-size:1.6em;margin-bottom:10px">æ¬¢è¿æ¥åˆ°ä½æ“ä½œå¤§å¸ˆï¼</h2>
      <p style="color:var(--text-secondary);line-height:1.7;margin-bottom:24px">
        æœ¬æ¸¸æˆåŒ…å« <strong style="color:var(--accent-cyan)">10ä¸ªä¸–ç•Œ Â· 55+å…³å¡</strong>ï¼Œ
        æ¶µç›–ä½æ“ä½œæ‰€æœ‰æ ¸å¿ƒæŠ€å·§ã€‚<br><br>
        ğŸ’¡ <strong>ä½¿ç”¨æŠ€å·§</strong><br>
        Â· æŒ‰ <code style="background:rgba(59,130,246,0.15);padding:2px 6px;border-radius:4px">A/B/C/D</code> é”®å¿«é€Ÿé€‰ç­”<br>
        Â· æŒ‰ <code style="background:rgba(59,130,246,0.15);padding:2px 6px;border-radius:4px">Enter</code> è¿›å…¥ä¸‹ä¸€é¢˜<br>
        Â· ç‚¹å‡»å³ä¸‹è§’ ğŸ“… æŸ¥çœ‹æ¯æ—¥ä¸€é¢˜<br>
        Â· è¿ç»­ç­”å¯¹å¯è·å¾—è¿èƒœåŠ åˆ†ï¼
      </p>
      <button onclick="this.parentElement.remove()"
        style="padding:14px 40px;background:linear-gradient(135deg,var(--accent-blue),var(--accent-cyan));
        border:none;border-radius:12px;color:#fff;font-size:1.05em;font-weight:700;
        cursor:pointer;font-family:inherit;width:100%">
        ğŸš€ å¼€å§‹æŒ‘æˆ˜ï¼
      </button>
    `;
    document.body.appendChild(guide);
  }, 800);
}

// ============================================================
//  é”™é¢˜æœ¬ç³»ç»Ÿï¼ˆè‡ªåŠ¨è®°å½•ç­”é”™çš„é¢˜ç›®ï¼‰
// ============================================================
const MISTAKES_KEY = 'bitmaster_mistakes_v1';
let mistakeBook = [];

function loadMistakes() {
  try {
    mistakeBook = JSON.parse(localStorage.getItem(MISTAKES_KEY)) || [];
  } catch { mistakeBook = []; }
}

function saveMistakeEntry(worldTitle, levelName, question) {
  const entry = {
    id: Date.now(),
    world: worldTitle,
    level: levelName,
    question: question.text,
    options: question.options,
    answer: question.answer,
    explanation: question.explanation,
    date: new Date().toLocaleDateString('zh-CN')
  };
  // å»é‡ï¼ˆåŒé¢˜ç›®ä¸é‡å¤æ·»åŠ ï¼‰
  const exists = mistakeBook.some(m => m.question === entry.question);
  if (!exists) {
    mistakeBook.unshift(entry);
    if (mistakeBook.length > 50) mistakeBook = mistakeBook.slice(0, 50); // æœ€å¤šä¿ç•™50æ¡
    try { localStorage.setItem(MISTAKES_KEY, JSON.stringify(mistakeBook)); } catch {}
  }
}

function showMistakeBook() {
  loadMistakes();
  const modal = document.createElement('div');
  modal.style.cssText = `
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.75);z-index:9999;
    display:flex;align-items:center;justify-content:center;padding:16px;
    overflow-y:auto;
  `;

  const content = mistakeBook.length === 0
    ? '<p style="color:var(--text-muted);text-align:center;padding:20px">æš‚æ— é”™é¢˜ï¼Œç»§ç»­åŠ æ²¹ï¼âœ¨</p>'
    : mistakeBook.map((m, i) => `
        <div style="background:var(--bg-secondary);border-radius:12px;
          padding:16px;margin-bottom:12px;border:1px solid var(--border);">
          <div style="font-size:.75em;color:var(--text-muted);margin-bottom:6px">
            ğŸ“ ${m.world} Â· ${m.level} Â· ${m.date}
          </div>
          <div style="font-size:.95em;line-height:1.6;margin-bottom:10px">
            ${formatCode(m.question)}
          </div>
          <div style="font-size:.85em;color:var(--accent-green);margin-bottom:6px">
            âœ… æ­£ç¡®ç­”æ¡ˆ: ${['A','B','C','D'][m.answer]}. ${formatCode(m.options[m.answer])}
          </div>
          <div style="font-size:.83em;color:var(--text-secondary);line-height:1.6;
            background:rgba(139,92,246,0.08);padding:10px;border-radius:8px">
            ğŸ’¡ ${formatCode(m.explanation)}
          </div>
        </div>
      `).join('');

  modal.innerHTML = `
    <div style="background:var(--bg-card);border-radius:20px;padding:28px;
      max-width:600px;width:100%;border:1px solid var(--border);max-height:80vh;overflow-y:auto;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
        <h3 style="font-size:1.2em">ğŸ“’ é”™é¢˜æœ¬ï¼ˆ${mistakeBook.length} é¢˜ï¼‰</h3>
        <button onclick="this.closest('div[style*=fixed]').remove()"
          style="background:transparent;border:none;color:var(--text-muted);
          font-size:1.4em;cursor:pointer">âœ•</button>
      </div>
      ${content}
    </div>
  `;
  document.body.appendChild(modal);
}

// åœ¨ç­”é”™æ—¶è‡ªåŠ¨è®°å½•åˆ°é”™é¢˜æœ¬
const __origSelect = window.selectAnswer;
window.selectAnswer = function(index, q) {
  __origSelect(index, q);
  if (index !== q.answer) {
    const world = ALL_WORLDS[currentWorldIndex];
    const level = world.levels[currentLevelIndex];
    saveMistakeEntry(world.title, level.name, q);
  }
};

// ============================================================
//  ç»éªŒå€¼ & ç­‰çº§ç³»ç»Ÿ
// ============================================================
const RANKS = [
  { name:'é“ç‰Œè§ä¹ ',  icon:'ğŸª¨', min:0     },
  { name:'é’é“œå­¦å¾’',  icon:'ğŸ¥‰', min:500   },
  { name:'ç™½é“¶ç¨‹åºå‘˜',icon:'ğŸ¥ˆ', min:1500  },
  { name:'é»„é‡‘å·¥ç¨‹å¸ˆ',icon:'ğŸ¥‡', min:3500  },
  { name:'é“‚é‡‘ä¸“å®¶',  icon:'ğŸ’', min:7000  },
  { name:'é’»çŸ³å¤§å¸ˆ',  icon:'ğŸ’ ', min:12000 },
  { name:'ç‹è€…å¤§å®—å¸ˆ',icon:'ğŸ‘‘', min:20000 },
];

function getRank(score) {
  let rank = RANKS[0];
  for (const r of RANKS) {
    if (score >= r.min) rank = r;
  }
  return rank;
}

function getNextRank(score) {
  for (const r of RANKS) {
    if (score < r.min) return r;
  }
  return null;
}

function renderRankBadge() {
  const rank = getRank(gameState.totalScore);
  const next = getNextRank(gameState.totalScore);
  const pct = next
    ? Math.round((gameState.totalScore - rank.min) / (next.min - rank.min) * 100)
    : 100;

  return `
    <div style="display:flex;align-items:center;gap:12px;padding:14px 20px;
      background:var(--bg-card);border-radius:14px;border:1px solid var(--border);
      margin-bottom:16px;">
      <span style="font-size:2em">${rank.icon}</span>
      <div style="flex:1">
        <div style="font-weight:700;font-size:1.05em">${rank.name}</div>
        <div style="font-size:.78em;color:var(--text-muted);margin:3px 0">
          ${next ? `è· ${next.icon}${next.name} è¿˜éœ€ ${next.min - gameState.totalScore} åˆ†` : 'ğŸ‰ å·²è¾¾æœ€é«˜ç­‰çº§ï¼'}
        </div>
        <div style="height:5px;background:rgba(255,255,255,0.07);border-radius:3px;overflow:hidden">
          <div style="height:100%;width:${pct}%;background:linear-gradient(90deg,var(--accent-yellow),var(--accent-orange));border-radius:3px;transition:width 0.5s"></div>
        </div>
      </div>
      <span style="font-family:'Fira Code';color:var(--accent-yellow);font-size:1.1em;font-weight:700">
        ${gameState.totalScore.toLocaleString()}
      </span>
    </div>
  `;
}

// ============================================================
//  æ¸¸æˆåˆå§‹åŒ–å…¥å£
// ============================================================
function initGame() {
  loadState();
  loadSettings();
  loadMistakes();
  initFloatingBits();
  createFloatingToolbar();
  registerSW();
  showWelcomeGuide();
  showWorldMap();

  // å°†é”™é¢˜æœ¬æŒ‰é’®åŠ å…¥å·¥å…·æ 
  const toolbar = document.querySelector('div[style*="flex-direction:column"]');
  if (toolbar) {
    const mbBtn = document.createElement('button');
    mbBtn.title = 'é”™é¢˜æœ¬';
    mbBtn.textContent = 'ğŸ“’';
    mbBtn.style.cssText = `
      width:42px;height:42px;border-radius:50%;
      background:var(--bg-card);border:1px solid var(--border);
      font-size:1.25em;cursor:pointer;transition:all 0.2s;
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 2px 12px rgba(0,0,0,0.3);
    `;
    mbBtn.onmouseenter = () => { mbBtn.style.transform='scale(1.15)'; mbBtn.style.borderColor='var(--accent-cyan)'; };
    mbBtn.onmouseleave = () => { mbBtn.style.transform='scale(1)'; mbBtn.style.borderColor='var(--border)'; };
    mbBtn.onclick = showMistakeBook;
    toolbar.insertBefore(mbBtn, toolbar.firstChild);
  }
}

// DOMåŠ è½½å®Œæˆåå¯åŠ¨
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initGame);
} else {
  initGame();
}
</script>
</body>
</html>