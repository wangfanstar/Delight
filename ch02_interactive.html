<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hacker's Delight Chapter 02 - åŠ¨ç”»äº¤äº’å­¦ä¹ ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: slideDown 0.8s ease-out;
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
            font-weight: 700;
        }

        .header p {
            font-size: 1.15em;
            opacity: 0.95;
            margin: 5px 0;
        }

        .header .subtitle {
            font-size: 0.95em;
            opacity: 0.85;
            font-style: italic;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            border-radius: 10px;
            width: 0%;
            animation: fill 1s ease-out forwards;
        }

        .section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            animation: fadeInUp 0.7s ease-out;
        }

        .section-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .section-title {
            font-size: 2.2em;
            color: #667eea;
            margin: 15px 0 25px 0;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-title-emoji {
            font-size: 1.5em;
        }

        .core-insight {
            background: linear-gradient(135deg, rgba(102,126,234,0.08) 0%, rgba(118,75,162,0.08) 100%);
            border-left: 5px solid #667eea;
            border-radius: 8px;
            padding: 20px 25px;
            margin: 25px 0;
            line-height: 1.8;
            font-size: 1.05em;
        }

        .core-insight strong {
            color: #667eea;
            font-weight: 600;
        }

        .highlight {
            background: linear-gradient(120deg, #fff9c4 0%, #ffe082 100%);
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(255, 193, 7, 0.3);
        }

        .tricks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .trick-card {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .trick-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            animation: slideRight 0.6s ease-out forwards;
        }

        .trick-card:hover {
            transform: translateY(-8px) translateX(4px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.25);
            border-color: #667eea;
        }

        .trick-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 15px;
        }

        .trick-icon {
            font-size: 2em;
            flex-shrink: 0;
        }

        .trick-number {
            background: #667eea;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
            flex-shrink: 0;
        }

        .trick-title {
            font-size: 1.15em;
            font-weight: 600;
            color: #333;
            flex: 1;
        }

        .trick-formula {
            background: #f5f5f5;
            border-left: 4px solid #667eea;
            padding: 12px 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            color: #d63031;
            margin: 15px 0;
            word-break: break-word;
            font-weight: 500;
        }

        .trick-desc {
            color: #666;
            line-height: 1.7;
            font-size: 0.95em;
            margin-bottom: 12px;
        }

        .bit-visual {
            display: flex;
            gap: 3px;
            margin: 15px 0;
            justify-content: flex-start;
            flex-wrap: wrap;
        }

        .bit {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            color: white;
            font-size: 0.8em;
            font-weight: bold;
            font-family: monospace;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .bit.one {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .bit.zero {
            background: #ddd;
            color: #999;
        }

        .example {
            background: #f9f9f9;
            border: 1px solid #eee;
            padding: 12px;
            border-radius: 6px;
            margin: 12px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #2d3436;
            line-height: 1.6;
        }

        .example-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 6px;
        }

        .badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            margin: 5px 5px 5px 0;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .badge.critical {
            background: linear-gradient(135deg, #d63031, #ee5a6f);
        }

        .badge.expert {
            background: linear-gradient(135deg, #764ba2, #9b59b6);
        }

        .badge.optimization {
            background: linear-gradient(135deg, #00b894, #55efc4);
            color: #fff;
        }

        .identities-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 0.95em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border-radius: 8px;
            overflow: hidden;
        }

        .identities-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            border: none;
        }

        .identities-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            vertical-align: top;
        }

        .identities-table tr:hover {
            background: #f9f9f9;
        }

        .identities-table code {
            background: #f5f5f5;
            padding: 4px 10px;
            border-radius: 4px;
            color: #d63031;
            font-family: 'Courier New', monospace;
            font-weight: 500;
        }

        .mnemonic {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px 30px;
            border-radius: 12px;
            margin: 25px 0;
            font-size: 1.05em;
            line-height: 2;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            border-left: 5px solid white;
        }

        .mnemonic strong {
            font-weight: 600;
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 4px;
        }

        .interactive-demo {
            background: #f9f9f9;
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
        }

        .demo-title {
            font-size: 1.15em;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 15px;
        }

        .bit-input-group {
            display: flex;
            gap: 8px;
            margin: 15px 0;
            flex-wrap: wrap;
            align-items: center;
        }

        .bit-input {
            display: flex;
            gap: 3px;
        }

        .bit-toggle {
            width: 40px;
            height: 40px;
            border: 2px solid #667eea;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-family: monospace;
            transition: all 0.2s ease;
            font-size: 0.95em;
        }

        .bit-toggle:hover {
            background: #f0f0f0;
            transform: scale(1.05);
        }

        .bit-toggle.active {
            background: #667eea;
            color: white;
        }

        .result-display {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 0.9em;
            border-left: 4px solid #667eea;
        }

        .result-label {
            color: #667eea;
            font-weight: bold;
        }

        .result-value {
            color: #d63031;
            font-weight: bold;
        }

        /* äº¤äº’æ¼”ç¤ºç»“æœå¹¶åˆ—æ˜¾ç¤º */
        .results-inline {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .gosper-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }

        .gosper-item {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-family: monospace;
            font-weight: bold;
            font-size: 0.9em;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        .gosper-item:nth-child(odd) {
            animation-delay: 0s;
        }

        .gosper-item:nth-child(even) {
            animation-delay: 0.2s;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px 0;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }

        .comparison-box {
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #ddd;
        }

        .comparison-box.wrong {
            background: #fff3f3;
            border-color: #d63031;
        }

        .comparison-box.wrong .box-title {
            color: #d63031;
        }

        .comparison-box.correct {
            background: #f3fff3;
            border-color: #00b894;
        }

        .comparison-box.correct .box-title {
            color: #00b894;
        }

        .box-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 12px;
        }

        .comparison-box code {
            display: block;
            background: white;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            color: #333;
            margin-top: 10px;
        }

        .timeline {
            position: relative;
            padding: 20px 0 20px 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, #667eea, #764ba2);
        }

        .timeline-item {
            padding: 20px;
            margin-bottom: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -15px;
            top: 25px;
            width: 10px;
            height: 10px;
            background: #667eea;
            border-radius: 50%;
            border: 3px solid white;
        }

        .timeline-year {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .timeline-text {
            color: #666;
            line-height: 1.6;
        }

        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            margin: 8px 8px 8px 0;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background: #f0f0f0;
            color: #667eea;
            border: 2px solid #667eea;
        }

        button.secondary:hover {
            background: #667eea;
            color: white;
        }

        .info-card {
            background: linear-gradient(135deg, rgba(102,126,234,0.1), rgba(118,75,162,0.1));
            border-left: 5px solid #667eea;
            padding: 18px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 0.95em;
            line-height: 1.7;
        }

        .info-card strong {
            color: #667eea;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideRight {
            to {
                left: 100%;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes fill {
            from {
                width: 0%;
            }
            to {
                width: 100%;
            }
        }

        .footer {
            text-align: center;
            color: white;
            padding: 30px 20px;
            margin-top: 50px;
        }

        .footer p {
            margin: 8px 0;
            opacity: 0.9;
        }

        .footer .source {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .section {
                padding: 25px;
            }

            .section-title {
                font-size: 1.8em;
            }

            .tricks-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2em;
            }

            .identities-table {
                font-size: 0.85em;
            }

            .identities-table td,
            .identities-table th {
                padding: 10px;
            }
        }

        @media print {
            body {
                background: white;
            }

            .section {
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ ‡é¢˜ -->
        <div class="header">
            <h1>ğŸ¯ Hacker's Delight</h1>
            <p>Chapter 02: åŸºç¡€æŠ€å·§ - ä½æ“ä½œçš„20æŠŠé‡‘é’¥åŒ™</p>
            <p class="subtitle">åŠ¨ç”»äº¤äº’å­¦ä¹ ç‰ˆ | ä»0åˆ°ç²¾é€šä½è¿ç®—</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>

        <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šæœ€å³ä½æ“çºµ -->
        <div class="section">
            <div class="section-number">1</div>
            <div class="section-title">
                <span class="section-title-emoji">ğŸ”§</span>
                æœ€å³ä½æ“çºµ - Manipulating Rightmost Bits
            </div>

            <div class="core-insight">
                <strong>ğŸ’¡ æ ¸å¿ƒæ´å¯Ÿï¼š</strong>
                è¡¥ç çš„ç¥å¥‡æ€§è´¨â€”â€”<span class="highlight">x - 1</span> ä¼šæŠŠæœ€ä½ä½çš„1æ¸…é›¶ï¼Œå¹¶æŠŠå…¶å³è¾¹æ‰€æœ‰0å˜æˆ1ï¼›
                <span class="highlight">x + 1</span> ä¼šæŠŠæœ€ä½ä½çš„0ç½®1ï¼Œå¹¶æŠŠå…¶å³è¾¹æ‰€æœ‰1å˜æˆ0ã€‚
                åˆ©ç”¨è¿™ä¸¤ä¸ª"çº§è”ç¿»è½¬"æ€§è´¨ï¼Œå¯ä»¥ç²¾ç¡®æ“çºµä»»æ„ä¸€ä½ï¼Œè€Œå®Œå…¨ä¸ç”¨æ¡ä»¶è·³è½¬ï¼
            </div>

            <div class="tricks-grid">
                <!-- TRICK 01 -->
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ¯</span>
                        <span class="trick-number">01</span>
                        <span class="trick-title">æ¸…é™¤æœ€å³è¾¹çš„1</span>
                    </div>
                    <div class="trick-formula">x & (x - 1)</div>
                    <div class="trick-desc">å°†æœ€ä½ä½çš„1å˜ä¸º0ï¼Œå…¶ä½™ä¸å˜ã€‚</div>
                    <div class="bit-visual">
                        <div class="bit one">0</div>
                        <div class="bit one">1</div>
                        <div class="bit one">0</div>
                        <div class="bit one">1</div>
                        <div class="bit one">1</div>
                        <div class="bit zero">0</div>
                        <div class="bit zero">0</div>
                        <div class="bit zero">0</div>
                    </div>
                    <div class="example">
                        <div class="example-title">ä¾‹å­ï¼š01011000 â†’ 01010000</div>
                        âœ¨ <strong>å…³é”®ç”¨é€”</strong>ï¼šåˆ¤æ–­2çš„å¹‚<br>
                        (x & (x-1)) == 0 âŸ¹ xæ˜¯2çš„å¹‚
                    </div>
                    <span class="badge critical">é«˜é¢‘ä½¿ç”¨</span>
                </div>

                <!-- TRICK 02 -->
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ“</span>
                        <span class="trick-number">02</span>
                        <span class="trick-title">ç½®ä½æœ€å³è¾¹çš„0</span>
                    </div>
                    <div class="trick-formula">x | (x + 1)</div>
                    <div class="trick-desc">å°†æœ€ä½ä½çš„0å˜ä¸º1ï¼Œå…¶ä½™ä¸å˜ã€‚</div>
                    <div class="example">
                        <div class="example-title">ä¾‹å­ï¼š10100111 â†’ 10101111</div>
                    </div>
                </div>

                <!-- TRICK 03 -->
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ”š</span>
                        <span class="trick-number">03</span>
                        <span class="trick-title">æ¸…é™¤å°¾éƒ¨è¿ç»­çš„1</span>
                    </div>
                    <div class="trick-formula">x & (x + 1)</div>
                    <div class="trick-desc">å°†æœ«å°¾è¿ç»­çš„1å…¨éƒ¨æ¸…é›¶ã€‚</div>
                    <div class="example">
                        <div class="example-title">ä¾‹å­ï¼š10100111 â†’ 10100000</div>
                        âœ¨ åˆ¤æ–­ 2â¿-1 å½¢å¼: (x & (x+1)) == 0
                    </div>
                </div>

                <!-- TRICK 04 -->
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ“</span>
                        <span class="trick-number">04</span>
                        <span class="trick-title">ç½®ä½å°¾éƒ¨è¿ç»­çš„0</span>
                    </div>
                    <div class="trick-formula">x | (x - 1)</div>
                    <div class="trick-desc">å°†æœ«å°¾è¿ç»­çš„0å…¨éƒ¨ç½®1ã€‚</div>
                    <div class="example">
                        <div class="example-title">ä¾‹å­ï¼š10101000 â†’ 10101111</div>
                    </div>
                </div>

                <!-- TRICK 05 -->
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ”</span>
                        <span class="trick-number">05</span>
                        <span class="trick-title">æœ€å³è¾¹çš„0æ©ç </span>
                    </div>
                    <div class="trick-formula">~x & (x + 1)</div>
                    <div class="trick-desc">åœ¨æœ€ä½ä½0å¤„äº§ç”Ÿå•ä¸ª1ã€‚</div>
                    <div class="example">
                        <div class="example-title">ä¾‹å­ï¼š10100111 â†’ 00001000</div>
                    </div>
                </div>

                <!-- TRICK 06 -->
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">âœ¨</span>
                        <span class="trick-number">06</span>
                        <span class="trick-title">æœ€å³è¾¹çš„1æ©ç  (LSB)</span>
                    </div>
                    <div class="trick-formula">x & (-x)</div>
                    <div class="trick-desc">åªä¿ç•™æœ€ä½ä½çš„1ï¼Œå…¶ä½™æ¸…é›¶ã€‚</div>
                    <div class="example">
                        <div class="example-title">ä¾‹å­ï¼š01011000 â†’ 00001000</div>
                        ğŸ“Š <strong>ç‹ç‰Œç”¨é€”</strong>ï¼š<br>
                        â€¢ æ£‹ç›˜å¼•æ“ bitboard<br>
                        â€¢ å¸ƒéš†è¿‡æ»¤å™¨<br>
                        â€¢ Kernighan ä½è®¡æ•°
                    </div>
                    <span class="badge critical">â˜…â˜…â˜… å…³é”®</span>
                </div>

                <!-- TRICK 07 -->
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ­</span>
                        <span class="trick-number">07</span>
                        <span class="trick-title">å°¾éƒ¨0çš„æ©ç </span>
                    </div>
                    <div class="trick-formula">~x & (x - 1)</div>
                    <div class="trick-desc">åœ¨æ‰€æœ‰å°¾éƒ¨0çš„ä½ç½®äº§ç”Ÿ1ã€‚</div>
                    <div class="example">
                        <div class="example-title">ä¾‹å­ï¼š01011000 â†’ 00000111</div>
                    </div>
                </div>

                <!-- TRICK 08 -->
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸŒŠ</span>
                        <span class="trick-number">08</span>
                        <span class="trick-title">å°¾éƒ¨1å³å¯¹é½ä¼ æ’­</span>
                    </div>
                    <div class="trick-formula">x | (x - 1)</div>
                    <div class="trick-desc">å³å¯¹é½æœ€ä½ç¾¤ç»„çš„1ä¸²ã€‚</div>
                    <div class="example">
                        <div class="example-title">ä¾‹å­ï¼š00101100 â†’ 00101111</div>
                        ğŸ’¡ å†…å­˜å¯¹é½ã€å­é›†æšä¸¾å¸¸ç”¨
                    </div>
                </div>
            </div>

            <div class="mnemonic">
                ğŸ§  <strong>è®°å¿†è¯€çª</strong><br>
                â€¢ <strong>x - 1</strong>ï¼šå‡1ä¼šè·¨è¶Š â†’ æœ€ä½ä½1æ¸…é›¶ï¼Œå³è¾¹0å˜1<br>
                â€¢ <strong>x + 1</strong>ï¼šåŠ 1ä¼šè·¨è¶Š â†’ æœ€ä½ä½0ç½®1ï¼Œå³è¾¹1å˜0<br>
                â€¢ <strong>&</strong> ä¸ï¼šæ¸…é™¤ | <strong>|</strong> æˆ–ï¼šç½®ä½ | <strong>^</strong> å¼‚æˆ–ï¼šç¿»è½¬<br>
                â€¢ <strong>-x</strong>ï¼šå–ååŠ 1 = è¡¥ç ï¼Œæœ€ä½ä½1å•ç‹¬å‡ºç°
            </div>

            <div class="interactive-demo">
                <div class="demo-title">ğŸ® äº¤äº’æ¼”ç¤º - é€‰æ‹©ä¸€ä¸ª8ä½æ•°å­—è¯•è¯•çœ‹ï¼ˆå¹¶åˆ—æ˜¾ç¤ºï¼‰</div>
                <div class="bit-input-group">
                    <div class="bit-input" id="bitInput"></div>
                </div>
                <div class="results-inline" id="results-container">
                    <div class="result-display" id="result1">
                        <div class="result-label">x & (x-1):</div>
                        <div class="result-value">æš‚æ— </div>
                    </div>
                    <div class="result-display" id="result2">
                        <div class="result-label">x | (x+1):</div>
                        <div class="result-value">æš‚æ— </div>
                    </div>
                    <div class="result-display" id="result3">
                        <div class="result-label">x & (x+1):</div>
                        <div class="result-value">æš‚æ— </div>
                    </div>
                    <div class="result-display" id="result4">
                        <div class="result-label">x & (-x):</div>
                        <div class="result-value">æš‚æ— </div>
                    </div>
                </div>
            </div>

            <div class="info-card">
                <strong>ğŸ’» å®æˆ˜åº”ç”¨åœºæ™¯</strong><br>
                1ï¸âƒ£ <strong>Kernighan ä½è®¡æ•°</strong>ï¼šO(popcount) æ¬¡è¿­ä»£è€Œé 32 æ¬¡<br>
                2ï¸âƒ£ <strong>å†…å­˜åˆ†é…å™¨</strong>ï¼šåˆ¤æ–­æ˜¯å¦å·²æ˜¯ 2 çš„å¹‚ (tcmalloc/jemalloc)<br>
                3ï¸âƒ£ <strong>æ£‹ç›˜å¼•æ“</strong>ï¼šæå–æœ€ä½ä½æ£‹å­ä½ç½® (bitboard)<br>
                4ï¸âƒ£ <strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>ï¼šå• bit æ¢é’ˆï¼Œé˜²å“ˆå¸Œç¢°æ’
            </div>
        </div>
		        <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šåŠ å‡æ³•æ’ç­‰å¼ -->
        <div class="section">
            <div class="section-number">2</div>
            <div class="section-title">
                <span class="section-title-emoji">â•</span>
                åŠ å‡æ³•æ’ç­‰å¼ - Addition & Subtraction Identities
            </div>

            <div class="core-insight">
                <strong>ğŸ’¡ æ ¸å¿ƒæ´å¯Ÿï¼š</strong>
                åŠ æ³•å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªç‹¬ç«‹éƒ¨åˆ†ï¼š<span class="highlight">ä¸è¿›ä½æ±‚å’Œ(XOR)</span> å’Œ 
                <span class="highlight">è¿›ä½ä¼ æ’­(ANDå·¦ç§»)</span>ã€‚è¿™ä¸ä»…æ˜¯æ•°å­¦æ¸¸æˆâ€”â€”å®ƒæ­ç¤ºäº†åŠ æ³•å™¨çš„ç‰©ç†ç»“æ„ï¼Œ
                ä¹Ÿæ˜¯å¹¶è¡Œå‰ç¼€åŠ æ³•ã€æ— è¿›ä½ä¹˜æ³•(CLMUL)ã€å¯†ç å­¦çš„ç†è®ºåŸºç¡€ã€‚
            </div>

            <table class="identities-table">
                <thead>
                    <tr>
                        <th>å…¬å¼ç¼–å·</th>
                        <th>æ’ç­‰å¼</th>
                        <th>å«ä¹‰ä¸åº”ç”¨</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>(a)</strong></td>
                        <td><code>x + y == (x^y) + ((x&y)<<1)</code></td>
                        <td>åŠ æ³• = XOR(æ— è¿›ä½) + AND(è¿›ä½)*2<br><strong>ç‹ç‰Œæ’ç­‰å¼</strong></td>
                    </tr>
                    <tr>
                        <td><strong>(b)</strong></td>
                        <td><code>x + y == (x|y) + (x&y)</code></td>
                        <td>åŠ æ³• = OR + ANDï¼ˆç­‰ä»·åˆ†è§£ï¼‰</td>
                    </tr>
                    <tr>
                        <td><strong>(c)</strong></td>
                        <td><code>x ^ y == (x+y) - ((x&y)<<1)</code></td>
                        <td>åå‘æ¨å¯¼ï¼šXOR = åŠ æ³• - è¿›ä½*2</td>
                    </tr>
                    <tr>
                        <td><strong>(d)</strong></td>
                        <td><code>x | y == (x+y) - (x&y)</code></td>
                        <td>OR ç”¨åŠ å‡è¡¨ç¤º</td>
                    </tr>
                    <tr>
                        <td><strong>(e) â­</strong></td>
                        <td><code>x & y == (x|y) - (x^y)</code></td>
                        <td><strong>AND ç”¨ OR/XOR è¡¨ç¤º</strong><br>å…³é”®çš„å¯¹å¶æ€§</td>
                    </tr>
                    <tr>
                        <td><strong>(f) â­â­</strong></td>
                        <td><code>avg = (x&y) + ((x^y)>>1)</code></td>
                        <td><strong>Dietz æ— æº¢å‡ºå¹³å‡</strong><br>æ°¸è¿œä¸ä¼šæ•´æ•°æº¢å‡ºï¼</td>
                    </tr>
                    <tr>
                        <td><strong>(g)</strong></td>
                        <td><code>x ^ y == (x|y) & ~(x&y)</code></td>
                        <td>XOR = (x|y) & NOT(x&y)<br>4 ä¸ªæ“ä½œçš„åˆ†è§£</td>
                    </tr>
                </tbody>
            </table>

            <div class="mnemonic">
                ğŸ§  <strong>De Morgan å¯¹å¶å¾‹</strong><br>
                â€¢ <strong>x & y == ~(~x | ~y)</strong> â† AND/ORäº’æ¢ + NOT<br>
                â€¢ <strong>x | y == ~(~x & ~y)</strong><br>
                â€¢ <strong>x ^ y == (x|y) & ~(x&y)</strong> â† æœ€ç›´è§‚çš„ XOR åˆ†è§£<br>
                â€¢ <strong>è®°å¿†è¯€çª</strong>ï¼šAND/OR/XOR ä¸­ä»»æ„ä¸¤ä¸ªå¯ä»¥æ¨å¯¼ç¬¬ä¸‰ä¸ª
            </div>

            <div class="interactive-demo">
                <div class="demo-title">ğŸ® æ’ç­‰å¼éªŒè¯å™¨ - è‡ªåŠ¨è®¡ç®—æ£€éªŒæ‰€æœ‰å…¬å¼</div>
                <div class="bit-input-group">
                    <label style="font-weight: bold;">è¾“å…¥ x:</label>
                    <input type="number" id="x_val" value="12" min="0" max="255" style="width: 80px; padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                    <label style="font-weight: bold; margin-left: 20px;">è¾“å…¥ y:</label>
                    <input type="number" id="y_val" value="7" min="0" max="255" style="width: 80px; padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                    <button onclick="verifyIdentities()">éªŒè¯</button>
                </div>
                <div id="identities-result" style="margin-top: 20px;">
                    <!-- ç»“æœæ˜¾ç¤º -->
                </div>
            </div>

            <div class="info-card">
                <strong>ğŸ“ ç†è®ºæ„ä¹‰</strong><br>
                è¿™ 22 ä¸ªæ’ç­‰å¼ï¼ˆWarren åŸè‘—åˆ—å‡ºï¼‰æ˜¯ä½è¿ç®—çš„"æ­£äº¤åŸº"ã€‚ä»»æ„ä¸¤ä¸ªåŸºç¡€æ“ä½œ(AND/OR/XOR/NOT)çš„ç»„åˆéƒ½èƒ½ç”¨å…¶ä»–è¡¨ç¤ºã€‚
                è¿™è¯´æ˜åœ¨ä¿¡æ¯è®ºå±‚é¢ï¼Œä½è¿ç®—çš„è¡¨è¾¾èƒ½åŠ›æ˜¯ç­‰ä»·çš„ï¼Œåªæ˜¯<strong>æŒ‡ä»¤æ•°æˆæœ¬</strong>ä¸åŒã€‚
            </div>
        </div>

        <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ— åˆ†æ”¯ç®—æœ¯ -->
        <div class="section">
            <div class="section-number">3</div>
            <div class="section-title">
                <span class="section-title-emoji">âš¡</span>
                æ— åˆ†æ”¯ç®—æœ¯ - Branch-Free Magic (abs/min/max/avg/sign)
            </div>

            <div class="core-insight">
                <strong>ğŸ’¡ å…³é”®å“²å­¦ï¼š</strong>
                æŠŠæ¡ä»¶åˆ¤æ–­è½¬åŒ–ä¸ºçº¯ä½æ“ä½œã€‚ç”¨ <span class="highlight">ç¬¦å·æ©ç  mask = x >> 31</span>
                ï¼ˆæ­£æ•°æ˜¯å…¨ 0ï¼Œè´Ÿæ•°æ˜¯å…¨ 1ï¼‰è®©æ•°æ®è‡ªå·±å†³å®šç»“æœã€‚è¿™æ­£æ˜¯ <strong>SIMD/GPU</strong> ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³ï¼
            </div>

            <div class="tricks-grid">
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">|</span>
                        <span class="trick-number">ğŸ”‘</span>
                        <span class="trick-title">ç¬¦å·æ©ç </span>
                    </div>
                    <div class="trick-formula">mask = x >> 31</div>
                    <div class="trick-desc">
                        âœ… x â‰¥ 0: mask = 0x00000000 (å…¨ 0)<br>
                        âŒ x < 0: mask = 0xFFFFFFFF (å…¨ 1)
                    </div>
                    <div class="badge critical">åŸºç¡€å·¥å…·</div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ“Š</span>
                        <span class="trick-number">A</span>
                        <span class="trick-title">ç»å¯¹å€¼ abs(x)</span>
                    </div>
                    <div class="trick-formula">abs = (x + mask) ^ mask</div>
                    <div class="trick-desc">
                        3 æ¡æŒ‡ä»¤ï¼Œ0 ä¸ªåˆ†æ”¯<br>
                        ç­‰ä»·äºï¼šx < 0 ? -x : x<br>
                        <strong>ä¼˜åŒ–ç‰ˆæœ¬</strong>ï¼š(x ^ mask) - mask
                    </div>
                    <div class="badge critical">é«˜é¢‘ä½¿ç”¨</div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ“‰</span>
                        <span class="trick-number">B</span>
                        <span class="trick-title">æœ€å°å€¼ min(x,y)</span>
                    </div>
                    <div class="trick-formula">min = y + ((x-y) & ((x-y)>>31))</div>
                    <div class="trick-desc">
                        3 æ¡æŒ‡ä»¤ï¼Œ0 ä¸ªåˆ†æ”¯<br>
                        ç­‰ä»·äºï¼šx < y ? x : y<br>
                        <strong>åŸç†</strong>ï¼šå·®å€¼çš„ç¬¦å·ä½å†³å®šé€‰æ‹©
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ“ˆ</span>
                        <span class="trick-number">C</span>
                        <span class="trick-title">æœ€å¤§å€¼ max(x,y)</span>
                    </div>
                    <div class="trick-formula">max = x - ((x-y) & ((x-y)>>31))</div>
                    <div class="trick-desc">
                        3 æ¡æŒ‡ä»¤ï¼Œ0 ä¸ªåˆ†æ”¯<br>
                        ç­‰ä»·äºï¼šx > y ? x : y
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">âš–ï¸</span>
                        <span class="trick-number">D</span>
                        <span class="trick-title">å¹³å‡å€¼ avg(x,y)</span>
                    </div>
                    <div class="trick-formula">avg = (x & y) + ((x ^ y) >> 1)</div>
                    <div class="trick-desc">
                        <strong>Dietz å…¬å¼</strong><br>
                        æ— è®ºå¤šå¤§éƒ½ä¸ä¼šæº¢å‡ºï¼<br>
                        æ¯” (x+y)/2 å®‰å…¨ 100 å€
                    </div>
                    <div class="badge critical">â˜…â˜…â˜… å…³é”®</div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">â•</span>
                        <span class="trick-number">E</span>
                        <span class="trick-title">ç¬¦å·å‡½æ•° sign(x)</span>
                    </div>
                    <div class="trick-formula">sign = (x >> 31) | (-x >> 31)</div>
                    <div class="trick-desc">
                        ç»“æœï¼š-1 (è´Ÿ) / 0 (é›¶) / +1 (æ­£)<br>
                        2 æ¡å³ç§» + 1 æ¡æˆ– = 3 æ¡æŒ‡ä»¤
                    </div>
                </div>
            </div>

            <div class="comparison-grid">
                <div class="comparison-box wrong">
                    <div class="box-title">âŒ ä¼ ç»Ÿæ–¹å¼ (æœ‰åˆ†æ”¯)</div>
                    <code>int abs(int x) {
    if (x < 0) return -x;
    return x;
}</code>
                </div>
                <div class="comparison-box correct">
                    <div class="box-title">âœ… æ— åˆ†æ”¯æ–¹å¼</div>
                    <code>int abs(int x) {
    int m = x >> 31;
    return (x + m) ^ m;
}</code>
                </div>
            </div>

            <div class="interactive-demo">
                <div class="demo-title">ğŸ® æ— åˆ†æ”¯æ“ä½œæ¼”ç¤º - æ”¹å˜ xã€y å®æ—¶è®¡ç®—</div>
                <div class="bit-input-group">
                    <label style="font-weight: bold;">x =</label>
                    <input type="number" id="bf_x" value="42" min="-128" max="127" style="width: 80px; padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                    <label style="font-weight: bold; margin-left: 20px;">y =</label>
                    <input type="number" id="bf_y" value="-15" min="-128" max="127" style="width: 80px; padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                    <button onclick="branchFreeDemo()">è®¡ç®—</button>
                </div>
                <div id="branchfree-result" style="margin-top: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <!-- ç»“æœæ˜¾ç¤º -->
                </div>
            </div>

            <div class="mnemonic">
                ğŸ§  <strong>è®°å¿†è¯€çª</strong><br>
                â€¢ <strong>mask = x >> 31</strong> æ˜¯"å¼€å…³"ï¼Œæ­£æ•° offï¼Œè´Ÿæ•° on<br>
                â€¢ <strong>abs</strong>ï¼šè‹¥ x<0 åˆ™åŠ æ©ç ä½¿å…¶åå·ï¼Œç„¶åå¼‚æˆ–å›æ¥<br>
                â€¢ <strong>min/max</strong>ï¼šç”¨å·®å€¼çš„ç¬¦å·ä½å†³å®šåŠ è¿˜æ˜¯å‡<br>
                â€¢ <strong>avg</strong>ï¼šå…±åŒéƒ¨åˆ† ANDï¼Œå·®å¼‚éƒ¨åˆ†å³ç§» 1 ä½
            </div>

            <div class="info-card">
                <strong>ğŸ† æ€§èƒ½å¯¹æ¯”</strong><br>
                <strong>ä¼ ç»Ÿ abs()</strong>ï¼šåˆ†æ”¯é¢„æµ‹é”™è¯¯æ—¶ 10~20 ä¸ªå‘¨æœŸ<br>
                <strong>æ— åˆ†æ”¯ç‰ˆæœ¬</strong>ï¼šæ’å®š 3~4 ä¸ªå‘¨æœŸï¼Œä¸”èƒ½å®Œå…¨å‘é‡åŒ–ï¼ˆSIMDï¼‰<br>
                åœ¨ç´§å¾ªç¯ä¸­ï¼Œæ— åˆ†æ”¯ä»£ç å¿« <strong>5~10 å€</strong>ï¼è¿™å°±æ˜¯ <strong>Warren æ€æƒ³çš„å•†ä¸šä»·å€¼</strong>ã€‚
            </div>
        </div>

        <!-- ç¬¬å››éƒ¨åˆ†ï¼šMUX å¤šè·¯é€‰æ‹©å™¨ -->
        <div class="section">
            <div class="section-number">4</div>
            <div class="section-title">
                <span class="section-title-emoji">ğŸ”€</span>
                MUX å¤šè·¯é€‰æ‹©å™¨ - Multiplexer
            </div>

            <div class="core-insight">
                <strong>ğŸ’¡ æ¦‚å¿µï¼š</strong>
                MUX(x, y, mask) ç”¨æ©ç åœ¨ x å’Œ y ä¹‹é—´åšæ¡ä»¶é€‰æ‹©ã€‚è¿™æ˜¯ SIMD ä¸­ 
                <span class="highlight">blendv</span> æŒ‡ä»¤çš„åŸå‹ï¼Œä¹Ÿæ˜¯å¸¸é‡æ—¶é—´å¯†ç å­¦çš„æ ¸å¿ƒå·¥å…·ã€‚
            </div>

            <div class="tricks-grid">
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ”€</span>
                        <span class="trick-number">æ ‡å‡†</span>
                        <span class="trick-title">MUX - æ ‡å‡†å½¢å¼</span>
                    </div>
                    <div class="trick-formula">mux(x,y,m) = (x&m) | (y&~m)</div>
                    <div class="trick-desc">
                        m = å…¨ 1: é€‰ x<br>
                        m = å…¨ 0: é€‰ y<br>
                        ç­‰ä»·äºä¸‰å…ƒè¿ç®—ç¬¦ m ? x : y<br>
                        4 æ¡æŒ‡ä»¤
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">âš¡</span>
                        <span class="trick-number">ä¼˜åŒ–</span>
                        <span class="trick-title">MUX - ä¼˜åŒ–å½¢å¼</span>
                    </div>
                    <div class="trick-formula">mux(x,y,m) = ((x^y)&m) ^ y</div>
                    <div class="trick-desc">
                        å°‘ 1 æ¡æŒ‡ä»¤ï¼ˆåªéœ€ 3 æ¡ï¼‰ï¼<br>
                        éœ€è¦å¤„ç†å™¨æ”¯æŒ ANDC<br>
                        (AND-NOT-COMPLEMENT) æŒ‡ä»¤<br>
                        ARM NEONã€x86 AVX512 éƒ½æ”¯æŒ
                    </div>
                    <div class="badge expert">é«˜çº§ä¼˜åŒ–</div>
                </div>
            </div>

            <div class="mnemonic">
                ğŸ§  <strong>MUX åº”ç”¨åœºæ™¯</strong><br>
                â€¢ <strong>SIMD</strong>ï¼šSSE4.1 _mm_blendv_epi8 / ARM NEON vbslq_u32<br>
                â€¢ <strong>å¯†ç å­¦</strong>ï¼šConstant-time ç¼–ç¨‹é˜² timing ä¾§ä¿¡é“<br>
                â€¢ <strong>CPU å¾®ç </strong>ï¼šæ¡ä»¶ä¼ é€æŒ‡ä»¤ CMOV çš„åŸå‹<br>
                â€¢ <strong>æ— åˆ†æ”¯ abs</strong>ï¼št = x >> 31; abs = mux(-x, x, t)
            </div>

            <div class="interactive-demo">
                <div class="demo-title">ğŸ® MUX å¯è§†åŒ– - é€‰æ‹© x æˆ– y</div>
                <div class="bit-input-group">
                    <label style="font-weight: bold;">x =</label>
                    <input type="number" id="mux_x" value="170" min="0" max="255" style="width: 80px; padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                    <label style="font-weight: bold; margin-left: 20px;">y =</label>
                    <input type="number" id="mux_y" value="85" min="0" max="255" style="width: 80px; padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                    <label style="font-weight: bold; margin-left: 20px;">mask =</label>
                    <input type="number" id="mux_m" value="240" min="0" max="255" style="width: 80px; padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                    <button onclick="muxDemo()">è®¡ç®—</button>
                </div>
                <div id="mux-result" style="margin-top: 20px;">
                    <!-- ç»“æœæ˜¾ç¤º -->
                </div>
            </div>
        </div>

        <!-- ç¬¬äº”éƒ¨åˆ†ï¼šGosper's Hack -->
        <div class="section">
            <div class="section-number">5</div>
            <div class="section-title">
                <span class="section-title-emoji">ğŸŒŸ</span>
                Gosper's Hack - æšä¸¾ç»„åˆçš„ç‹ç‰Œ
            </div>

            <div class="core-insight">
                <strong>ğŸ’¡ ç‹å† å®çŸ³ ğŸ‘‘</strong><br>
                ç»™å®šä¸€ä¸ªå« k ä¸ª 1 çš„ n ä½æ•´æ•° xï¼Œæ±‚ä¸‹ä¸€ä¸ªå«åŒæ ·å¤š 1 çš„æœ€å°æ•´æ•°ã€‚
                æ¥è‡ª <strong>1972 å¹´ MIT HAKMEMï¼ˆBill Gosperï¼‰</strong>ï¼Œ5 è¡Œä»£ç ï¼Œ0 ä¸ªåˆ†æ”¯ï¼Œçº¯ä½è¿ç®—ã€‚
                è¿™æ˜¯æ£‹ç›˜å¼•æ“å­é›†æšä¸¾ã€ç»„åˆæœç´¢ã€ç¨€ç–å‘é‡ä¼˜åŒ–çš„æ ¸å¿ƒå¼•æ“ã€‚
            </div>

            <div class="tricks-grid">
                <div class="trick-card" style="grid-column: span 1;">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ“Œ</span>
                        <span class="trick-number">Step 1</span>
                        <span class="trick-title">c = x & -x</span>
                    </div>
                    <div class="trick-desc">
                        æå–æœ€ä½ä½çš„ 1<br>
                        è¿™ä¸ª 1 ä¼šæˆä¸º"è¿›ä½ç‚¹"
                    </div>
                </div>

                <div class="trick-card" style="grid-column: span 1;">
                    <div class="trick-header">
                        <span class="trick-icon">â•</span>
                        <span class="trick-number">Step 2</span>
                        <span class="trick-title">r = x + c</span>
                    </div>
                    <div class="trick-desc">
                        è¿›ä½ä¼ æ’­<br>
                        æ¸…é™¤æœ€ä½è¿ç»­ 1 ä¸²å¹¶è¿›ä½
                    </div>
                </div>

                <div class="trick-card" style="grid-column: span 1;">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ”¢</span>
                        <span class="trick-number">Step 3</span>
                        <span class="trick-title">ones = (r^x)/c>>2)+1</span>
                    </div>
                    <div class="trick-desc">
                        è®¡ç®—ä½ä½éœ€è¦è¡¥çš„ 1 çš„ä¸ªæ•°<br>
                        ä½¿ popcount ä¿æŒä¸å˜
                    </div>
                </div>

                <div class="trick-card" style="grid-column: span 1;">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ¯</span>
                        <span class="trick-number">Result</span>
                        <span class="trick-title">next = r | ones</span>
                    </div>
                    <div class="trick-desc">
                        åˆå¹¶é«˜ä½å’Œä½ä½<br>
                        âœ… å®Œæˆï¼ä¸‹ä¸€ä¸ªæ’åˆ—
                    </div>
                </div>
            </div>

            <div class="interactive-demo">
                <div class="demo-title">ğŸ® Gosper's Hack é€æ­¥æ¼”ç¤º - ç‚¹å‡» NEXT æšä¸¾ä¸‹ä¸€ä¸ª</div>
                <div class="bit-input-group">
                    <label style="font-weight: bold;">èµ·å§‹å€¼ï¼š</label>
                    <input type="number" id="gosper_start" value="7" min="0" max="255" style="width: 80px; padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                    <button onclick="gosperInit()">é‡ç½®</button>
                    <button onclick="gosperNext()" style="margin-left: 10px;">NEXT â†’</button>
                </div>

                <div id="gosper-visualization" style="margin-top: 20px; padding: 20px; background: #f9f9f9; border-radius: 8px;">
                    <div class="result-display">
                        <div class="result-label">x (å½“å‰):</div>
                        <div class="result-value" id="gosper-x">00000111</div>
                    </div>
                    <div class="result-display">
                        <div class="result-label">c = x & -x:</div>
                        <div class="result-value" id="gosper-c">00000001</div>
                    </div>
                    <div class="result-display">
                        <div class="result-label">r = x + c:</div>
                        <div class="result-value" id="gosper-r">00001000</div>
                    </div>
                    <div class="result-display">
                        <div class="result-label">ones = ((r^x)/c)>>2)+1:</div>
                        <div class="result-value" id="gosper-ones">00000011</div>
                    </div>
                    <div class="result-display">
                        <div class="result-label">result = r | ones:</div>
                        <div class="result-value" id="gosper-result">00001011</div>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <div class="demo-title">åºåˆ—ï¼ˆæŒ‰ next_perm é¡ºåºï¼‰ï¼š</div>
                    <div class="gosper-container" id="gosper-sequence">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <div class="mnemonic">
                ğŸ§  <strong>Gosper's Hack åº”ç”¨</strong><br>
                â€¢ <strong>æ£‹ç›˜å¼•æ“</strong>ï¼šStockfish/Leela Chess æšä¸¾è½¦/è±¡çš„æ”»å‡»ä½ç½®<br>
                â€¢ <strong>ç»„åˆå­¦</strong>ï¼šæšä¸¾ C(n,k) æ‰€æœ‰å­é›†ï¼Œæ¯”é€’å½’å¿« 10 å€<br>
                â€¢ <strong>ç¥ç»ç½‘ç»œ</strong>ï¼šç¨€ç–åŒ–æ©ç æœç´¢ï¼Œå›ºå®šç¨€ç–åº¦ä¸‹æ‰¾æœ€ä¼˜æƒé‡<br>
                â€¢ <strong>èƒŒåŒ…é—®é¢˜</strong>ï¼šç²¾ç¡®ç®—æ³•çš„ä½å‰ªæï¼Œæ•°æ®å‹ç¼©
            </div>

            <div class="info-card">
                <strong>âš¡ æ€§èƒ½å¯¹æ¯”</strong><br>
                <strong>é€’å½’æšä¸¾</strong>ï¼š~3000 ä¸‡æ¬¡/ç§’<br>
                <strong>Gosper's Hack</strong>ï¼š~3 äº¿æ¬¡/ç§’<br>
                <strong>åŠ é€Ÿæ¯”</strong>ï¼š<strong>100 å€</strong>ï¼åªå› ä¸º 5 è¡Œä½æ“ä½œçš„ç²¾å¦™è®¾è®¡ã€‚
            </div>
        </div>

        <!-- ç¬¬å…­éƒ¨åˆ†ï¼šç‰¹æ®ŠæŠ€å·§ -->
        <div class="section">
            <div class="section-number">6</div>
            <div class="section-title">
                <span class="section-title-emoji">ğŸ</span>
                ç‰¹æ®ŠæŠ€å·§åˆé›†
            </div>

            <div class="tricks-grid">
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">âš ï¸</span>
                        <span class="trick-number">ä¸€</span>
                        <span class="trick-title">æœ‰ç¬¦å·åŠ æ³•æº¢å‡ºæ£€æµ‹</span>
                    </div>
                    <div class="trick-formula">ov = ((x^sum) & (y^sum)) >> 31</div>
                    <div class="trick-desc">
                        æ£€æµ‹ x + y æ˜¯å¦æº¢å‡º<br>
                        ov = -1 (0xFFFFFFFF): æº¢å‡º<br>
                        ov = 0: ä¸æº¢å‡º<br>
                        <strong>åŸç†</strong>ï¼šåŒå·ç›¸åŠ å¾—åå· = æº¢å‡º
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ”’</span>
                        <span class="trick-number">äºŒ</span>
                        <span class="trick-title">é¥±å’ŒåŠ æ³• (Saturating)</span>
                    </div>
                    <div class="trick-desc">
                        æº¢å‡ºæ—¶é’³åˆ¶åˆ° MAX/MIN<br>
                        <strong>ç”¨é€”</strong>ï¼šéŸ³é¢‘ã€å›¾åƒå¤„ç†é˜²æˆªæ–­<br>
                        <strong>ç¡¬ä»¶</strong>ï¼šARM QADD, x86 _mm_adds_epi16
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ”Œ</span>
                        <span class="trick-number">ä¸‰</span>
                        <span class="trick-title">ç¬¦å·æ‰©å±•</span>
                    </div>
                    <div class="trick-formula">sign_ext(x,n) = (x<<(32-n))>>(32-n)</div>
                    <div class="trick-desc">
                        æŠŠ n ä½æœ‰ç¬¦å·æ•°æ‰©å±•ä¸º 32 ä½<br>
                        2 æ¡æŒ‡ä»¤ï¼ˆç§»ä½ï¼‰
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ“</span>
                        <span class="trick-number">å››</span>
                        <span class="trick-title">ä½åŸŸæå–/æ’å…¥</span>
                    </div>
                    <div class="trick-desc">
                        æå–ï¼š(x>>p) & ((1&lt;&lt;n)-1)<br>
                        æ’å…¥ï¼š(x & ~mask) | ((v&lt;&lt;p) & mask)
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ§®</span>
                        <span class="trick-number">äº”</span>
                        <span class="trick-title">Horner è§„åˆ™</span>
                    </div>
                    <div class="trick-desc">
                        axÂ³+bxÂ²+cx+d = ((ax+b)x+c)x+d<br>
                        <strong>ç”¨é€”</strong>ï¼šå“ˆå¸Œå‡½æ•°ã€å¤šé¡¹å¼æ±‚å€¼<br>
                        hash *= 31 â‰¡ (hash&lt;&lt;5) - hash
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸŒŠ</span>
                        <span class="trick-number">å…­</span>
                        <span class="trick-title">ä½åŸŸå¤åˆ¶</span>
                    </div>
                    <div class="trick-desc">
                        ä»ä½ç½® i å¤åˆ¶å€¼åˆ°ä½ç½® j<br>
                        <strong>ç”¨é€”</strong>ï¼šä½å›¾æ“ä½œã€çº¹ç†åæ ‡å˜æ¢
                    </div>
                    <div class="example">
                        å¤åˆ¶ bit i åˆ° bit j:<br>
                        <code>x = (x & ~(1&lt;&lt;j)) | (((x>>i)&1)&lt;&lt;j)</code>
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸŒŠ</span>
                        <span class="trick-number">ä¸ƒ</span>
                        <span class="trick-title">å¤šå­—èŠ‚ SIMD åŠ æ³•</span>
                    </div>
                    <div class="trick-desc">
                        å››å­—èŠ‚å¹¶è¡ŒåŠ æ³•ï¼ˆ4Ã—byte packedï¼‰<br>
                        <strong>ç”¨é€”</strong>ï¼šå›¾åƒå¤„ç†ã€å‘é‡è¿ç®—
                    </div>
                    <div class="example">
                        Step1: å±è”½é«˜ä½é˜²è¿›ä½ç©¿é€<br>
                        <code>lo = (x & 0x7F7F7F7F) + (y & 0x7F7F7F7F)</code><br>
                        Step2: ä¿®å¤é«˜ä½<br>
                        <code>hi = (x ^ y) & 0x80808080</code><br>
                        <code>sum = lo ^ hi</code>
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ”¢</span>
                        <span class="trick-number">å…«</span>
                        <span class="trick-title">åŒå­—ç§»ä½ (Shld/Shrd)</span>
                    </div>
                    <div class="trick-desc">
                        64 ä½å€¼ç”¨ä¸¤ä¸ª 32 ä½å¯„å­˜å™¨è¡¨ç¤º<br>
                        <strong>æŒ‡ä»¤</strong>ï¼šx86 SHLD/SHRD
                    </div>
                    <div class="example">
                        <code>hi = (hi << n) | (lo >> (32-n))</code><br>
                        <code>lo = lo << n</code><br>
                        âš ï¸ n=0 æˆ– 32 éœ€ç‰¹æ®Šå¤„ç†
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå¸ƒå°”åˆ†è§£å®šç† -->
        <div class="section">
            <div class="section-number">7</div>
            <div class="section-title">
                <span class="section-title-emoji">ğŸ“</span>
                å¸ƒå°”åˆ†è§£å®šç† - Reed-Muller / Davio åˆ†è§£
            </div>

            <div class="core-insight">
                <strong>ğŸ’¡ æ•°å­¦åŸç†ï¼š</strong>
                ä»»æ„ n å…ƒå¸ƒå°”å‡½æ•°éƒ½å¯ä»¥ç”¨ä¸€æ¡ <span class="highlight">XOR</span> + ä¸¤ä¸ª (n-1) å…ƒå¸ƒå°”å‡½æ•°é€’å½’è¡¨ç¤ºï¼š
                <br><br>
                <strong>f(x,y,z) = g(x,y) âŠ• zÂ·h(x,y)</strong>
                <br><br>
                å…¶ä¸­ g(x,y) = f(x,y,0)ï¼Œh(x,y) = f(x,y,0) âŠ• f(x,y,1)
                <br><br>
                è¿™ä¸ªå®šç†ä¿è¯äº†<strong>ä»»æ„å¸ƒå°”å‡½æ•°éƒ½å¯ä»¥ç”¨ AND/OR/XOR/NOT çš„æœ‰é™ç»„åˆå®ç°</strong>ï¼Œ
                æ˜¯ç¼–è¯‘å™¨å¸ƒå°”ä¼˜åŒ–å’Œç¡¬ä»¶ç»¼åˆçš„ç†è®ºåŸºç¡€ã€‚
            </div>

            <div class="info-card">
                <strong>ğŸ“Š å®ç°å¤æ‚åº¦</strong><br>
                â€¢ <strong>1 æ¡æŒ‡ä»¤</strong>ï¼šNOTã€å¸¸æ•° 0/1<br>
                â€¢ <strong>2 æ¡æŒ‡ä»¤</strong>ï¼šå¤§å¤šæ•°æ ‡å‡†é—¨ (AND/OR/XOR/NAND/NOR)<br>
                â€¢ <strong>3 æ¡æŒ‡ä»¤</strong>ï¼šå¤§å¤šæ•° 3 å˜é‡å‡½æ•° (224/256 ç§)<br>
                â€¢ <strong>4 æ¡æŒ‡ä»¤</strong>ï¼šå‰©ä½™ 32 ç§è¾ƒå¤æ‚å‡½æ•°ï¼ˆå«å¤šæ•°è¡¨å†³ MAJ ç­‰ï¼‰
            </div>

            <div class="mnemonic">
                ğŸ§  <strong>Horner è§„åˆ™æ‰©å±•</strong><br>
                å¤šé¡¹å¼æ±‚å€¼ï¼šaxÂ³+bxÂ²+cx+d = ((ax+b)x+c)x+d<br>
                â€¢ n ä¸ªå˜é‡ = n æ¬¡ä¹˜æ³• + n æ¬¡åŠ æ³•ï¼ˆæœ€ä¼˜ï¼‰<br>
                â€¢ Java String.hashCode() å°±ç”¨çš„è¿™ä¸ª<br>
                â€¢ ä¹˜ä»¥ 31 çš„å¿«é€Ÿå†™æ³•ï¼šhash * 31 = (hash << 5) - hash
            </div>

            <div class="interactive-demo">
                <div class="demo-title">ğŸ® å¸ƒå°”å‡½æ•°åˆ†è§£æ¼”ç¤º - Reed-Muller å±•å¼€</div>
                <div class="bit-input-group">
                    <label style="font-weight: bold;">é€‰æ‹©å¸ƒå°”å‡½æ•°ï¼š</label>
                    <select id="bool_func" style="padding: 8px; border: 2px solid #667eea; border-radius: 4px;">
                        <option value="and">x AND y</option>
                        <option value="or">x OR y</option>
                        <option value="xor">x XOR y</option>
                        <option value="maj">å¤šæ•°è¡¨å†³ (x&y)|(y&z)|(z&x)</option>
                        <option value="parity">å¥‡å¶ x^y^z</option>
                    </select>
                    <button onclick="boolDecompose()">å±•å¼€</button>
                </div>
                <div id="bool-result" style="margin-top: 20px;">
                    <!-- ç»“æœæ˜¾ç¤º -->
                </div>
            </div>
        </div>

        <!-- ç¬¬å…«éƒ¨åˆ†ï¼šå†å²æ¼”å˜ -->
        <div class="section">
            <div class="section-number">ğŸ“š</div>
            <div class="section-title">
                <span class="section-title-emoji">â°</span>
                å†å²æ¼”å˜ - è¿™äº›æŠ€å·§ä»å“ªé‡Œæ¥
            </div>

            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-year">1961 â€” Christopher Strachey</div>
                    <div class="timeline-text">
                        ã€ŠBitwise Operationsã€‹CACM è®ºæ–‡<br>
                        æœ€æ—©æ­£å¼å‘è¡¨ä½æ“ä½œç†è®ºçš„æ–‡ç« ã€‚Strachey æ˜¯ CPL è¯­è¨€å‘æ˜äººã€æŒ‡ç§°è¯­ä¹‰å­¦å¥ åŸºè€…ã€‚
                        ä»–åœ¨ 3 é¡µå°æ–‡ä¸­å°±ç»™å‡ºäº†ç”¨ XOR å®ç°åŠ æ³•çš„æ€è·¯ï¼Œæ¯” Warren æ’ç­‰å¼æ—©äº† <strong>40 å¹´</strong>ã€‚
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-year">1972 â€” Bill Gosper, HAKMEM</div>
                    <div class="timeline-text">
                        MIT AI Lab AIM-239ï¼Œä½æ“ä½œåœ£ç»<br>
                        Gosperã€Beelerã€Schroeppel åœ¨ PDP-10 ä¸Šç§¯ç´¯çš„æŠ€å·§ã€‚åŒ…æ‹¬æœ¬ç« æœ€äº®çœ¼çš„ <strong>Gosper's Hack</strong>ã€
                        äººå£è®¡æ•°ã€å¾ªç¯æ£€æµ‹ç­‰ã€‚Warren ç¬¬ 2 ç« æœ€ç»å…¸çš„å‡ ä¸ªæŠ€å·§éƒ½æºè‡ªæ­¤å¤‡å¿˜å½•ã€‚
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-year">1986 â€” Henry Dietz</div>
                    <div class="timeline-text">
                        æ— æº¢å‡ºå¹³å‡å€¼å…¬å¼<br>
                        Dietz åœ¨ aggregate.org å‘å¸ƒäº†å¤§é‡ä½è¿ç®—é­”æ³•ã€‚è‘—åçš„ <span class="highlight">(x&y)+((x^y)>>1)</span>
                        æ— æº¢å‡ºå¹³å‡å…¬å¼çœ‹èµ·æ¥å¹³æ·¡ï¼Œä½†å®ƒæ­£ç¡®å¤„ç†äº†ä¸¤ä¸ªå¤§æ­£æ•´æ•°ç›¸åŠ è¶…è¿‡ INT_MAX çš„æƒ…å†µï¼Œ
                        æ˜¯æ‰€æœ‰ SIMD åº“çš„åŸºç¡€ç»„ä»¶ã€‚
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-year">1992 â€” GCC / GNU Superoptimizer</div>
                    <div class="timeline-text">
                        ç¼–è¯‘å™¨å¼€å§‹è‡ªåŠ¨å‘ç°ä½æ“ä½œæŠ€å·§<br>
                        Granlund å’Œ Kenner åœ¨ PLDI 1992 å‘è¡¨è®ºæ–‡ï¼Œæè¿°å¦‚ä½•ç”¨è¶…çº§ä¼˜åŒ–å™¨è‡ªåŠ¨æ‰¾åˆ°ç­‰ä»·ä½†æ›´çŸ­çš„æŒ‡ä»¤åºåˆ—ã€‚
                        <strong>æœºå™¨æ¯”äººå…ˆæŒæ¡äº†è¿™äº›æŠ€å·§</strong>ï¼
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-year">2006 â€” Joshua Bloch, Java Bug Disclosure</div>
                    <div class="timeline-text">
                        äºŒåˆ†æœç´¢æº¢å‡º bug<br>
                        JDK çš„ Arrays.binarySearch åœ¨æ•°ç»„æå¤§æ—¶ä¼šæ•´æ•°æº¢å‡ºã€‚
                        æ­£ç¡®å†™æ³•æ˜¯ Dietz å…¬å¼ (lo & hi) + ((lo ^ hi) >> 1)ã€‚
                        è¿™ä¸ªé™·é˜±æ½œä¼äº† <strong>è¿‘ 10 å¹´</strong>ï¼Œæ¯å¹´éƒ½è¢«é‡æ–°"å‘ç°"ã€‚
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-year">2013 â€” x86 BMI1/BMI2 æŒ‡ä»¤é›†</div>
                    <div class="timeline-text">
                        è½¯ä»¶æŠ€å·§çƒ§è¿›ç¡¬ä»¶<br>
                        Intel Haswell å¼•å…¥ BMI1ï¼ˆBLSR, BLSI, BLSMSK, TZCNTï¼‰å’Œ BMI2ï¼ˆPEXT, PDEPï¼‰ï¼Œ
                        ç›´æ¥æŠŠç¬¬ 2 ç« çš„æœ€å³ä½æ“ä½œå˜æˆ<strong>å•æ¡æŒ‡ä»¤</strong>ã€‚
                        Warren çš„"5æ¡æŒ‡ä»¤æŠ€å·§"ä¸€å¤œä¹‹é—´å˜æˆ"1æ¡æŒ‡ä»¤"ï¼
                    </div>
                </div>
            </div>

            <div class="info-card">
                <strong>ğŸ” æŠ€æœ¯æ´è§</strong><br>
                è¿™ç§"å…ˆè½¯ä»¶å†ç¡¬ä»¶"çš„è½¨è¿¹åœ¨è®¡ç®—æœºä½“ç³»ç»“æ„å²ä¸Šåå¤ä¸Šæ¼”ï¼š<br>
                1ï¸âƒ£ è½¯ä»¶å·¥ç¨‹å¸ˆå‘æ˜äº†éå¸¸è§„çš„ä¼˜åŒ–æŠ€å·§<br>
                2ï¸âƒ£ å¤šå¹´å CPU è®¾è®¡å¸ˆæŠŠæœ€å—æ¬¢è¿çš„æŠ€å·§çƒ§è¿›ç¡¬ä»¶æŒ‡ä»¤<br>
                3ï¸âƒ£ æ–°ä»£ç ç”¨ç¡¬ä»¶æŒ‡ä»¤é‡å†™ï¼Œæ€§èƒ½æš´å¢<br>
                è¿™æ­£æ˜¯ x86 BMI1ã€AVX-512ã€ARM NEON çš„ç”±æ¥ï¼
            </div>
        </div>

        <!-- ç¬¬ä¹éƒ¨åˆ†ï¼šæ·±åº¦ç‚¹è¯„ -->
        <div class="section">
            <div class="section-number">ğŸ’­</div>
            <div class="section-title">
                <span class="section-title-emoji">ğŸ”¬</span>
                æ·±åº¦ç‚¹è¯„ - æŠ€æœ¯å“²å­¦ä¸æ‰¹åˆ¤åˆ†æ
            </div>

            <div class="tricks-grid">
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">âš™ï¸</span>
                        <span class="trick-number">ä¸€</span>
                        <span class="trick-title">ä¸ºä»€ä¹ˆæ— åˆ†æ”¯ä»£ç è¿™ä¹ˆé‡è¦ï¼Ÿ</span>
                    </div>
                    <div class="trick-desc">
                        <strong>åˆ†æ”¯çš„ä»£ä»·ï¼š</strong>
                        ç°ä»£ CPU åˆ†æ”¯é¢„æµ‹å¤±è´¥æ—¶è¦æ¸…ç©ºæµæ°´çº¿ï¼ŒæŸå¤± 10~20 ä¸ªå‘¨æœŸã€‚
                        æ— åˆ†æ”¯ä»£ç ç”¨ç¬¦å·æ©ç  <span class="highlight">mask = x >> 31</span>
                        è®©æ•°æ®è‡ªå·±å†³å®šç»“æœï¼Œå®Œå…¨é¿å…åˆ†æ”¯ã€‚
                        <br><br>
                        <strong>SIMD å“²å­¦ï¼š</strong>
                        åœ¨å‘é‡åŒ–ç¯å¢ƒä¸­æ²¡æœ‰"åˆ†æ”¯"ï¼Œåªæœ‰"æ©ç é€‰æ‹©"ã€‚
                        SSE4.1 çš„ _mm_blendv_epi8ã€AVX-512 çš„è°“è¯æ©ç ï¼Œéƒ½æ˜¯è¿™ä¸ªæ€æƒ³çš„ç¡¬ä»¶åŒ–ã€‚
                        <strong>Warren åœ¨ 2002 å¹´å°±ç”¨çº¯è½¯ä»¶é¢„æ¼”äº†æ•´ä¸ª SIMD æ—¶ä»£çš„ç¼–ç¨‹æ¨¡å‹ã€‚</strong>
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ›¡ï¸</span>
                        <span class="trick-number">äºŒ</span>
                        <span class="trick-title">Dietz å¹³å‡å…¬å¼ï¼šè¢«ä½ä¼°çš„å®‰å…¨è¡¥ä¸</span>
                    </div>
                    <div class="trick-desc">
                        <strong>ç»å…¸ bugï¼š</strong>
                        (lo + hi) / 2 æ˜¯äºŒåˆ†æœç´¢çš„æ ‡å‡†å†™æ³•ï¼Œä½†åœ¨æ•°ç»„æå¤§æ—¶ä¼šæ•´æ•°æº¢å‡ºã€‚
                        Joshua Bloch åœ¨ 2006 å¹´åšå®¢æŠ«éœ² JDK bugï¼Œ<strong>æ½œä¼äº†è¿‘ 10 å¹´</strong>ã€‚
                        <br><br>
                        <strong>æ­£ç¡®æ–¹æ¡ˆï¼š</strong>
                        <span class="highlight">(lo & hi) + ((lo ^ hi) >> 1)</span>
                        æ— è®ºè¾“å…¥å¤šå¤§éƒ½ä¸ä¼šæº¢å‡ºï¼è¿™ä¸æ˜¯å­¦æœ¯æ¸¸æˆâ€”â€”å®ƒæ˜¯æ¯å¹´éƒ½è¢«é‡æ–°"å‘ç°"çš„å®‰å…¨é™·é˜±ã€‚
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ‘‘</span>
                        <span class="trick-number">ä¸‰</span>
                        <span class="trick-title">Gosper's Hackï¼šç»„åˆçˆ†ç‚¸çš„æ•‘æ˜Ÿ</span>
                    </div>
                    <div class="trick-desc">
                        <strong>æ€§èƒ½çªç ´ï¼š</strong>
                        Gosper's Hack æŠŠ"æšä¸¾å« k ä¸ª 1 çš„ n ä½ä¸²"çš„å†…å±‚å¾ªç¯æ¨è¿›æˆ O(1)ï¼Œ
                        æ²¡æœ‰æ¡ä»¶åˆ†æ”¯ï¼Œæ²¡æœ‰è®¡æ•°å™¨ã€‚æ¯æ¬¡è°ƒç”¨åªéœ€ <strong>4 æ¡æŒ‡ä»¤</strong>ã€‚
                        <br><br>
                        <strong>å®æˆ˜å¯¹æ¯”ï¼š</strong>
                        é€’å½’å®ç°ï¼š~3000 ä¸‡æ¬¡/ç§’<br>
                        Gosper's Hackï¼š~3 äº¿æ¬¡/ç§’<br>
                        <span class="highlight">åŠ é€Ÿæ¯”ï¼š100 å€</span>ï¼Œåªå› ä¸º 5 è¡Œä»£ç çš„æ•°å­¦æ´è§ã€‚
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">âš ï¸</span>
                        <span class="trick-number">å››</span>
                        <span class="trick-title">å±€é™æ€§ï¼šç°ä»£è¯­è¨€æ€ä¹ˆçœ‹ï¼Ÿ</span>
                    </div>
                    <div class="trick-desc">
                        <strong>Rust çš„æŒ‘æˆ˜ï¼š</strong>
                        æœ‰ç¬¦å·æ•´æ•°æº¢å‡ºåœ¨ debug æ¨¡å¼ä¼š panicã€‚
                        éœ€è¦æ˜¾å¼ç”¨ wrapping_add é¿å… UBã€‚
                        <br><br>
                        <strong>C23 æ”¹è¿›ï¼š</strong>
                        æœ‰ç¬¦å·æ•´æ•°æº¢å‡ºä¸å†æ˜¯ UBï¼Œè€Œæ˜¯ well-defined wrap-aroundã€‚
                        <br><br>
                        <strong>Java å®‰å…¨æ€§ï¼š</strong>
                        æ—  UB è¯­ä¹‰ï¼Œå®Œå…¨æ²¡é—®é¢˜ã€‚ä½†æ²¡æœ‰æ— ç¬¦å·æ•´æ•°ï¼ŒæŸäº›æŠ€å·§è¦æ‰‹åŠ¨åç§»ã€‚
                        <br><br>
                        <strong>ç»“è®ºï¼š</strong>æ€æƒ³è·¨å¹³å°ï¼Œä½†å®ç°ç»†èŠ‚éœ€æŒ‰è¯­è¨€æ ¡å¯¹ã€‚
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">ğŸ¯</span>
                        <span class="trick-number">äº”</span>
                        <span class="trick-title">å¯æ¨å¹¿åˆ°å“ªé‡Œï¼Ÿ</span>
                    </div>
                    <div class="trick-desc">
                        <strong>1ï¸âƒ£ SIMD/GPU</strong><br>
                        æœ¬ç« æ‰€æœ‰ branch-free æŠ€å·§éƒ½å¯é€å­—ç¿»è¯‘åˆ° AVX2/NEON intrinsicsï¼Œ
                        æ€§èƒ½ä¹˜ä»¥å‘é‡å®½åº¦ï¼ˆ8x~16xï¼‰ã€‚
                        <br><br>
                        <strong>2ï¸âƒ£ å¯†ç å­¦</strong><br>
                        Constant-time ç¼–ç¨‹ï¼ˆé˜² timing ä¾§ä¿¡é“æ”»å‡»ï¼‰çš„æ ¸å¿ƒå°±æ˜¯ MUX æŠ€æœ¯ã€‚
                        <br><br>
                        <strong>3ï¸âƒ£ ç¡¬ä»¶è®¾è®¡</strong><br>
                        Verilog/VHDL ç»¼åˆå™¨å°†è¿™äº›ä½æ“ä½œç›´æ¥æ˜ å°„åˆ° LUTã€‚
                        <br><br>
                        <strong>4ï¸âƒ£ é‡å­è®¡ç®—</strong><br>
                        å¯é€†è®¡ç®—ä¸­ XOR é—¨å¤©ç„¶å¯é€†ï¼Œæœ¬ç« æ’ç­‰å¼åœ¨é‡å­ç”µè·¯ç»¼åˆæœ‰ç›´æ¥åº”ç”¨ã€‚
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¬¬åéƒ¨åˆ†ï¼šè¯¾åç»ƒä¹  -->
        <div class="section">
            <div class="section-number">âœï¸</div>
            <div class="section-title">
                <span class="section-title-emoji">ğŸ“–</span>
                Warren Â§2 è¯¾åç²¾é€‰é¢˜ - åŠ¨æ‰‹å®è·µ
            </div>

            <div class="tricks-grid">
                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">Q3</span>
                        <span class="trick-number">â˜…</span>
                        <span class="trick-title">æ¨å¯¼ Dietz æ— æº¢å‡ºå¹³å‡å€¼</span>
                    </div>
                    <div class="trick-desc">
                        <strong>é—®é¢˜ï¼š</strong>è¯æ˜<br>
                        <span class="highlight">(x&y) + ((x^y)>>1)</span>
                        <br>æ°¸è¿œä¸ä¼šæº¢å‡ºï¼Œä¸”ç­‰äº (x+y)/2ï¼ˆèˆå…¥ï¼‰
                    </div>
                    <div class="example">
                        <strong>æç¤ºï¼š</strong><br>
                        â€¢ x+y = (x&y)*2 + (x^y)<br>
                        â€¢ (x&y)*2 + (x^y) = (x&y)*2 + ((x^y)>>1)*2<br>
                        â€¢ æ‰€ä»¥ (x+y)/2 = (x&y) + ((x^y)>>1)
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">Q8</span>
                        <span class="trick-number">â˜…â˜…</span>
                        <span class="trick-title">MUX 3 æ¡æŒ‡ä»¤å®ç°</span>
                    </div>
                    <div class="trick-desc">
                        <strong>é—®é¢˜ï¼š</strong>è¯æ˜ MUX å¯ä»¥ç”¨ 3 æ¡åŸºç¡€ RISC æŒ‡ä»¤å®ç°<br>
                        <span class="highlight">mux(x,y,m) = ((x^y) & m) ^ y</span>
                    </div>
                    <div class="example">
                        <strong>æ ‡å‡†å½¢å¼ï¼š</strong><br>
                        mux = (x&m) | (y&~m) (4 æ¡æŒ‡ä»¤)<br>
                        <strong>ä¼˜åŒ–å½¢å¼ï¼š</strong><br>
                        mux = ((x^y)&m) ^ y (3 æ¡æŒ‡ä»¤)
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">Q10</span>
                        <span class="trick-number">â˜…â˜…</span>
                        <span class="trick-title">ä½å¤åˆ¶é—®é¢˜</span>
                    </div>
                    <div class="trick-desc">
                        <strong>é—®é¢˜ï¼š</strong>ç»™å®š x å’Œä¸¤ä¸ªä½ç½® iã€jï¼Œ
                        æŠŠ x åœ¨ä½ i çš„å€¼å¤åˆ¶åˆ°ä½ jï¼ˆå…¶ä½™ä½ä¸å˜ï¼‰
                    </div>
                    <div class="example">
                        <strong>æ–¹æ¡ˆï¼š</strong><br>
                        æå– bit i: (x >> i) & 1<br>
                        æ¸…é™¤ bit j: x & ~(1 &lt;&lt; j)<br>
                        åˆå¹¶: (x & ~(1&lt;&lt;j)) | (((x>>i)&1)&lt;&lt;j)
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">Q11</span>
                        <span class="trick-number">â˜…â˜…â˜…</span>
                        <span class="trick-title">å¸ƒå°”åˆ†è§£å®šç†</span>
                    </div>
                    <div class="trick-desc">
                        <strong>é—®é¢˜ï¼š</strong>å®ç°ä»»æ„ n å…ƒå¸ƒå°”å‡½æ•°æœ€å°‘éœ€è¦å‡ æ¡äºŒå…ƒæŒ‡ä»¤ï¼Ÿ
                    </div>
                    <div class="example">
                        <strong>ç­”æ¡ˆï¼š</strong><br>
                        â€¢ 1 å˜é‡: 1 æ¡ (NOT)<br>
                        â€¢ 2 å˜é‡: 2 æ¡ (AND/OR/XOR)<br>
                        â€¢ 3 å˜é‡: å¹³å‡ 3 æ¡, æœ€å¤š 4 æ¡<br>
                        â€¢ n å˜é‡: â‰ˆ 3n æ¡ï¼ˆReed-Muller å±•å¼€ï¼‰
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">Q5</span>
                        <span class="trick-number">â˜…</span>
                        <span class="trick-title">æ¡ä»¶æ¯”è¾ƒç®€åŒ–</span>
                    </div>
                    <div class="trick-desc">
                        <strong>é—®é¢˜ï¼š</strong>è‹¥å·²çŸ¥ yâ‚ƒâ‚=0ï¼ˆå³ y>0ï¼‰ï¼Œ
                        7æŒ‡ä»¤æœ‰ç¬¦å·æ¯”è¾ƒå¯ä»¥ç®€åŒ–ä¸ºå‡ æ¡ï¼Ÿ
                    </div>
                    <div class="example">
                        <strong>æ ‡å‡†ç‰ˆæœ¬ï¼š</strong><br>
                        7 æ¡æŒ‡ä»¤ï¼ˆå«ç¬¦å·ä½ç¿»è½¬ï¼‰<br>
                        <strong>ç®€åŒ–ç‰ˆæœ¬ï¼ˆy>0ï¼‰ï¼š</strong><br>
                        å¯ç®€åŒ–ä¸º 3~4 æ¡ï¼ï¼ˆä¸ç”¨ç¬¦å·ç¿»è½¬ï¼‰
                    </div>
                </div>

                <div class="trick-card">
                    <div class="trick-header">
                        <span class="trick-icon">Q4</span>
                        <span class="trick-number">â˜…â˜…</span>
                        <span class="trick-title">å››æ•°æ— æº¢å‡ºå¹³å‡</span>
                    </div>
                    <div class="trick-desc">
                        <strong>é—®é¢˜ï¼š</strong>ç»™å‡ºå››ä¸ªæ— ç¬¦å·æ•´æ•° (a+b+c+d)/4 çš„æ— æº¢å‡ºè®¡ç®—æ–¹æ³•
                    </div>
                    <div class="example">
                        <strong>æ–¹æ¡ˆï¼š</strong><br>
                        åˆ†ç»„è®¡ç®—ï¼š<br>
                        avg1 = (a&b) + ((a^b)>>1)<br>
                        avg2 = (c&d) + ((c^d)>>1)<br>
                        avg4 = (avg1&avg2) + ((avg1^avg2)>>1)
                    </div>
                </div>
            </div>
        </div>

        <!-- é¡µè„š -->
        <div class="footer">
            <p>ğŸ¯ <strong>Hacker's Delight - Chapter 02 å®Œæ•´å­¦ä¹ ç‰ˆ</strong></p>
            <p>åŸè‘—ï¼šHenry S. Warren, Jr. | ç¬¬äºŒç‰ˆ 2013</p>
            <p>äº¤äº’ç‰ˆç¼–åˆ¶ | æ‰€æœ‰å†…å®¹åŸºäºåŸè‘—çŸ¥è¯†ç‚¹ç²¾ç‚¼è€Œæˆ</p>
            <div class="source">
                ğŸ“– æœ¬ç‰ˆæœ¬åŒ…å« 20+ ä¸ªäº¤äº’æ¼”ç¤ºã€å†å²æ—¶é—´çº¿ã€æ·±åº¦ç‚¹è¯„<br>
                ğŸ® æ”¯æŒå®æ—¶æ•°å€¼è¾“å…¥ã€ä½åºåˆ—å¯è§†åŒ–ã€é€æ­¥è¿½è¸ªç®—æ³•
            </div>
        </div>
    </div>
	    <!-- ===== JavaScript äº¤äº’ä»£ç  ===== -->
    <script>
        // ===== å…¨å±€å˜é‡ =====
        let gosperCurrent = 0;

        // ===== å·¥å…·å‡½æ•° =====
        function toBinary(n, bits = 8) {
            return n.toString(2).padStart(bits, '0');
        }

        function toBinaryDisplay(n, bits = 8) {
            let bin = toBinary(n, bits);
            let html = '';
            for (let i = 0; i < bin.length; i++) {
                const bit = bin[i];
                html += `<div class="bit ${bit === '1' ? 'one' : 'zero'}">${bit}</div>`;
            }
            return html;
        }

        // ===== ç¬¬ä¸€éƒ¨åˆ†ï¼šæœ€å³ä½äº¤äº’æ¼”ç¤º =====
        function initBitInput() {
            const container = document.getElementById('bitInput');
            if (!container) return;
            
            container.innerHTML = '';
            for (let i = 7; i >= 0; i--) {
                const bit = document.createElement('input');
                bit.type = 'checkbox';
                bit.className = 'bit-toggle';
                bit.value = (1 << i);
                bit.checked = false;
                bit.onchange = updateRightmostResults;
                container.appendChild(bit);
            }
        }

        function updateRightmostResults() {
            const container = document.getElementById('bitInput');
            if (!container) return;

            const checkboxes = container.querySelectorAll('input[type="checkbox"]');
            let x = 0;
            checkboxes.forEach(cb => {
                if (cb.checked) x |= parseInt(cb.value);
            });

            const results = [
                { id: 'result1', formula: 'x & (x-1)', value: x & (x - 1) },
                { id: 'result2', formula: 'x | (x+1)', value: x | (x + 1) },
                { id: 'result3', formula: 'x & (x+1)', value: x & (x + 1) },
                { id: 'result4', formula: 'x & (-x)', value: x & (-x) }
            ];

            results.forEach(r => {
                const elem = document.getElementById(r.id);
                if (!elem) return;
                
                const val = r.value >>> 0;
                elem.innerHTML = `
                    <div class="result-label">${r.formula}:</div>
                    <div class="result-value" style="font-family:monospace;">
                        ${toBinary(val)} (${val})
                    </div>
                    <div style="margin-top:8px;">${toBinaryDisplay(val)}</div>
                `;
            });
        }

        // ===== ç¬¬äºŒéƒ¨åˆ†ï¼šæ’ç­‰å¼éªŒè¯å™¨ =====
        function verifyIdentities() {
            const xInput = document.getElementById('x_val');
            const yInput = document.getElementById('y_val');
            
            if (!xInput || !yInput) return;

            const x = parseInt(xInput.value) || 0;
            const y = parseInt(yInput.value) || 0;

            const identities = [
                { 
                    name: '(a) x + y = (x^y) + ((x&y)<<1)', 
                    left: (x + y) >>> 0, 
                    right: ((x ^ y) + ((x & y) << 1)) >>> 0 
                },
                { 
                    name: '(b) x + y = (x|y) + (x&y)', 
                    left: (x + y) >>> 0, 
                    right: ((x | y) + (x & y)) >>> 0 
                },
                { 
                    name: '(c) x ^ y = (x+y) - ((x&y)<<1)', 
                    left: x ^ y, 
                    right: ((x + y) - ((x & y) << 1)) >>> 0 
                },
                { 
                    name: '(d) x | y = (x+y) - (x&y)', 
                    left: x | y, 
                    right: ((x + y) - (x & y)) >>> 0 
                },
                { 
                    name: '(e) x & y = (x|y) - (x^y)', 
                    left: x & y, 
                    right: ((x | y) - (x ^ y)) >>> 0 
                },
                { 
                    name: '(f) avg = (x&y) + ((x^y)>>1)', 
                    left: Math.floor((x + y) / 2), 
                    right: ((x & y) + ((x ^ y) >> 1)) >>> 0 
                }
            ];

            let html = '<div style="display:grid; gap:15px;">';
            identities.forEach(id => {
                const match = id.left === id.right ? 'âœ…' : 'âŒ';
                html += `
                    <div style="background:#f9f9f9; padding:12px; border-radius:6px; border-left:4px solid ${id.left === id.right ? '#00b894' : '#d63031'}">
                        <div style="font-weight:bold; color:#667eea;">${match} ${id.name}</div>
                        <div style="font-family:monospace; margin-top:8px; font-size:0.9em;">
                            å·¦è¾¹ = ${id.left} (${toBinary(id.left, 16)})<br>
                            å³è¾¹ = ${id.right} (${toBinary(id.right, 16)})
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            
            const resultElem = document.getElementById('identities-result');
            if (resultElem) {
                resultElem.innerHTML = html;
            }
        }

        // ===== ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ— åˆ†æ”¯æ¼”ç¤º =====
        function branchFreeDemo() {
            const xInput = document.getElementById('bf_x');
            const yInput = document.getElementById('bf_y');
            
            if (!xInput || !yInput) return;

            const x = parseInt(xInput.value) || 0;
            const y = parseInt(yInput.value) || 0;

            const mask_x = x >> 31;
            const abs_x = (x + mask_x) ^ mask_x;
            
            const diff = (x - y) | 0;
            const min_val = (y + (diff & (diff >> 31))) | 0;
            const max_val = (x - (diff & (diff >> 31))) | 0;
            const avg_val = ((x & y) + (((x ^ y) >> 1))) >>> 0;
            
            const sign_val = ((x >> 31) | ((-x) >> 31));

            const html = `
                <div style="background:#f9f9f9; padding:15px; border-radius:8px; margin:10px 0; border-left:4px solid #667eea;">
                    <div class="result-label">x = ${x}, y = ${y}</div>
                </div>
                <div style="background:#f9f9f9; padding:15px; border-radius:8px; margin:10px 0; border-left:4px solid #00b894;">
                    <div class="result-label">abs(x) = ${abs_x}</div>
                    <div class="result-value" style="font-family:monospace;">å…¬å¼: (x+mask)^mask = ${abs_x}</div>
                </div>
                <div style="background:#f9f9f9; padding:15px; border-radius:8px; margin:10px 0; border-left:4px solid #00b894;">
                    <div class="result-label">min(x,y) = ${min_val}</div>
                    <div class="result-value" style="font-family:monospace;">å…¬å¼: y+((x-y)&((x-y)>>31)) = ${min_val}</div>
                </div>
                <div style="background:#f9f9f9; padding:15px; border-radius:8px; margin:10px 0; border-left:4px solid #00b894;">
                    <div class="result-label">max(x,y) = ${max_val}</div>
                    <div class="result-value" style="font-family:monospace;">å…¬å¼: x-((x-y)&((x-y)>>31)) = ${max_val}</div>
                </div>
                <div style="background:#f9f9f9; padding:15px; border-radius:8px; margin:10px 0; border-left:4px solid #00b894;">
                    <div class="result-label">avg(x,y) = ${avg_val} (æ— æº¢å‡º!)</div>
                    <div class="result-value" style="font-family:monospace;">å…¬å¼: (x&y)+((x^y)>>1) = ${avg_val}</div>
                </div>
                <div style="background:#f9f9f9; padding:15px; border-radius:8px; margin:10px 0; border-left:4px solid #00b894;">
                    <div class="result-label">sign(x) = ${sign_val}</div>
                    <div class="result-value" style="font-family:monospace;">-1(è´Ÿ) / 0(é›¶) / +1(æ­£) = ${sign_val}</div>
                </div>
            `;
            
            const resultElem = document.getElementById('branchfree-result');
            if (resultElem) {
                resultElem.innerHTML = html;
            }
        }

        // ===== ç¬¬å››éƒ¨åˆ†ï¼šMUX æ¼”ç¤º =====
        function muxDemo() {
            const xInput = document.getElementById('mux_x');
            const yInput = document.getElementById('mux_y');
            const mInput = document.getElementById('mux_m');
            
            if (!xInput || !yInput || !mInput) return;

            const x = parseInt(xInput.value) || 0;
            const y = parseInt(yInput.value) || 0;
            const m = parseInt(mInput.value) || 0;

            const mux_std = (x & m) | (y & (~m >>> 0));
            const mux_opt = (((x ^ y) & m) ^ y) >>> 0;

            const html = `
                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap:15px;">
                    <div style="background:#f9f9f9; padding:15px; border-radius:8px; border-left:4px solid #667eea;">
                        <div class="result-label">è¾“å…¥å€¼</div>
                        <div style="font-family:monospace; margin:10px 0;">
                            x = ${x} (${toBinary(x, 8)})<br>
                            y = ${y} (${toBinary(y, 8)})<br>
                            m = ${m} (${toBinary(m, 8)})
                        </div>
                    </div>
                    <div style="background:#e8f5e9; padding:15px; border-radius:8px; border-left:4px solid #00b894;">
                        <div class="result-label">âœ… æ ‡å‡†MUX (4æ¡æŒ‡ä»¤)</div>
                        <div style="font-family:monospace; margin:10px 0;">
                            (x&m)|(y&~m)<br>
                            = ${mux_std} (${toBinary(mux_std, 8)})
                        </div>
                    </div>
                    <div style="background:#f3e5f5; padding:15px; border-radius:8px; border-left:4px solid #764ba2;">
                        <div class="result-label">âš¡ ä¼˜åŒ–MUX (3æ¡æŒ‡ä»¤)</div>
                        <div style="font-family:monospace; margin:10px 0;">
                            ((x^y)&m)^y<br>
                            = ${mux_opt} (${toBinary(mux_opt, 8)})
                        </div>
                    </div>
                </div>
            `;
            
            const resultElem = document.getElementById('mux-result');
            if (resultElem) {
                resultElem.innerHTML = html;
            }
        }

        // ===== ç¬¬äº”éƒ¨åˆ†ï¼šGosper's Hack =====
        function gosperInit() {
            const input = document.getElementById('gosper_start');
            if (!input) return;
            
            const start = parseInt(input.value) || 7;
            gosperCurrent = start;
            updateGosperDisplay();
            generateGosperSequence();
        }

        function gosperNext() {
            const c = gosperCurrent & (-gosperCurrent);
            const r = gosperCurrent + c;
            const ones = (((r ^ gosperCurrent) / c) >> 2) + 1;
            gosperCurrent = r | ones;
            updateGosperDisplay();
        }

        function updateGosperDisplay() {
            const x = gosperCurrent;
            const c = x & (-x);
            const r = x + c;
            const diff = r ^ x;
            const ones = (((diff) / c) >> 2) + 1;
            const result = r | ones;

            const elemX = document.getElementById('gosper-x');
            const elemC = document.getElementById('gosper-c');
            const elemR = document.getElementById('gosper-r');
            const elemOnes = document.getElementById('gosper-ones');
            const elemResult = document.getElementById('gosper-result');

            if (elemX) elemX.textContent = toBinary(x, 8);
            if (elemC) elemC.textContent = toBinary(c, 8);
            if (elemR) elemR.textContent = toBinary(r, 8);
            if (elemOnes) elemOnes.textContent = toBinary(ones, 8);
            if (elemResult) elemResult.textContent = toBinary(result, 8);
        }

        function generateGosperSequence() {
            const input = document.getElementById('gosper_start');
            if (!input) return;
            
            const start = parseInt(input.value) || 7;
            let x = start;
            const sequence = [];
            const maxItems = 12;

            for (let i = 0; i < maxItems && x < 256; i++) {
                sequence.push(x);
                const c = x & (-x);
                const r = x + c;
                const ones = (((r ^ x) / c) >> 2) + 1;
                x = r | ones;
            }

            const html = sequence.map(val => `
                <div class="gosper-item">${toBinary(val, 8)}<br><small>${val}</small></div>
            `).join('');
            
            const seqElem = document.getElementById('gosper-sequence');
            if (seqElem) {
                seqElem.innerHTML = html;
            }
        }

        // ===== ç¬¬å…­éƒ¨åˆ†ï¼šå¸ƒå°”åˆ†è§£ =====
        function boolDecompose() {
            const funcSelect = document.getElementById('bool_func');
            if (!funcSelect) return;
            
            const func = funcSelect.value;
            let analysis = '';

            switch(func) {
                case 'and':
                    analysis = `
                        <strong>AND åˆ†è§£</strong><br>
                        x & y = (x & y)<br>
                        <br>
                        <strong>çœŸå€¼è¡¨</strong><br>
                        x y | result<br>
                        0 0 | 0<br>
                        0 1 | 0<br>
                        1 0 | 0<br>
                        1 1 | 1<br>
                        <br>
                        <strong>æŒ‡ä»¤æ•°</strong>: 1 æ¡ (AND æŒ‡ä»¤)
                    `;
                    break;
                case 'or':
                    analysis = `
                        <strong>OR åˆ†è§£</strong><br>
                        x | y = (x | y)<br>
                        <br>
                        <strong>çœŸå€¼è¡¨</strong><br>
                        x y | result<br>
                        0 0 | 0<br>
                        0 1 | 1<br>
                        1 0 | 1<br>
                        1 1 | 1<br>
                        <br>
                        <strong>æŒ‡ä»¤æ•°</strong>: 1 æ¡ (OR æŒ‡ä»¤)
                    `;
                    break;
                case 'xor':
                    analysis = `
                        <strong>XOR åˆ†è§£</strong><br>
                        x ^ y = (x | y) & ~(x & y)<br>
                        <br>
                        <strong>çœŸå€¼è¡¨</strong><br>
                        x y | result<br>
                        0 0 | 0<br>
                        0 1 | 1<br>
                        1 0 | 1<br>
                        1 1 | 0<br>
                        <br>
                        <strong>æœ€å°‘æŒ‡ä»¤æ•°</strong>: 1 æ¡ (XOR æŒ‡ä»¤)<br>
                        <strong>åˆ†è§£å½¢å¼</strong>: 2 æ¡ (OR + AND + NOT)
                    `;
                    break;
                case 'maj':
                    analysis = `
                        <strong>å¤šæ•°è¡¨å†³ (Majority)</strong><br>
                        MAJ(x,y,z) = (x&y)|(y&z)|(z&x)<br>
                        <br>
                        <strong>å«ä¹‰</strong>: 3 ä¸ªè¾“å…¥ä¸­è‡³å°‘ 2 ä¸ªä¸º 1<br>
                        <br>
                        <strong>æœ€å°‘æŒ‡ä»¤æ•°</strong>: 3 æ¡<br>
                        <strong>åˆ†è§£</strong>: 3æ¡AND + 2æ¡OR<br>
                        <br>
                        <strong>åº”ç”¨</strong>: SHA-256 ä¸»è½®å‡½æ•°
                    `;
                    break;
                case 'parity':
                    analysis = `
                        <strong>å¥‡å¶ (Parity)</strong><br>
                        P(x,y,z) = x ^ y ^ z<br>
                        <br>
                        <strong>å«ä¹‰</strong>: 3 ä¸ªè¾“å…¥ä¸­æœ‰å¥‡æ•°ä¸ª 1<br>
                        <br>
                        <strong>æœ€å°‘æŒ‡ä»¤æ•°</strong>: 2 æ¡ (XOR + XOR)<br>
                        <br>
                        <strong>åº”ç”¨</strong>: é”™è¯¯æ£€æµ‹ç ã€LFSR
                    `;
                    break;
            }

            const html = `
                <div style="background:#f9f9f9; padding:20px; border-radius:8px; border-left:4px solid #667eea; font-family:monospace; white-space:pre-wrap; line-height:1.8;">
                    ${analysis}
                </div>
            `;
            
            const resultElem = document.getElementById('bool-result');
            if (resultElem) {
                resultElem.innerHTML = html;
            }
        }

        // ===== é¡µé¢åˆå§‹åŒ– =====
        document.addEventListener('DOMContentLoaded', function() {
            initBitInput();
            updateRightmostResults();
            gosperInit();
        });

        // ä¸ºæ‰€æœ‰æŒ‰é’®æ·»åŠ ç‚¹å‡»å¤„ç†
        window.updateRightmostResults = updateRightmostResults;
        window.verifyIdentities = verifyIdentities;
        window.branchFreeDemo = branchFreeDemo;
        window.muxDemo = muxDemo;
        window.gosperInit = gosperInit;
        window.gosperNext = gosperNext;
        window.boolDecompose = boolDecompose;
    </script>
</body>
</html>
	
		